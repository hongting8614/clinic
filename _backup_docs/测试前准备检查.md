# 测试前准备检查 ✅

## 🎯 快速检查清单（5分钟）

在开始测试前，请确认以下各项：

---

## ✅ 环境准备

### 1. 开发工具
- [ ] 微信开发者工具已安装
- [ ] 微信开发者工具已打开
- [ ] 项目已导入（路径：D:\AK-PMS(1)\AK-PMS）

### 2. 项目编译
- [ ] 点击「编译」按钮
- [ ] 编译成功（无红色错误）
- [ ] 模拟器显示首页
- [ ] 控制台无错误

---

## ✅ 云函数检查（如有修改）

本次优化涉及的云函数：

### 需要上传的云函数：
- [ ] `outRecords` - 出库单位转换逻辑
- [ ] `clinicRecords` - 门诊用药扣减逻辑

### 上传步骤：
```
1. 开发者工具 → 云开发 → 云函数
2. 右键云函数 → 上传并部署：云端安装依赖
3. 等待上传完成
```

---

## ✅ 测试数据准备

### 方案1：使用现有数据
- [ ] 确认数据库已有药品档案
- [ ] 确认数据库已有库存数据

### 方案2：创建测试数据（推荐）
参考：`docs/入库测试指南_10种药品.md`

**快速创建10个测试药品：**
```
1. 首页 → 药品档案 → 添加药品
2. 按照测试指南创建10种药品
3. 预计耗时：10-15分钟
```

---

## ✅ 重点测试准备

### 🔴 最高优先级（必测）

#### 1. 日期选择器功能 ⭐⭐⭐⭐⭐
```
页面：首页 → 药品入库
测试点：生产日期、有效期是否可以选择
预期：点击后弹出日期选择器，可以正常选择
```

#### 2. 扫码功能清理验证 ⭐⭐⭐⭐⭐
```
检查页面：
✓ 药品入库   - 应该没有扫码按钮
✓ 药品出库   - 应该没有扫码按钮  
✓ 门诊登记   - 应该没有扫码按钮
✓ 日消耗     - 应该没有扫码按钮
✓ 药品档案   - 应该有「📷 扫码添加药品」按钮（唯一保留）
```

#### 3. 单位转换逻辑 ⭐⭐⭐⭐⭐
```
测试流程：
1. 入库：录入10盒阿莫西林（1盒=100粒）
2. 出库：出库5盒到陆园
3. 验证：
   ✓ 总库存扣减 5 盒
   ✓ 陆园库存增加 500 粒（自动转换）
   ✓ 显示转换提示
```

---

## ✅ 快速验证步骤（15分钟）

### Step 1: 药品入库测试（5分钟）
```
1. 首页 → 药品入库
2. 点击「➕ 手动添加药品」（不应有扫码按钮）
3. 搜索并选择药品
4. 填写信息：
   • 批号：TEST001
   • 生产日期：点击选择（重点测试）
   • 有效期：点击选择（重点测试）
   • 数量：10
   • 单价：5.5
5. 签名并提交
6. 验证提交成功
```

### Step 2: 药品出库测试（5分钟）
```
1. 首页 → 药品出库
2. 选择园区：陆园
3. 点击「➕ 添加药品」（不应有扫码按钮）
4. 选择刚才入库的药品
5. 输入数量：5
6. 查看转换提示（重点）：
   「🔄 将转换为 500 片 存入陆园」
7. 签名并提交
8. 验证库存变化
```

### Step 3: 门诊登记测试（5分钟）
```
1. 首页 → 门诊登记
2. 选择就诊园区：陆园
3. 填写患者信息
4. 点击药品名称输入框
5. 验证显示陆园的药品列表（重点）
6. 选择药品，输入数量：20
7. 签名并提交
8. 验证陆园库存扣减 20（最小单位）
```

---

## ✅ 问题检查点

### 如果出现问题，检查以下内容：

#### 编译失败
```
□ node_modules 是否存在？
□ 清除缓存试试（工具 → 清除缓存）
□ manifest.json 配置是否正确？
```

#### 日期选择器不工作
```
□ 已修复！应该正常工作
□ 如仍有问题，检查 pages-sub/in/add.vue 第97、106行
□ 确认使用：@change="e => onProductionDateChange(e, index)"
```

#### 云函数调用失败
```
□ 云函数是否已上传？
□ 云开发环境ID是否配置？
□ 网络连接是否正常？
```

#### 找不到药品
```
□ 药品档案是否已创建？
□ drugManage 云函数是否已部署？
```

---

## 📋 测试记录表

### 快速记录
```
测试人员：___________
测试时间：___________
测试环境：微信开发者工具 / 真机

【必测项】
□ 日期选择器     [  通过  /  失败  ]
□ 扫码功能清理   [  通过  /  失败  ]
□ 单位转换       [  通过  /  失败  ]

【功能测试】
□ 药品入库       [  通过  /  失败  ]
□ 药品出库       [  通过  /  失败  ]
□ 门诊登记       [  通过  /  失败  ]
□ 药品档案       [  通过  /  失败  ]

【问题记录】
_____________________________________
_____________________________________
_____________________________________
```

---

## ⚡ 超快速验证（3分钟）

### 如果时间紧迫，至少测试这些：

**1分钟：** 编译检查
```
✓ 编译成功
✓ 首页正常显示
✓ 无控制台错误
```

**1分钟：** 扫码检查
```
✓ 打开入库页面 - 无扫码按钮
✓ 打开出库页面 - 无扫码按钮
✓ 打开药品档案 - 有扫码按钮
```

**1分钟：** 日期选择器
```
✓ 打开入库页面
✓ 添加药品
✓ 点击生产日期 - 可以选择
✓ 点击有效期 - 可以选择
```

---

## 🎯 测试通过标准

### 最低标准（必须通过）
- ✅ 编译无错误
- ✅ 日期选择器正常工作
- ✅ 扫码功能正确清理（仅药品档案保留）
- ✅ 核心功能（入库/出库/门诊）正常

### 理想标准（建议达到）
- ✅ 所有功能测试通过
- ✅ 单位转换逻辑正确
- ✅ 界面美观、交互流畅
- ✅ 无明显bug或问题

---

## 🚀 测试完成后

### 测试通过 ✅
```
1. 记录测试结果
2. 可以投入使用
3. 进行真机测试（可选）
4. 用户验收测试（可选）
```

### 测试未通过 ❌
```
1. 记录所有问题
2. 参考 docs/快速启动指南.md 的「常见问题」
3. 优先修复高优先级问题
4. 重新测试
```

---

## 📞 需要帮助？

### 文档索引
- **快速启动** → `docs/快速启动指南.md`
- **详细测试** → `docs/功能测试清单.md`
- **优化说明** → `docs/代码优化完整报告.md`
- **常见问题** → `docs/快速启动指南.md#常见问题`

### 问题排查顺序
1. 查看控制台错误信息
2. 查看快速启动指南的「常见问题」
3. 查看功能测试清单的「问题追踪」
4. 联系开发团队

---

## 💡 温馨提示

### ⭐ 重点关注
- **日期选择器**：之前有bug，已修复，重点测试
- **扫码功能**：除药品档案外都应删除
- **单位转换**：出库时自动转换，门诊时正确扣减

### ⚡ 快速上手
```
总时间：15-30分钟
  编译 (2分钟)
  + 快速验证 (15分钟)
  + 记录结果 (3分钟)
= 开始使用！
```

---

> 🎯 **准备就绪！**
> 
> 所有检查项完成后，即可开始正式测试。
> 
> 祝测试顺利！🚀

