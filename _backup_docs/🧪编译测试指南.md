# 🧪 AK-PMS v3.4 编译测试指南

**版本**: v3.4 Enhanced Edition  
**测试日期**: 2025-11-01  
**状态**: 准备就绪

---

## 📋 测试前准备

### 1. 环境检查

#### 必备工具
- ✅ 微信开发者工具（最新版本）
- ✅ Node.js 12+ 环境
- ✅ 微信云开发账号
- ✅ 测试用微信账号

#### 项目检查
```bash
# 检查项目结构
D:\medicine_manager\AK-PMS\
├── cloudfunctions/         # 云函数目录（16个）
├── pages/                  # 主页面目录
├── pages-sub/              # 子包页面目录
├── components/             # 组件目录
├── static/                 # 静态资源
├── pages.json              # 页面配置
└── manifest.json           # 项目配置
```

#### 云函数清单（16个）
- [x] drugManage
- [x] stockManage
- [x] inRecords
- [x] outRecords
- [x] consumeRecords
- [x] requisitionRecords
- [x] clinicRecords
- [x] reportService
- [x] queryService
- [x] dailySummary
- [x] expiryMonitor
- [x] login
- [x] getUserList
- [x] addUser
- [x] updateUser
- [x] deleteUser

---

## 🔧 编译步骤

### Step 1: 打开项目
```bash
1. 启动微信开发者工具
2. 选择"导入项目"
3. 项目路径: D:\medicine_manager\AK-PMS
4. AppID: [你的AppID]
5. 项目名称: AK-PMS
```

### Step 2: 编译检查
```bash
1. 工具栏 → 编译
2. 查看控制台输出
3. 确认无编译错误
4. 查看警告信息
```

#### 预期输出
```
编译成功
代码包大小: ~5MB
分包加载: ✅
云函数配置: ✅
```

#### 可能的警告（可忽略）
```
⚠️ 部分云函数未部署 → 待后续部署
⚠️ 图片未压缩 → 不影响功能
⚠️ 代码包较大 → 已使用分包
```

### Step 3: 本地预览
```bash
1. 点击"预览"按钮
2. 扫描二维码
3. 手机上打开小程序
```

---

## 📱 功能测试清单

### 🏠 首页测试（5分钟）

#### 测试项
- [ ] 页面正常加载
- [ ] 所有卡片显示正常
- [ ] 新增"门诊用药"按钮（绿色）
- [ ] 新增"报表中心"按钮（紫色）
- [ ] 图标居中显示
- [ ] 点击跳转正常

#### 测试截图位置
```
📸 截图1: 首页全景
📸 截图2: 门诊用药卡片
📸 截图3: 报表中心卡片
```

---

### 🩺 门诊用药测试（15分钟）

#### 测试场景1: 添加门诊记录
```
步骤:
1. 首页 → 点击"门诊用药"
2. 选择园区: "陆园"
3. 选择药品: 随意选一个（或扫码）
4. 输入用量: 10 片
5. 查看自动换算: 应显示对应的盒数
6. 填写患者姓名: "测试患者"
7. 填写症状: "感冒"
8. 点击"提交"

预期结果:
✅ 提交成功提示
✅ 可选择继续登记或返回
✅ 库存自动扣减
```

#### 测试场景2: 查看门诊记录
```
步骤:
1. 门诊登记页 → 点击"查看记录"
2. 查看今日记录列表
3. 切换园区筛选
4. 搜索药品

预期结果:
✅ 记录正常显示
✅ 筛选功能正常
✅ 统计数据正确
```

#### 测试检查点
- [ ] 园区选择正常
- [ ] 药品搜索正常
- [ ] 批次自动选择（FIFO）
- [ ] 单位换算正确
- [ ] 库存验证生效
- [ ] 提交成功
- [ ] 记录可查询

#### 测试数据记录
```
测试时间: ___________
园区: 陆园
药品: ___________
用量: 10片
换算: ___盒
批次: ___________
库存扣减: 前___ → 后___
```

---

### 📊 报表中心测试（20分钟）

#### 测试场景1: 报表主页
```
步骤:
1. 首页 → 点击"报表中心"
2. 查看页面布局
3. 查看今日统计面板
4. 查看5个报表卡片
5. 查看快捷查询入口
6. 下拉刷新

预期结果:
✅ 页面美观
✅ 数据正常显示
✅ 所有卡片可点击
✅ 刷新功能正常
```

#### 测试场景2: R1入库明细报表
```
步骤:
1. 点击"入库明细报表"
2. 选择日期范围: 最近7天
3. 选择园区: 全部
4. 点击"查询"
5. 查看表格数据
6. 查看关键指标

预期结果:
✅ 数据正确显示
✅ 筛选功能正常
✅ 表格列齐全
✅ 指标统计正确
```

#### 测试场景3: R2出库与请领汇总（饼图）
```
步骤:
1. 点击"出库与请领汇总"
2. 选择日期范围
3. 点击"查询"
4. 等待数据加载
5. 查看饼图显示
6. 查看表格数据

预期结果:
✅ 饼图正确渲染
✅ 扇形颜色区分
✅ 百分比计算正确
✅ 图例显示清晰
✅ 中心总数显示
```

#### 测试场景4: R3门诊用药统计（折线图）
```
步骤:
1. 点击"门诊用药统计"
2. 选择日期范围
3. 点击"查询"
4. 查看折线图
5. 观察三条折线（陆园、水园、医务室）

预期结果:
✅ 折线图正确渲染
✅ 多条线颜色区分
✅ 数据点标记清晰
✅ 坐标轴正常
✅ 趋势清晰可见
```

#### 测试场景5: R4库存预警报表（三色标识）
```
步骤:
1. 点击"库存预警报表"
2. 查看表格数据
3. 观察状态列颜色
   - 🔴 红色 = 过期
   - 🟠 橙色 = 临期（≤60天）
   - 🟢 绿色 = 正常
4. 按效期天数排序

预期结果:
✅ 颜色标识正确
✅ 临期标准为60天
✅ 排序功能正常
✅ 预警逻辑正确
```

#### 测试场景6: R5盘点差异分析（柱状图）
```
步骤:
1. 点击"盘点差异分析"
2. 选择月份
3. 点击"查询"
4. 查看柱状图
5. 观察理论vs实际对比

预期结果:
✅ 柱状图正确渲染
✅ 双柱对比清晰
✅ 差异直观可见
✅ 图例说明清楚
```

#### 报表测试检查点
- [ ] R1入库明细报表正常
- [ ] R2出库汇总+饼图正常
- [ ] R3门诊统计+折线图正常
- [ ] R4库存预警+三色标识正常
- [ ] R5盘点差异+柱状图正常
- [ ] 所有筛选功能正常
- [ ] 指标统计正确
- [ ] 图表渲染流畅

---

### 📤 Excel导出测试（10分钟）

#### 测试场景1: 导出R1入库报表
```
步骤:
1. 进入R1报表详情页
2. 查询数据（确保有数据）
3. 点击底部"导出Excel"按钮
4. 等待Loading提示
5. 查看下载进度
6. 收到成功提示
7. 选择"打开文件"
8. 用Excel或WPS打开

预期结果:
✅ Loading提示显示
✅ 3-5秒内生成完成
✅ 弹窗提示成功
✅ 文件名正确（包含时间戳）
✅ 文件可以正常打开
✅ 中文无乱码
✅ 表头正确
✅ 数据完整
```

#### 测试场景2: 导出R4预警报表
```
步骤:
1. 进入R4库存预警报表
2. 查询临期药品
3. 导出Excel
4. 打开文件验证

预期结果:
✅ 导出成功
✅ 状态列显示正确（过期/临期/正常）
✅ 颜色标识在Excel中保留
✅ 日期格式正确
```

#### 导出测试检查点
- [ ] 导出按钮可点击
- [ ] 空数据时提示"暂无数据"
- [ ] Loading提示正常
- [ ] 生成速度快（<5秒）
- [ ] 文件名规范
- [ ] Excel打开正常
- [ ] 中文无乱码
- [ ] 数据完整准确
- [ ] 日期格式正确
- [ ] 特殊字符处理正确

---

### 🔍 数据查询测试（10分钟）

#### 测试场景: 6项查询功能
```
步骤:
1. 报表中心 → 点击"快捷查询"
2. 测试Q1: 药品综合查询
3. 测试Q2: 实时库存查询
4. 测试Q3: 门诊用药查询
5. 测试Q4: 入库记录查询
6. 测试Q5: 出库记录查询
7. 测试Q6: 盘点历史查询

预期结果:
✅ 所有查询功能正常
✅ 搜索结果准确
✅ 筛选条件生效
✅ 分页加载正常
```

#### 查询测试检查点
- [ ] Q1药品查询正常
- [ ] Q2库存查询正常
- [ ] Q3门诊查询正常
- [ ] Q4入库查询正常
- [ ] Q5出库查询正常
- [ ] Q6盘点查询正常

---

## 🎨 UI/UX测试

### 视觉检查
- [ ] 所有图标居中显示
- [ ] 文字居中对齐
- [ ] 颜色搭配协调
- [ ] 卡片间距一致
- [ ] 渐变效果流畅
- [ ] 图表美观清晰

### 交互测试
- [ ] 按钮点击有反馈
- [ ] 页面切换流畅
- [ ] Loading动画正常
- [ ] 下拉刷新正常
- [ ] 上拉加载正常
- [ ] 表单验证及时

### 响应测试
- [ ] 页面加载速度快（<2s）
- [ ] 图表渲染流畅（<500ms）
- [ ] 数据查询快速（<1s）
- [ ] 导出生成及时（<5s）

---

## ⚡ 性能测试

### 加载性能
```
测试项:
1. 冷启动时间: ___秒（目标<3s）
2. 首页加载时间: ___秒（目标<2s）
3. 报表页加载: ___秒（目标<2s）
4. 图表渲染时间: ___ms（目标<500ms）
```

### 数据性能
```
测试项:
1. 查询100条数据: ___秒（目标<1s）
2. 查询500条数据: ___秒（目标<2s）
3. 导出100条数据: ___秒（目标<3s）
4. 图表100数据点: ___秒（目标<1s）
```

### 内存占用
```
测试项:
1. 应用启动内存: ___MB（目标<50MB）
2. 运行5分钟后: ___MB（目标<80MB）
3. 图表渲染后: ___MB（目标<100MB）
4. 是否有内存泄漏: 是/否
```

---

## 🐛 异常测试

### 边界条件
```
测试项:
- [ ] 空数据显示友好提示
- [ ] 网络断开时的处理
- [ ] 数据加载失败的提示
- [ ] 表单必填项验证
- [ ] 日期范围验证
- [ ] 数量输入限制
```

### 错误处理
```
测试项:
- [ ] 云函数调用失败
- [ ] 图表渲染失败
- [ ] 导出失败
- [ ] 权限不足提示
- [ ] 并发操作处理
```

---

## 📊 测试结果记录

### 功能测试结果
| 功能模块 | 测试项 | 通过 | 失败 | 备注 |
|---------|--------|------|------|------|
| 首页 | 5 | ___ | ___ | ____ |
| 门诊用药 | 7 | ___ | ___ | ____ |
| 报表中心 | 5 | ___ | ___ | ____ |
| 图表显示 | 3 | ___ | ___ | ____ |
| Excel导出 | 8 | ___ | ___ | ____ |
| 数据查询 | 6 | ___ | ___ | ____ |
| **总计** | **34** | **___** | **___** | **通过率: ___%** |

### 性能测试结果
| 性能指标 | 目标值 | 实际值 | 状态 |
|---------|--------|--------|------|
| 首页加载 | <2s | ___s | _____ |
| 图表渲染 | <500ms | ___ms | _____ |
| 数据查询 | <1s | ___s | _____ |
| Excel导出 | <5s | ___s | _____ |
| 内存占用 | <100MB | ___MB | _____ |

### UI/UX测试结果
| 测试项 | 通过/失败 | 备注 |
|--------|----------|------|
| 视觉效果 | _______ | ____ |
| 交互反馈 | _______ | ____ |
| 响应速度 | _______ | ____ |
| 居中对齐 | _______ | ____ |

---

## 🔧 问题记录

### 发现的问题
```
问题1: 
描述: _________________________________
重现步骤: _____________________________
严重程度: □高 □中 □低
状态: □待修复 □已修复

问题2:
描述: _________________________________
重现步骤: _____________________________
严重程度: □高 □中 □低
状态: □待修复 □已修复

问题3:
描述: _________________________________
重现步骤: _____________________________
严重程度: □高 □中 □低
状态: □待修复 □已修复
```

---

## 📸 测试截图清单

### 必要截图
1. ✅ 首页全景（显示所有快捷入口）
2. ✅ 门诊用药登记页
3. ✅ 报表中心主页
4. ✅ R2饼图效果
5. ✅ R3折线图效果
6. ✅ R4预警三色标识
7. ✅ R5柱状图效果
8. ✅ Excel导出成功提示
9. ✅ Excel文件打开效果
10. ✅ 数据查询页面

---

## ✅ 测试通过标准

### 功能完整性
- ✅ 所有功能正常运行
- ✅ 无阻塞性Bug
- ✅ 交互流程顺畅
- ✅ 数据准确无误

### 性能达标
- ✅ 加载速度符合预期
- ✅ 图表渲染流畅
- ✅ 内存占用合理
- ✅ 无明显卡顿

### 用户体验
- ✅ UI美观协调
- ✅ 操作便捷直观
- ✅ 提示信息清晰
- ✅ 错误处理友好

---

## 🚀 测试通过后的操作

### 1. 生成测试报告
```
内容包括:
- 测试概要
- 测试结果统计
- 问题记录
- 性能数据
- 测试截图
- 建议和结论
```

### 2. 部署到开发环境
```
步骤:
1. 上传云函数（16个）
2. 配置定时触发器（2个）
3. 初始化数据库
4. 上传小程序代码
5. 设置体验版
```

### 3. 用户验收测试（UAT）
```
步骤:
1. 邀请实际用户测试
2. 收集用户反馈
3. 记录改进建议
4. 优化用户体验
```

### 4. 发布到生产环境
```
步骤:
1. 提交审核
2. 等待微信审核通过
3. 发布上线
4. 监控运行状态
```

---

## 📞 支持联系

### 技术支持
如测试过程中遇到问题：
- 📧 Email: support@example.com
- 💬 技术群: [待建立]
- 📚 文档: 参考技术文档

---

## 📝 测试签字

**测试人员**: ________________  
**测试日期**: ________________  
**测试结论**: □通过 □不通过 □有条件通过  
**签字**: ________________

---

**AK-PMS v3.4 测试指南**  
**版本**: v3.4 Enhanced Edition  
**最后更新**: 2025-11-01

祝测试顺利！ 🎉


