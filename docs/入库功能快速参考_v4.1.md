# 📋 入库功能快速参考 v4.1

## 🚀 快速开始

### 方式1：扫码添加
```
1. 点击搜索框右侧📷图标
2. 扫描药材条形码
3. 自动添加 → 填写信息
```

### 方式2：搜索添加
```
1. 输入药材名称
2. 选择下拉结果
3. 自动添加 → 填写信息
```

### 方式3：新建添加
```
1. 搜索无结果
2. 点击"新建药材档案"
3. 填写信息 → 添加
```

---

## 🔍 智能输入框

### 功能特点
```
🔍 扫码 + 搜索 + 新建 = 一个输入框
```

### 操作提示
- ⌨️ 输入：实时搜索药材
- 📷 扫码：点击右侧相机图标
- ✕ 清空：点击叉号清除
- 📋 选择：点击下拉结果添加
- ➕ 新建：搜索无结果时显示

---

## 📊 查询优先级

```
本地药材档案（免费）
  ↓ 未找到
API次数检查
  ↓ 次数充足
第三方API（<99次/天）
  ↓ 自动保存
下次免费查询
```

---

## ⚠️ API次数提示

| 剩余次数 | 提示 |
|---------|------|
| < 80次 | 不提示 |
| 80-89次 | "剩余X次API" |
| 90-98次 | 弹窗确认 |
| ≥ 99次 | 拒绝扫码 |

---

## 📝 连续入库

### 操作流程
```
1. 添加第1个药材 → 填写信息
2. 添加第2个药材 → 填写信息
3. 继续添加更多...
4. 全部完成后签名
5. 提交复核
```

### 优势
- ✅ 一次入库多个药材
- ✅ 减少重复操作
- ✅ 单据管理清晰

---

## ✍️ 双签流程

### 操作员签名
```
添加药材 → 填写信息 → 签名 → 提交复核
```

### 复核员签名
```
查看单据 → 核对信息 → 签名 → 通过/驳回
```

### 权限
- ❌ 不能自己复核自己
- ✅ 必须由其他人复核

---

## 📋 必填字段

### 每个药材必填
- ✅ 批号
- ✅ 生产日期
- ✅ 有效期
- ✅ 数量

### 选填字段
- 单价（选填）
- 供应商（选填）

---

## 🎨 界面说明

### 颜色标识

#### 有效期状态
- 🟢 绿色：≥ 90天（安全）
- 🟡 黄色：30-89天（警告）
- 🔴 红色：< 30天（危险）
- ⚫ 黑色：已过期（禁止入库）

#### 表单状态
- 🔵 蓝色边框：获取焦点
- 🔴 红色边框：验证错误
- ⚪ 灰色边框：未填写

---

## ⚡ 快捷操作

### 删除药材
```
点击药材卡片右上角 ✕ 图标
```

### 清空搜索
```
点击搜索框内 ✕ 图标
```

### 取消操作
```
点击弹窗右上角 ✕ 图标
```

---

## 🐛 常见问题

### Q1: 扫码后没反应？
```
A: 检查API次数是否已用完
   查看是否有错误提示
```

### Q2: 搜索不到药材？
```
A: 点击"新建药材档案"
   手动填写药材信息
```

### Q3: 不能提交？
```
A: 检查必填字段是否完整
   检查是否已签名
```

### Q4: 药材已过期？
```
A: 系统禁止过期药材入库
   请检查有效期是否正确
```

---

## 📱 页面导航

```
入库记录（列表）
  ↓ 点击➕按钮
药材入库（新建）
  ↓ 提交复核
入库记录（列表）
  ↓ 点击待复核单据
入库单详情（复核）
  ↓ 通过复核
库存自动更新 ✅
```

---

## 🔧 技巧提示

### 提高效率
1. 优先使用扫码（最快）
2. 常用药材提前录入档案
3. 批量入库使用连续添加
4. 填写信息时先填日期

### 节省成本
1. 优先搜索本地档案
2. 扫码前确认药材信息
3. 避免重复扫码同一药材

### 避免错误
1. 仔细核对批号
2. 确认有效期正确
3. 数量单位要匹配
4. 提交前再次检查

---

## 📞 技术支持

遇到问题？查看完整文档：
- `入库功能优化开发完成报告_v4.1.md`
- `入库功能优化设计方案_v4.1_终版.md`

---

**版本**：v4.1  
**更新时间**：2025-11-08



