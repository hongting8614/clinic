# ğŸ“‹ å…¥åº“å•é¡µé¢ä¼˜åŒ–æŒ‡å—

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡

1. âœ… æ·»åŠ ä¾›åº”å•†é€‰æ‹©åŠŸèƒ½ï¼ˆå¸¦æœç´¢ï¼‰
2. âœ… ä¼˜åŒ–ç©ºçŠ¶æ€æ˜¾ç¤ºï¼ˆè¯ææ˜ç»†ä¸ºç©ºæ—¶ï¼‰

---

## ğŸ“¦ å·²åˆ›å»ºçš„ç»„ä»¶

### SupplierPicker ç»„ä»¶
- è·¯å¾„ï¼š`components/supplier-picker.vue`
- åŠŸèƒ½ï¼šä¾›åº”å•†é€‰æ‹©ã€æœç´¢ã€æ–°å»º

---

## ğŸ”§ ä¿®æ”¹æ­¥éª¤

### æ­¥éª¤1: ä¿®æ”¹å…¥åº“å•é¡µé¢æ¨¡æ¿

**æ–‡ä»¶**: `pages-sub/in/add.vue`

æ‰¾åˆ°ä¾›åº”å•†è¾“å…¥æ¡†éƒ¨åˆ†ï¼ˆçº¦ç¬¬29-34è¡Œï¼‰ï¼š

```vue
<!-- åŸä»£ç  -->
<input 
  class="input-value" 
  v-model="supplier" 
  placeholder="è¯·è¾“å…¥ä¾›åº”å•†"
/>
```

**ä¿®æ”¹ä¸º**ï¼š

```vue
<!-- æ–°ä»£ç  -->
<view 
  class="input-value clickable" 
  @click="showSupplierPicker = true"
>
  {{ supplier || 'è¯·é€‰æ‹©ä¾›åº”å•†' }}
</view>
```

---

### æ­¥éª¤2: æ·»åŠ ä¾›åº”å•†é€‰æ‹©å™¨ç»„ä»¶

åœ¨æ¨¡æ¿åº•éƒ¨æ·»åŠ ï¼ˆçº¦ç¬¬322è¡Œä¹‹åï¼‰ï¼š

```vue
<!-- ä¾›åº”å•†é€‰æ‹©å¼¹çª— -->
<supplier-picker
  v-model="showSupplierPicker"
  @select="onSupplierSelect"
  @add-new="showCreateSupplier = true"
></supplier-picker>

<!-- æ–°å»ºä¾›åº”å•†å¼¹çª— -->
<u-popup 
  v-model="showCreateSupplier" 
  mode="center"
  :border-radius="20"
  width="85%"
>
  <view class="create-supplier-popup">
    <view class="popup-header">
      <text class="popup-title">æ–°å»ºä¾›åº”å•†</text>
      <text class="popup-close" @click="showCreateSupplier = false">Ã—</text>
    </view>
    <view class="popup-body">
      <view class="form-item">
        <text class="form-label">ä¾›åº”å•†åç§° *</text>
        <input 
          class="form-input" 
          v-model="newSupplier.name" 
          placeholder="è¯·è¾“å…¥ä¾›åº”å•†åç§°"
        />
      </view>
      <view class="form-item">
        <text class="form-label">ä¾›åº”å•†ç¼–ç </text>
        <input 
          class="form-input" 
          v-model="newSupplier.code" 
          placeholder="è‡ªåŠ¨ç”Ÿæˆæˆ–æ‰‹åŠ¨è¾“å…¥"
        />
      </view>
      <view class="form-item">
        <text class="form-label">è”ç³»äºº</text>
        <input 
          class="form-input" 
          v-model="newSupplier.contact" 
          placeholder="è”ç³»äººå§“å"
        />
      </view>
      <view class="form-item">
        <text class="form-label">è”ç³»ç”µè¯</text>
        <input 
          class="form-input" 
          v-model="newSupplier.phone" 
          type="number"
          placeholder="è”ç³»ç”µè¯"
        />
      </view>
    </view>
    <view class="popup-footer">
      <u-button 
        text="å–æ¶ˆ" 
        plain
        @click="showCreateSupplier = false"
      ></u-button>
      <u-button 
        text="ç¡®å®š" 
        type="primary"
        @click="confirmCreateSupplier"
      ></u-button>
    </view>
  </view>
</u-popup>
```

---

### æ­¥éª¤3: ä¿®æ”¹ script éƒ¨åˆ†

#### 3.1 å¯¼å…¥ç»„ä»¶

åœ¨ `<script>` å¼€å¤´æ·»åŠ ï¼š

```javascript
import SupplierPicker from '@/components/supplier-picker.vue'

export default {
  components: {
    SupplierPicker
  },
  // ... å…¶ä»–é…ç½®
}
```

#### 3.2 æ·»åŠ  data å±æ€§

```javascript
data() {
  return {
    // ... ç°æœ‰å±æ€§
    
    // æ–°å¢å±æ€§
    showSupplierPicker: false,
    showCreateSupplier: false,
    newSupplier: {
      name: '',
      code: '',
      contact: '',
      phone: ''
    }
  }
}
```

#### 3.3 æ·»åŠ æ–¹æ³•

```javascript
methods: {
  // ... ç°æœ‰æ–¹æ³•
  
  // é€‰æ‹©ä¾›åº”å•†
  onSupplierSelect(supplier) {
    this.supplier = supplier.name
    this.supplierCode = supplier.code
    this.supplierContact = supplier.contact
    this.supplierPhone = supplier.phone
  },
  
  // ç¡®è®¤æ–°å»ºä¾›åº”å•†
  async confirmCreateSupplier() {
    if (!this.newSupplier.name) {
      wx.showToast({
        title: 'è¯·è¾“å…¥ä¾›åº”å•†åç§°',
        icon: 'none'
      })
      return
    }
    
    try {
      const db = wx.cloud.database()
      
      // ç”Ÿæˆç¼–ç ï¼ˆå¦‚æœæ²¡æœ‰æ‰‹åŠ¨è¾“å…¥ï¼‰
      if (!this.newSupplier.code) {
        const timestamp = Date.now()
        this.newSupplier.code = `SUP${timestamp.toString().slice(-8)}`
      }
      
      // æ·»åŠ åˆ°æ•°æ®åº“
      await db.collection('suppliers').add({
        data: {
          ...this.newSupplier,
          status: 'active',
          createTime: new Date(),
          updateTime: new Date()
        }
      })
      
      wx.showToast({
        title: 'æ·»åŠ æˆåŠŸ',
        icon: 'success'
      })
      
      // è®¾ç½®ä¸ºå½“å‰ä¾›åº”å•†
      this.supplier = this.newSupplier.name
      
      // å…³é—­å¼¹çª—å¹¶é‡ç½®
      this.showCreateSupplier = false
      this.newSupplier = {
        name: '',
        code: '',
        contact: '',
        phone: ''
      }
      
    } catch (error) {
      console.error('æ·»åŠ ä¾›åº”å•†å¤±è´¥:', error)
      wx.showToast({
        title: 'æ·»åŠ å¤±è´¥',
        icon: 'none'
      })
    }
  }
}
```

---

### æ­¥éª¤4: æ·»åŠ æ ·å¼

åœ¨ `<style>` ä¸­æ·»åŠ ï¼š

```css
/* å¯ç‚¹å‡»çš„è¾“å…¥æ¡†æ ·å¼ */
.input-value.clickable {
  cursor: pointer;
  display: flex;
  align-items: center;
  height: 40px;
  padding: 0 15px;
  background: #f5f5f5;
  border-radius: 5px;
  color: #333;
}

.input-value.clickable:active {
  background: #e8e8e8;
}

/* æ–°å»ºä¾›åº”å•†å¼¹çª—æ ·å¼ */
.create-supplier-popup {
  padding: 20px;
  background: #fff;
  border-radius: 20px;
}

.create-supplier-popup .popup-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.create-supplier-popup .popup-title {
  font-size: 18px;
  font-weight: bold;
}

.create-supplier-popup .popup-close {
  font-size: 30px;
  color: #999;
  line-height: 1;
}

.create-supplier-popup .popup-body {
  max-height: 400px;
  overflow-y: auto;
}

.create-supplier-popup .form-item {
  margin-bottom: 15px;
}

.create-supplier-popup .form-label {
  display: block;
  font-size: 14px;
  color: #666;
  margin-bottom: 8px;
}

.create-supplier-popup .form-input {
  width: 100%;
  height: 45px;
  padding: 0 15px;
  background: #f5f5f5;
  border-radius: 8px;
  font-size: 15px;
}

.create-supplier-popup .popup-footer {
  display: flex;
  gap: 10px;
  margin-top: 20px;
}

.create-supplier-popup .popup-footer button {
  flex: 1;
}
```

---

### æ­¥éª¤5: ä¼˜åŒ–ç©ºçŠ¶æ€æ˜¾ç¤º

æ‰¾åˆ°ç©ºçŠ¶æ€éƒ¨åˆ†ï¼ˆçº¦ç¬¬212-216è¡Œï¼‰ï¼š

```vue
<!-- åŸä»£ç  -->
<view v-else class="empty-state">
  <text class="empty-icon">ğŸ“‹</text>
  <text class="empty-text">æš‚æ— è¯ææ˜ç»†</text>
  <text class="empty-hint">è¯·ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ è¯æ</text>
</view>
```

**ä¿®æ”¹æ ·å¼**ï¼Œä½¿å…¶æ›´å‹å¥½ï¼š

```css
.empty-state {
  padding: 80px 20px;
  text-align: center;
  background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
  border-radius: 10px;
  margin: 10px;
}

.empty-icon {
  display: block;
  font-size: 80px;
  margin-bottom: 20px;
  opacity: 0.8;
}

.empty-text {
  display: block;
  font-size: 18px;
  color: #666;
  margin-bottom: 10px;
  font-weight: bold;
}

.empty-hint {
  display: block;
  font-size: 14px;
  color: #999;
  padding: 10px 20px;
  background: rgba(255, 255, 255, 0.5);
  border-radius: 15px;
  display: inline-block;
}
```

---

## ğŸ“Š æ•°æ®åº“å‡†å¤‡

### åˆ›å»º suppliers é›†åˆ

å¦‚æœè¿˜æ²¡æœ‰ `suppliers` é›†åˆï¼Œéœ€è¦åˆ›å»ºï¼š

**é›†åˆåç§°**: `suppliers`

**å­—æ®µç»“æ„**:
```javascript
{
  _id: "è‡ªåŠ¨ç”Ÿæˆ",
  name: "ä¾›åº”å•†åç§°",
  code: "ä¾›åº”å•†ç¼–ç ",
  contact: "è”ç³»äºº",
  phone: "è”ç³»ç”µè¯",
  address: "åœ°å€ï¼ˆå¯é€‰ï¼‰",
  status: "active", // active æˆ– inactive
  createTime: "åˆ›å»ºæ—¶é—´",
  updateTime: "æ›´æ–°æ—¶é—´"
}
```

**åˆå§‹æ•°æ®ç¤ºä¾‹**:
```javascript
[
  {
    name: "åº·ç¾è¯ä¸š",
    code: "SUP001",
    contact: "å¼ ç»ç†",
    phone: "13800138000",
    status: "active",
    createTime: new Date(),
    updateTime: new Date()
  },
  {
    name: "ä¹å·é€šåŒ»è¯",
    code: "SUP002",
    contact: "æç»ç†",
    phone: "13800138001",
    status: "active",
    createTime: new Date(),
    updateTime: new Date()
  }
]
```

---

## âœ… å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] å·²åˆ›å»º `components/supplier-picker.vue` ç»„ä»¶
- [ ] å·²åˆ›å»º `suppliers` æ•°æ®åº“é›†åˆ
- [ ] å·²ä¿®æ”¹ `pages-sub/in/add.vue` æ¨¡æ¿éƒ¨åˆ†
- [ ] å·²æ·»åŠ ç»„ä»¶å¯¼å…¥å’Œæ³¨å†Œ
- [ ] å·²æ·»åŠ  data å±æ€§
- [ ] å·²æ·»åŠ æ–¹æ³•
- [ ] å·²æ·»åŠ æ ·å¼
- [ ] å·²æµ‹è¯•ä¾›åº”å•†é€‰æ‹©åŠŸèƒ½
- [ ] å·²æµ‹è¯•æ–°å»ºä¾›åº”å•†åŠŸèƒ½
- [ ] å·²éªŒè¯ç©ºçŠ¶æ€æ˜¾ç¤ºä¼˜åŒ–

---

## ğŸ¯ æ•ˆæœé¢„è§ˆ

### ä¾›åº”å•†é€‰æ‹©
- ç‚¹å‡»"ä¾›åº”å•†"å­—æ®µ
- å¼¹å‡ºé€‰æ‹©å™¨ï¼Œæ˜¾ç¤ºæ‰€æœ‰ä¾›åº”å•†
- æ”¯æŒæœç´¢ï¼ˆåç§°ã€ç¼–ç ã€è”ç³»äººï¼‰
- ç‚¹å‡»é€‰æ‹©åè‡ªåŠ¨å¡«å……

### æ–°å»ºä¾›åº”å•†
- åœ¨é€‰æ‹©å™¨ä¸­ç‚¹å‡»"+ æ–°å»ºä¾›åº”å•†"
- å¡«å†™åç§°ã€ç¼–ç ã€è”ç³»äººã€ç”µè¯
- ä¿å­˜åè‡ªåŠ¨è®¾ç½®ä¸ºå½“å‰ä¾›åº”å•†

### ç©ºçŠ¶æ€ä¼˜åŒ–
- ç¾åŒ–çš„æ¸å˜èƒŒæ™¯
- æ›´å¤§çš„å›¾æ ‡
- æ›´å‹å¥½çš„æç¤ºæ–‡å­—

---

## ğŸ”§ å¿«é€Ÿéƒ¨ç½²è„šæœ¬

å¦‚æœéœ€è¦å¿«é€Ÿæ·»åŠ æµ‹è¯•æ•°æ®ï¼Œå¯ä»¥åœ¨æ§åˆ¶å°è¿è¡Œï¼š

```javascript
// åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æ§åˆ¶å°æ‰§è¡Œ
const db = wx.cloud.database()

// æ·»åŠ æµ‹è¯•ä¾›åº”å•†
const suppliers = [
  { name: "åº·ç¾è¯ä¸š", code: "SUP001", contact: "å¼ ç»ç†", phone: "13800138000" },
  { name: "ä¹å·é€šåŒ»è¯", code: "SUP002", contact: "æç»ç†", phone: "13800138001" },
  { name: "åæ¶¦åŒ»è¯", code: "SUP003", contact: "ç‹ç»ç†", phone: "13800138002" },
  { name: "å›½è¯é›†å›¢", code: "SUP004", contact: "èµµç»ç†", phone: "13800138003" }
]

suppliers.forEach(async (item) => {
  await db.collection('suppliers').add({
    data: {
      ...item,
      status: 'active',
      createTime: new Date(),
      updateTime: new Date()
    }
  })
})

console.log('æµ‹è¯•æ•°æ®æ·»åŠ å®Œæˆï¼')
```

---

## ğŸ’¡ æç¤º

1. **æ¸è¿›å¼ä¿®æ”¹**ï¼šå»ºè®®å…ˆå®Œæˆä¾›åº”å•†é€‰æ‹©åŠŸèƒ½ï¼Œæµ‹è¯•æ— è¯¯åå†ä¼˜åŒ–ç©ºçŠ¶æ€
2. **ä¿ç•™åŸåŠŸèƒ½**ï¼šä¿®æ”¹æ—¶ä¿ç•™åŸæœ‰çš„æ‰‹åŠ¨è¾“å…¥åŠŸèƒ½ä½œä¸ºå¤‡ä»½
3. **æ•°æ®è¿ç§»**ï¼šå¦‚æœå·²æœ‰å…¥åº“è®°å½•ï¼Œå¯èƒ½éœ€è¦è¿ç§»ä¾›åº”å•†æ•°æ®

---

**ç¥æ‚¨ä¼˜åŒ–é¡ºåˆ©ï¼** ğŸ‰







