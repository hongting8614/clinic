# 功能测试清单

## 📅 测试日期
2024年11月

## 🎯 测试目的
验证代码优化后所有功能正常运行，确保没有引入bug。

---

## ✅ 测试环境

- [ ] 微信开发者工具已打开
- [ ] 项目已编译
- [ ] 云函数已部署
- [ ] 测试数据已准备

---

## 📋 核心功能测试

### 1️⃣ 药材入库 (pages-sub/in/add.vue)

#### ✅ 基础功能
- [ ] 页面正常打开
- [ ] 入库单号自动生成
- [ ] 当前时间正确显示
- [ ] 操作人信息正确

#### ✅ 药材添加（重点测试）
- [ ] 点击「➕ 手动添加药材」按钮
- [ ] 弹出药材选择器
- [ ] 搜索框可以输入
- [ ] 搜索结果正确显示
- [ ] 选择药材后添加到列表
- [ ] **确认没有扫码相关按钮或提示** ⭐

#### ✅ 药材信息录入
- [ ] 批号可以输入
- [ ] 生产日期可以选择（重点：确认日期选择器正常工作）
- [ ] 有效期可以选择（重点：确认日期选择器正常工作）
- [ ] 数量可以输入
- [ ] 单价可以输入
- [ ] 药材代码正确显示
- [ ] 规格信息正确显示

#### ✅ 空状态提示
- [ ] 未添加药材时显示：「💊 暂无药材，请点击上方按钮添加」
- [ ] 提示文字清晰、友好

#### ✅ 签名和提交
- [ ] 签名功能正常
- [ ] 提交按钮可点击
- [ ] 提交成功后有提示

#### 🧪 测试用例
```
测试场景1：添加单个药材
1. 点击「手动添加药材」
2. 搜索"阿莫西林"
3. 选择药材
4. 填写批号：20241101
5. 选择生产日期：2024-11-01
6. 选择有效期：2026-11-01
7. 输入数量：10
8. 输入单价：5.50
9. 签名
10. 提交

预期：✅ 提交成功，跳转到列表页

测试场景2：添加多个药材
1. 添加3-5个不同药材
2. 每个都完整填写信息
3. 签名提交

预期：✅ 所有药材都正确保存
```

---

### 2️⃣ 药材出库 (pages-sub/out/add.vue)

#### ✅ 基础功能
- [ ] 页面正常打开
- [ ] 出库单号自动生成
- [ ] 园区选择器正常（陆园/水园）

#### ✅ 药材添加（重点测试）
- [ ] 点击「➕ 添加药材」按钮
- [ ] 药材选择器正常工作
- [ ] 选择药材后显示库存信息
- [ ] **确认没有扫码相关按钮或提示** ⭐

#### ✅ 单位转换提示
- [ ] 选择药材后显示转换提示
- [ ] 例如：「🔄 将转换为 1000 片 存入陆园」
- [ ] 转换率计算正确

#### ✅ 空状态提示
- [ ] 未添加药材时显示：「💊 暂无药材，请点击上方按钮添加」

#### ✅ 签名和提交
- [ ] 发放人签名正常
- [ ] 提交成功

#### 🧪 测试用例
```
测试场景：出库到陆园
1. 选择园区：陆园
2. 点击「添加药材」
3. 选择"阿莫西林胶囊"
4. 查看单位转换提示（10盒 → 1000粒）
5. 输入数量：5（盒）
6. 签名
7. 提交

预期：
✅ 提交成功
✅ 总库存扣减 5 盒
✅ 陆园库存增加 500 粒
```

---

### 3️⃣ 门诊登记 (pages-sub/clinic/add.vue)

#### ✅ 基础功能
- [ ] 页面正常打开
- [ ] 患者信息录入正常
- [ ] 疾病名称下拉列表正常

#### ✅ 药材选择（重点测试）
- [ ] 选择园区（陆园/水园）
- [ ] 点击药材名称输入框
- [ ] 显示该园区的所有药材
- [ ] 搜索功能正常
- [ ] 选择药材后显示详细信息
- [ ] **确认没有扫码功能** ⭐

#### ✅ 用药信息显示
- [ ] 药材名称正确显示
- [ ] 药材代码正确显示
- [ ] 规格信息正确显示
- [ ] 库存数量正确显示
- [ ] 单位显示正确（最小单位）

#### ✅ 库存扣减
- [ ] 输入用药数量
- [ ] 提交后从园区库存扣减
- [ ] 扣减单位正确（最小单位）

#### 🧪 测试用例
```
测试场景：陆园门诊用药
1. 选择就诊园区：陆园
2. 填写患者信息
3. 填写主诉、诊断、疾病名称
4. 点击药材名称输入框
5. 看到陆园的所有可用药材
6. 选择"阿莫西林"
7. 输入数量：20（粒）
8. 签名
9. 提交

预期：
✅ 提交成功
✅ 陆园库存扣减 20 粒
✅ 记录保存完整
```

---

### 4️⃣ 药材档案 (pages-sub/drug/add.vue)

#### ✅ 扫码功能（唯一保留扫码的页面）
- [ ] 页面有「📷 扫码添加药材」按钮
- [ ] 点击扫码按钮正常
- [ ] 扫码后可以填充信息
- [ ] **确认这是唯一有扫码的页面** ⭐

#### ✅ 手动添加
- [ ] 手动填写所有字段
- [ ] 保存成功

#### 🧪 测试用例
```
测试场景：扫码添加新药材
1. 点击「📷 扫码添加药材」
2. 扫描条形码
3. 确认条形码填充到字段
4. 补充其他信息（名称、规格、单位等）
5. 保存

预期：✅ 药材档案创建成功
```

---

### 5️⃣ 药材请领 (pages-sub/requisition/add.vue)

#### ✅ 基础功能
- [ ] 页面正常打开
- [ ] 添加药材功能正常
- [ ] **确认没有扫码功能** ⭐

#### ✅ 空状态提示
- [ ] 显示：「💊 暂无药材，请点击上方按钮添加」

---

### 6️⃣ 日消耗记录 (pages-sub/consume/add.vue)

#### ✅ 基础功能
- [ ] 页面正常打开
- [ ] 园区选择正常
- [ ] 添加药材功能正常
- [ ] **确认没有扫码功能** ⭐

---

## 🔍 界面检查

### ✅ 样式一致性
- [ ] 所有添加按钮样式统一
- [ ] 空状态提示样式统一
- [ ] 字体大小一致
- [ ] 间距合理

### ✅ 交互体验
- [ ] 按钮点击响应正常
- [ ] 弹窗打开/关闭流畅
- [ ] 加载提示正确显示
- [ ] 错误提示友好清晰

### ✅ 兼容性
- [ ] iOS 系统正常运行
- [ ] Android 系统正常运行
- [ ] 不同屏幕尺寸显示正常

---

## 🐛 回归测试（重点）

### ✅ 扫码功能清理验证
- [ ] 入库页面：无扫码按钮 ✅
- [ ] 出库页面：无扫码按钮 ✅
- [ ] 门诊登记：无扫码按钮 ✅
- [ ] 日消耗：无扫码按钮 ✅
- [ ] 药材请领：无扫码按钮 ✅
- [ ] 药材档案：**有**扫码按钮 ✅

### ✅ 类名优化验证
- [ ] 入库页面：使用 action-buttons 类
- [ ] 出库页面：使用 action-buttons 类
- [ ] 药材请领：使用 action-buttons 类

### ✅ 空状态提示验证
- [ ] 入库页面：「💊 暂无药材，请点击上方按钮添加」
- [ ] 出库页面：「💊 暂无药材，请点击上方按钮添加」
- [ ] 药材请领：「💊 暂无药材，请点击上方按钮添加」

---

## 🚨 重点测试项

### ⭐ 最高优先级
1. **日期选择器功能**（入库页面）
   - 之前有修复，需要重点验证
   - 生产日期可以选择
   - 有效期可以选择

2. **扫码功能清理**
   - 除药材档案外，其他页面都不应有扫码按钮
   - 不应有扫码相关的错误或提示

3. **单位转换逻辑**
   - 出库时正确转换
   - 门诊用药时正确扣减

### 🟡 中优先级
1. **药材选择功能**
   - 所有页面的手动选择都正常
   - 搜索功能正常
   - 下拉列表正常

2. **签名功能**
   - 所有需要签名的页面都正常
   - 签名保存正确

3. **表单验证**
   - 必填项验证
   - 数量验证
   - 日期验证

---

## 📊 测试结果记录

### 测试通过标准
- [ ] 所有核心功能正常
- [ ] 无明显bug
- [ ] 性能流畅
- [ ] 用户体验良好

### 测试记录
```
测试人员：___________
测试日期：___________
测试环境：微信开发者工具 / 真机测试

通过项：____ / 总计 ____
失败项：____ 

备注：
_________________________________
_________________________________
_________________________________
```

---

## 🐛 问题追踪

如发现问题，请记录：

### 问题1
- **页面**：___________
- **问题描述**：___________
- **复现步骤**：___________
- **严重程度**：高/中/低
- **状态**：待修复/已修复

### 问题2
- **页面**：___________
- **问题描述**：___________
- **复现步骤**：___________
- **严重程度**：高/中/低
- **状态**：待修复/已修复

---

## ✅ 测试完成检查

- [ ] 所有核心功能已测试
- [ ] 所有重点项已验证
- [ ] 发现的问题已记录
- [ ] 测试报告已提交

---

## 🎯 下一步

测试通过后：
1. ✅ 部署到测试环境
2. ✅ 用户验收测试
3. ✅ 正式发布

测试未通过：
1. 记录所有问题
2. 优先修复高优先级bug
3. 重新测试

---

> 💡 **重要提示**：
> - 重点关注入库页面的日期选择器
> - 确认所有页面都没有扫码按钮（药材档案除外）
> - 验证单位转换逻辑正确性

> 🚀 **测试成功后即可投入使用！**

