# 🚀 入库功能快速测试指南

5分钟快速验证入库模块核心功能

---

## ⚡ 快速开始

### 1. 编译运行（2分钟）

```bash
# 方法1: HBuilderX
1. 打开 HBuilderX
2. 菜单 -> 运行 -> 运行到小程序模拟器 -> 微信开发者工具
3. 等待编译完成

# 方法2: 微信开发者工具
1. 打开微信开发者工具
2. 导入项目: D:\AK-PMS\unpackage\dist\dev\mp-weixin
3. 等待加载完成
```

### 2. 准备测试数据（1分钟）

在云开发控制台创建测试药材：

```javascript
// 进入云开发 -> 数据库 -> drugs 集合 -> 添加记录
{
  "name": "阿莫西林胶囊",
  "pinyin": "AMXLJN",
  "spec": "0.25g*24粒",
  "unit": "盒",
  "manufacturer": "XX制药",
  "barcode": "6901234567890",
  "category": "抗生素",
  "isHighValue": false,
  "isEmergency": false,
  "safeStock": 100,
  "minStock": 50,
  "createTime": new Date()
}
```

---

## 🎯 核心功能测试（3分钟）

### 测试1: 扫码添加药材（30秒）

```
1. 点击"入库管理"（首页快捷入口或底部菜单）
2. 点击"+ 新建入库单"
3. 点击"📷 扫码入库"按钮
4. 扫描测试条形码（或模拟扫码）
```

**✅ 验证点**:
- [ ] 药材自动添加到表格
- [ ] 药材名称、规格、单位、厂家正确显示
- [ ] 条形码正确显示

### 测试2: 从档案选择药材（30秒）

```
1. 点击"📋 从档案选择"按钮
2. 在药材列表中点击任意药材
```

**✅ 验证点**:
- [ ] 自动返回入库页
- [ ] 药材添加成功

### 测试3: 填写明细信息（1分钟）

```
1. 在表格中填写:
   - 批号: 20250101
   - 生产日期: 2025-01-01（点击日期选择器）
   - 有效期: 2027-01-01（点击日期选择器）
   - 入库数量: 100
   - 单价: 12.5
```

**✅ 验证点**:
- [ ] "距有效期(天)"自动计算
- [ ] "金额"自动计算（1250.00）
- [ ] 统计栏正确显示（总品种数、总数量、总金额）

### 测试4: 表格验证（30秒）

```
1. 清空批号，点击其他地方
2. 观察错误提示
3. 重新填写批号
```

**✅ 验证点**:
- [ ] 错误行背景变红
- [ ] 底部显示"第1行: 批号不能为空"
- [ ] 填写后错误消失

### 测试5: 签名提交（30秒）

```
1. 滚动到"操作员签名"区域
2. 手写签名（鼠标或触摸）
3. 点击"提交复核"按钮
```

**✅ 验证点**:
- [ ] 签名显示正常
- [ ] 提交成功，显示"提交成功"
- [ ] 自动返回列表页

### 测试6: 复核流程（30秒）

```
1. 切换到复核员账号（或使用模拟）
2. 在列表页点击"待复核"标签
3. 点击刚提交的入库单
4. 手写签名
5. 点击"通过复核"
6. 确认
```

**✅ 验证点**:
- [ ] 复核操作区显示
- [ ] 签名成功
- [ ] 提示"复核通过，库存已更新"
- [ ] 状态变为"已完成"

---

## 🔍 快速检查点

### UI检查
- [ ] 页面头部紫色渐变背景
- [ ] 工具栏按钮排列整齐
- [ ] 表格可横向滚动
- [ ] 表头固定不动
- [ ] 必填项有红色星号
- [ ] 统计栏显示正确

### 功能检查
- [ ] 扫码功能正常
- [ ] 从档案选择正常
- [ ] 日期选择器正常
- [ ] 自动计算正常（距有效期天数、金额、统计）
- [ ] 验证提示正确
- [ ] 签名功能正常
- [ ] 提交流程正常

### 数据检查
打开云开发控制台：

```
1. 数据库 -> in_records -> 查看记录
   - recordNo: RK20251104001（格式正确）
   - status: pending_review 或 completed
   - items: 包含药材明细
   - operatorSign: 签名URL
   - reviewerSign: 复核员签名URL（已复核）

2. 数据库 -> stock -> 查看库存（复核通过后）
   - 新增或更新对应批次的库存记录
   - quantity: 正确的数量
   - status: normal / near_expire / expired
```

---

## 🐛 常见问题

### Q1: 扫码功能不工作
**A**: 模拟器不支持真实扫码，需要真机预览。或使用"从档案选择"代替。

### Q2: 签名组件不显示
**A**: 检查 `components/signature/index.vue` 是否存在，检查组件导入是否正确。

### Q3: 云函数调用失败
**A**: 
1. 检查云开发环境是否已初始化
2. 检查云函数是否已上传
3. 检查云函数权限配置

### Q4: 表格显示错乱
**A**: 清除缓存，重新编译：
```bash
# HBuilderX: 项目 -> 清理 -> 清理项目缓存
# 或删除 unpackage 文件夹，重新编译
```

### Q5: 页面样式丢失
**A**: 检查 uView Plus 是否正确安装：
```bash
npm install uview-plus
```

---

## ✅ 测试完成检查清单

- [ ] 扫码添加药材成功
- [ ] 从档案选择药材成功
- [ ] 表格数据填写正常
- [ ] 验证提示正确
- [ ] 自动计算正确
- [ ] 签名功能正常
- [ ] 提交成功
- [ ] 列表显示正确
- [ ] 详情显示正确
- [ ] 复核流程正常
- [ ] 库存更新正确

**全部通过 = 测试成功！** ✅

---

## 📝 下一步

测试通过后，可以进行：

1. **完整测试**: 参考 `docs/入库功能测试计划.md`（63个测试用例）
2. **真机预览**: 使用真实设备测试扫码功能
3. **性能测试**: 测试大量数据下的性能表现
4. **压力测试**: 多用户并发测试

---

**快速测试完成！**如有问题，请查看详细测试计划或联系开发团队。









