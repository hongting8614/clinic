# 🚀 扫码功能 - 快速开始

## ⚡ 5分钟快速部署

### 方案A：不配置API（免费，手动录入）

```
1. 上传云函数
   右键 cloudfunctions/drugBarcodeQuery
   → 上传并部署：云端安装依赖
   
2. 创建数据库
   云开发控制台 → 数据库
   → 创建集合：drug_barcode_cache
   
3. 编译测试
   点击【编译】→【预览】→ 真机测试
   
✅ 完成！
```

**特点**：
- ✅ 本地药材可识别
- ✅ 扫码过的药材可识别
- ❌ 新药材需手动填写（但填写后自动记录）

---

### 方案B：配置API（推荐，自动识别）

```
1. 购买阿里云API（3分钟）
   访问：https://market.aliyun.com/
   搜索："商品条码查询"
   购买：按量付费（约¥0.01/次）
   
2. 获取APPCODE（1分钟）
   云市场 → 已购买的服务
   复制：你的APPCODE
   
3. 上传云函数（1分钟）
   右键 cloudfunctions/drugBarcodeQuery
   → 上传并部署：云端安装依赖
   
4. 配置环境变量（2分钟）
   云开发控制台 → 云函数 → drugBarcodeQuery
   → 配置 → 环境变量
   添加：ALIYUN_APPCODE = 你的APPCODE
   保存并重新部署
   
5. 创建数据库（1分钟）
   云开发控制台 → 数据库
   → 创建集合：drug_barcode_cache
   
6. 编译测试
   点击【编译】→【预览】→ 真机测试
   
✅ 完成！
```

**特点**：
- ✅ 本地药材可识别
- ✅ 扫码过的药材可识别
- ✅ 新药材自动识别（调用API）
- ✅ 自动缓存，越用越快

---

## 📖 使用方法

### 1. 扫码添加药材

```
入库单 → 新建药材 → 点击"扫描药材条形码"卡片
→ 对准条形码扫描
→ 自动填充药材信息 ✅
```

### 2. 首次扫描新药材（未配置API）

```
扫描 → 提示"未找到药材"
→ 手动填写：
   - 药材名称：阿莫西林胶囊
   - 规格：0.25g×24粒
   - 单位：盒
→ 点击"确定添加"
→ 系统自动记录 ✅

下次扫码同一药材 → 自动识别！
```

### 3. 首次扫描新药材（已配置API）

```
扫描 → 识别中...（调用API）
→ 识别成功！(中国物品编码中心)
→ 自动填充：
   - 药材名称：阿莫西林胶囊
   - 规格：0.25g×24粒
   - 单位：盒
   - 厂家：XX制药有限公司
→ 点击"确定添加" ✅

下次扫码 → 秒识别（缓存）
```

---

## 💰 成本对比

### 方案A（不配置API）

| 项目 | 成本 |
|------|------|
| 云函数 | 免费（免费额度内） |
| 数据库 | 免费（免费额度内） |
| API调用 | 无 |
| **总计** | **¥0/月** |

**优点**：完全免费  
**缺点**：新药材需手动填写（但只需填写一次）

---

### 方案B（配置API）

| 项目 | 成本 |
|------|------|
| 云函数 | 免费（免费额度内） |
| 数据库 | 免费（免费额度内） |
| API调用 | ¥3/月（每天10次新药材） |
| **总计** | **¥3/月** |

**第2个月**：约¥1.5/月（缓存命中率90%+）  
**第3个月**：约¥0.5/月（缓存命中率95%+）

**优点**：新药材自动识别，体验好  
**缺点**：每月小额成本

---

## 🎯 推荐方案

### 适合方案A的场景：
- ✅ 药材种类少（50种以下）
- ✅ 药材固定，很少有新品
- ✅ 预算紧张
- ✅ 愿意花时间预先录入

### 适合方案B的场景：
- ✅ 药材种类多（100种以上）
- ✅ 经常有新药材入库
- ✅ 追求效率
- ✅ 接受小额成本（月成本<5元）

---

## ❓ 常见问题

### Q：不配置API，每次都要手动填写吗？

**答**：不是！
- 第1次：手动填写
- 第2次及以后：自动识别

系统会记住你填写的内容！

---

### Q：配置API后，还需要手动填写吗？

**答**：极少情况需要！
- API数据库中有的药材：自动识别
- API数据库中没有的药材：手动填写（但会记录）

约95%的药材都能自动识别！

---

### Q：哪个方案更好？

**答**：建议方案B！
- 只需¥3/月
- 节省大量时间
- 用户体验好
- 越用越便宜

**一杯奶茶的钱，换来极大的便利！** ☕

---

### Q：API会不会很贵？

**答**：不会！
- 单次查询：¥0.01
- 每天10次：¥0.30
- 每月：约¥3

**而且**：
- 查询过的药材会缓存
- 第2个月成本减半
- 第3个月几乎不花钱

---

### Q：可以先不配置，以后再配置吗？

**答**：可以！
1. 先用方案A（免费）
2. 觉得手动填写麻烦
3. 随时购买API
4. 配置环境变量
5. 立即生效

**非常灵活！**

---

## 🎉 开始使用

### 新手推荐：

**第1步**：先用方案A，免费测试  
**第2步**：体验1-2天  
**第3步**：觉得好用，升级到方案B  

### 高级用户推荐：

直接用方案B，一步到位！

---

## 📞 需要帮助？

查看详细文档：
1. [扫码功能部署指南](./扫码功能部署指南.md)
2. [第三方API配置指南](./第三方API配置指南.md)
3. [扫码功能使用说明](./扫码功能使用说明.md)

---

**现在就开始吧！** 🚀




