# 北京欢乐谷医务室药品管理系统 - 需求文档

## 📋 项目概述

### 项目名称
AK-PMS (北京欢乐谷医务室药品管理系统)

### 项目定位
- **使用场景**：小规模药品管理
- **使用设备**：手机端（微信小程序）
- **使用人员**：医务室管理员
- **核心目标**：库房与药房日常出入库、盘点、报表、有效期管理

### 技术栈
- **前端**：Uniapp (Vue3 + TypeScript) + uView Plus
- **后端**：微信云开发 (Node.js 云函数)
- **数据库**：CloudBase 云数据库 (MongoDB兼容)
- **存储**：Cloud Storage (云存储)
- **报表**：ECharts + xlsx.js + pdfkit

---

## 🎯 核心功能清单

### 1. 药品档案管理
```
✅ 药品信息
  ├─ 药品名称 *
  ├─ 规格 *
  ├─ 单位 *
  ├─ 生产厂家 *
  ├─ 药品分类
  ├─ 条形码 * (扫码识别用)
  ├─ 拼音首字母 (搜索用)
  ├─ 安全库存
  └─ 药品图片 (选填)

✅ 特殊标记
  ├─ 高值药品 (出库时二次确认)
  └─ 急救药品 (零库存立即预警)

✅ 批量导入
  └─ Excel批量导入药品档案
```

---

### 2. 入库管理
```
✅ 扫码自动填充
  ├─ 扫描条形码识别药品
  ├─ 自动填充：药品名称、规格、单位、生产厂家
  └─ 手动补充：批号、生产日期、有效期、数量

✅ 连续扫码模式
  ├─ 扫码 → 快速录入 → 自动返回继续扫码
  └─ 适合批量入库

✅ 双人分步签名
  ├─ 操作员签名 → 状态：待复核
  ├─ 复核员签名 → 状态：已完成
  └─ 库存增加

✅ 统一字段
  药品名称、规格、单位、批号、生产日期、有效期、数量、生产厂家
  单价（选填）、供应商（选填）

✅ 导出格式
  📄 仅PDF (带双签名)
```

---

### 3. 出库管理
```
✅ 园区选择
  ├─ 陆园 (默认)
  ├─ 水园
  └─ 可手动切换

✅ 扫码自动填充
  ├─ 扫描条形码识别药品
  ├─ 自动加载批次列表 (按FIFO排序)
  └─ 选择批次、填写数量

✅ 高值药品二次确认
  ├─ 出库高值药品时弹窗
  └─ 显示单价、总价，要求再次确认

✅ 双人分步签名
  ├─ 发放人签名 → 状态：待复核
  ├─ 接收人签名 → 状态：已完成
  └─ 库存扣减

✅ 统一字段
  药品名称、规格、单位、批号、有效期、数量、生产厂家
  单价（选填）、园区 *

✅ 导出格式
  📄 仅PDF (带双签名)
```

---

### 4. 园区间调拨
```
✅ 调拨方向
  ├─ 陆园 → 水园
  └─ 水园 → 陆园

✅ 双人分步签名
  ├─ 调出方签名 → 状态：待复核
  ├─ 调入方签名 → 状态：已完成
  └─ 双方库存同步更新

✅ 统一字段
  药品名称、规格、单位、批号、有效期、数量、生产厂家
  调出园区 *、调入园区 *

✅ 导出格式
  📄 仅PDF (带双签名)
```

---

### 5. 药房日消耗
```
✅ 园区选择
  ├─ 陆园 (默认)
  ├─ 水园
  └─ 从指定园区药房扣减库存

✅ 自动记录人
  ├─ 记录人：自动获取当前登录用户
  └─ 不可手动修改

✅ 固定时间录入
  ├─ 建议：每天固定时间（如下午5点）
  └─ 统计当天消耗

✅ 扫码录入
  ├─ 扫描条形码识别药品
  ├─ 选择批次
  └─ 填写消耗数量

✅ 统一字段
  药品名称、规格、单位、批号、有效期、消耗数量、生产厂家
  日期 *、园区 *、记录人 (自动)

✅ 导出格式
  📄 PDF / 📊 Excel
```

---

### 6. 部门请领
```
✅ 园区选择
  ├─ 陆园 (默认)
  ├─ 水园
  └─ 从指定园区药房扣减库存

✅ 自定义部门
  ├─ 部门列表（内科、外科、急诊...）
  ├─ 可添加、编辑、删除
  └─ 部门信息：名称、负责人、电话

✅ 扫码请领
  ├─ 选择部门
  ├─ 扫码识别药品
  ├─ 选择批次
  └─ 填写数量

✅ 双人同时签名
  ├─ 请领人签名
  ├─ 发放人签名
  ├─ 两人都签完才能保存
  └─ 状态：已完成

✅ 统一字段
  药品名称、规格、单位、批号、有效期、数量、生产厂家
  园区 *、部门 *、单价（选填）

✅ 导出格式
  📄 仅PDF (带双签名)
```

---

### 7. 库存盘点
```
✅ 月度盘点
  ├─ 所有药品每月盘点一次
  └─ 不区分高值药品

✅ 扫码盘点
  ├─ 扫描条形码识别药品
  ├─ 选择批次
  ├─ 显示账面数量
  ├─ 填写实盘数量
  └─ 自动计算差异

✅ 双人分步签名
  ├─ 盘点人签名 → 状态：待复核
  ├─ 复核人签名 → 状态：已完成
  └─ 库存自动校正

✅ 统一字段
  药品名称、规格、单位、批号、有效期、账面数量、实盘数量、差异、生产厂家
  差异原因 (选填)

✅ 导出格式
  📄 仅PDF (带双签名)
```

---

### 8. 药品报损
```
✅ 报损类型
  ├─ 过期报损
  ├─ 破损报损
  ├─ 质量问题
  └─ 其他

✅ 简单报损流程
  ├─ 创建报损单
  ├─ 填写报损原因
  ├─ 拍照上传 (必须)
  ├─ 单人签名确认
  └─ 库存扣减

✅ 统一字段
  药品名称、规格、单位、批号、有效期、报损数量、生产厂家
  报损类型 *、报损原因 *、报损照片 *

✅ 导出格式
  📄 仅PDF (带签名)
```

---

### 9. 药品退货
```
✅ 退货出库单
  ├─ 创建退货出库单
  ├─ 填写退货原因
  ├─ 拍照上传
  └─ 双人分步签名

✅ 统一字段
  药品名称、规格、单位、批号、有效期、退货数量、生产厂家
  退货原因 *、供应商 *、退货照片 *

✅ 导出格式
  📄 仅PDF (带双签名)
```

---

### 10. 库存查询
```
✅ 实时库存
  ├─ 当前库存总览
  ├─ 按药品查看
  ├─ 按批次查看
  └─ 按园区查看

✅ 零库存显示
  ├─ 零库存药品依然显示
  ├─ 标记为"缺货"
  └─ 可快速创建采购申请

✅ 批次明细
  ├─ 批号
  ├─ 生产日期
  ├─ 有效期
  ├─ 剩余数量
  └─ 库位（后续扩展）

✅ 库存流水
  ├─ 入库记录
  ├─ 出库记录
  ├─ 消耗记录
  ├─ 请领记录
  └─ 盘点记录
```

---

### 11. 库存预警
```
✅ 全局统一预警值
  ├─ 最低库存：50 (可配置)
  ├─ 安全库存：100 (可配置)
  └─ 所有药品统一标准

✅ 预警类型
  ├─ 库存不足预警 (低于安全库存)
  ├─ 零库存预警
  └─ 急救药品零库存立即预警 (🚨)

✅ 预警推送
  ├─ 小程序订阅消息
  └─ 首页预警提醒
```

---

### 12. 有效期管理
```
✅ 单级预警
  ├─ 90天内到期：黄色预警
  └─ 每周推送一次

✅ 效期监控
  ├─ 近效期药品清单
  ├─ 已过期药品清单
  └─ 效期日历视图

✅ FIFO自动推荐
  ├─ 出库时优先推荐近效期批次
  └─ 批次列表按效期排序

✅ 过期处理
  ├─ 自动标记过期药品
  ├─ 推送过期提醒
  └─ 引导创建报损单
```

---

### 13. 报表统计
```
✅ 时间维度
  ├─ 日统计
  ├─ 周统计
  ├─ 月统计
  ├─ 年统计
  └─ 自定义时间段

✅ 入库统计
  ├─ 入库总量/金额
  ├─ 按药品统计
  ├─ 按供应商统计
  └─ 入库趋势图

✅ 出库统计
  ├─ 出库总量/金额
  ├─ 按园区统计
  ├─ 按药品统计
  └─ 出库趋势图

✅ 消耗统计
  ├─ 消耗总量
  ├─ 日均消耗
  └─ 消耗排行

✅ 请领统计
  ├─ 按部门统计
  ├─ 按药品统计
  └─ 请领频率

✅ 库存统计
  ├─ 当前库存
  ├─ 库存周转率
  └─ 库存金额

✅ 导出格式
  📄 PDF / 📊 Excel
```

---

### 14. 单据状态管理
```
✅ 状态流转
  草稿 → 待复核 → 已完成
    ↓       ↓
   删除    已驳回 → 可修改重新提交

✅ 驳回后处理
  ├─ 状态变为"已驳回"
  ├─ 操作员可修改
  ├─ 重新提交
  └─ 再次进入复核流程

✅ 操作权限
  ├─ 草稿：可编辑、可删除
  ├─ 待复核：不可编辑、可驳回
  ├─ 已驳回：可编辑、可重新提交
  └─ 已完成：不可编辑、不可删除
```

---

### 15. 签名功能
```
✅ 全屏签名板
  ├─ 点击签名区域 → 全屏签名界面
  ├─ 支持横屏签名
  ├─ 实时预览
  ├─ 可清空重签
  └─ 确认后保存

✅ 签名规则
  入库单：双人分步签名 (操作员 → 复核员)
  出库单：双人分步签名 (发放人 → 接收人)
  调拨单：双人分步签名 (调出方 → 调入方)
  请领单：双人同时签名 (请领人 + 发放人)
  盘点单：双人分步签名 (盘点人 → 复核人)
  报损单：单人签名 (报损人)
  退货单：双人分步签名 (发起人 → 复核人)

✅ 签名约束
  ├─ 双签必须两个不同用户ID
  ├─ 不允许同一人自签自审
  └─ 签名图片保存云存储
```

---

### 16. 系统基础功能
```
✅ 用户管理
  ├─ 用户姓名、手机号
  ├─ 微信openid绑定
  ├─ 角色：管理员 (全部权限)
  └─ 状态：启用/停用

✅ 部门管理
  ├─ 部门列表
  ├─ 添加/编辑/删除
  ├─ 部门信息：名称、负责人、电话
  └─ 启用/停用

✅ 园区管理
  ├─ 陆园
  ├─ 水园
  └─ 可扩展其他园区

✅ 系统配置
  ├─ 医务室名称：北京欢乐谷医务室 (可修改)
  ├─ 医务室地址、电话、负责人 (选填)
  ├─ 安全库存阈值：100 (可配置)
  ├─ 最低库存阈值：50 (可配置)
  └─ 效期预警天数：90 (可配置)
```

---

## 📱 页面结构

```
📱 AK-PMS 药品管理系统

底部导航 (Tabbar)
├─ 🏠 首页 (工作台)
│   ├─ 快捷操作 (扫码入库、扫码出库)
│   ├─ 今日数据 (入库、出库、消耗、请领)
│   ├─ 预警提醒 (库存不足、近效期、待复核)
│   └─ 待办任务 (待我复核)
│
├─ 📦 库存
│   ├─ 库存总览 (总量、总金额、预警数)
│   ├─ 药品列表 (搜索、筛选)
│   ├─ 药品详情 (批次明细、库存流水)
│   ├─ 近效期药品
│   └─ 零库存/缺货药品
│
├─ 📋 单据
│   ├─ 入库管理
│   │   ├─ 新建入库
│   │   ├─ 待复核入库
│   │   └─ 已完成入库
│   ├─ 出库管理
│   │   ├─ 新建出库
│   │   ├─ 待复核出库
│   │   └─ 已完成出库
│   ├─ 调拨管理
│   │   ├─ 新建调拨
│   │   ├─ 待复核调拨
│   │   └─ 已完成调拨
│   ├─ 消耗记录
│   │   ├─ 新建消耗
│   │   └─ 消耗历史
│   ├─ 请领管理
│   │   ├─ 新建请领
│   │   └─ 已完成请领
│   ├─ 盘点管理
│   │   ├─ 新建盘点
│   │   ├─ 待复核盘点
│   │   └─ 已完成盘点
│   ├─ 报损管理
│   │   ├─ 新建报损
│   │   └─ 报损历史
│   └─ 退货管理
│       ├─ 新建退货
│       ├─ 待复核退货
│       └─ 已完成退货
│
└─ 👤 我的
    ├─ 个人信息
    ├─ 待我复核 (重要入口)
    ├─ 我的操作记录
    ├─ 报表中心
    │   ├─ 日统计
    │   ├─ 周统计
    │   ├─ 月统计
    │   ├─ 年统计
    │   └─ 自定义统计
    ├─ 系统设置 (管理员)
    │   ├─ 药品管理
    │   ├─ 用户管理
    │   ├─ 部门管理
    │   ├─ 园区管理
    │   ├─ 系统参数
    │   └─ 数据管理 (备份/导入/导出)
    └─ 帮助与反馈
```

---

## 💾 数据库设计

### 1. users (用户表)
```javascript
{
  _id: "user_001",
  openid: "oXXXX",           // 微信openid
  name: "张三",              // 姓名
  phone: "138xxxx1234",      // 手机号
  role: "admin",             // 角色：admin
  status: "active",          // 状态：active/inactive
  createTime: "2025-01-27",
  updateTime: "2025-01-27"
}
```

### 2. drugs (药品档案表)
```javascript
{
  _id: "drug_001",
  name: "阿莫西林胶囊",       // 药品名称
  pinyin: "AMXLJN",          // 拼音首字母
  spec: "0.25g*24粒",        // 规格
  unit: "盒",                // 单位
  manufacturer: "XX制药有限公司", // 生产厂家
  category: "抗生素",        // 分类
  barcode: "6901234567890",  // 条形码
  image: "cloud://xxx.png",  // 药品图片
  
  // 特殊标记
  isHighValue: false,        // 是否高值药品
  isEmergency: false,        // 是否急救药品
  
  safeStock: 100,            // 安全库存
  minStock: 50,              // 最低库存
  
  createTime: "2025-01-27",
  updateTime: "2025-01-27"
}
```

### 3. stock (库存表)
```javascript
{
  _id: "stock_001",
  drugId: "drug_001",
  drugName: "阿莫西林胶囊",
  spec: "0.25g*24粒",
  unit: "盒",
  manufacturer: "XX制药有限公司",
  
  batch: "20250101",          // 批号
  productionDate: "2025-01-01", // 生产日期
  expireDate: "2027-01-01",   // 有效期
  quantity: 850,              // 库存数量
  price: 12.5,                // 单价（选填）
  
  location: "land_park",      // 所属园区：land_park/water_park
  status: "normal",           // 状态：normal/near_expire/expired
  
  updateTime: "2025-01-27"
}
```

### 4. in_records (入库记录表)
```javascript
{
  _id: "in_001",
  recordNo: "RK20250127001",
  status: "completed",        // draft/pending_review/rejected/completed
  
  items: [
    {
      drugId: "drug_001",
      drugName: "阿莫西林胶囊",
      spec: "0.25g*24粒",
      unit: "盒",
      manufacturer: "XX制药有限公司",
      batch: "20250101",
      productionDate: "2025-01-01",
      expireDate: "2027-01-01",
      quantity: 1000,
      price: 12.5             // 选填
    }
  ],
  
  supplier: "XX医药公司",      // 选填
  
  // 双签
  operator: "张三",
  operatorId: "user_001",
  operatorSign: "cloud://sign1.png",
  operatorSignTime: "2025-01-27 10:30:00",
  
  reviewer: "李四",
  reviewerId: "user_002",
  reviewerSign: "cloud://sign2.png",
  reviewerSignTime: "2025-01-27 11:00:00",
  
  rejectReason: "",           // 驳回原因（如果被驳回）
  
  createTime: "2025-01-27 10:20:00",
  completeTime: "2025-01-27 11:00:00"
}
```

### 5. out_records (出库记录表)
```javascript
{
  _id: "out_001",
  recordNo: "CK20250127001",
  status: "completed",
  
  location: "land_park",      // 出库园区
  locationName: "陆园",
  
  items: [
    {
      drugId: "drug_001",
      drugName: "阿莫西林胶囊",
      spec: "0.25g*24粒",
      unit: "盒",
      manufacturer: "XX制药有限公司",
      batch: "20250101",
      expireDate: "2027-01-01",
      quantity: 100,
      price: 12.5             // 选填
    }
  ],
  
  remark: "",
  
  // 双签
  dispenser: "张三",
  dispenserId: "user_001",
  dispenserSign: "cloud://sign1.png",
  dispenserSignTime: "2025-01-27 14:25:00",
  
  receiver: "李四",
  receiverId: "user_002",
  receiverSign: "cloud://sign2.png",
  receiverSignTime: "2025-01-27 15:00:00",
  
  createTime: "2025-01-27 14:20:00",
  completeTime: "2025-01-27 15:00:00"
}
```

### 6. transfer_records (园区调拨记录表)
```javascript
{
  _id: "trans_001",
  recordNo: "DB20250127001",
  status: "completed",
  
  fromLocation: "land_park",   // 调出园区
  fromLocationName: "陆园",
  toLocation: "water_park",    // 调入园区
  toLocationName: "水园",
  
  items: [
    {
      drugId: "drug_001",
      drugName: "阿莫西林胶囊",
      spec: "0.25g*24粒",
      unit: "盒",
      manufacturer: "XX制药有限公司",
      batch: "20250101",
      expireDate: "2027-01-01",
      quantity: 50
    }
  ],
  
  // 双签
  sender: "张三",
  senderId: "user_001",
  senderSign: "cloud://sign1.png",
  senderSignTime: "2025-01-27 16:00:00",
  
  receiver: "王五",
  receiverId: "user_003",
  receiverSign: "cloud://sign2.png",
  receiverSignTime: "2025-01-27 16:30:00",
  
  createTime: "2025-01-27 15:50:00",
  completeTime: "2025-01-27 16:30:00"
}
```

### 7. consume_records (消耗记录表)
```javascript
{
  _id: "con_001",
  date: "2025-01-27",
  
  items: [
    {
      drugId: "drug_001",
      drugName: "阿莫西林胶囊",
      spec: "0.25g*24粒",
      unit: "盒",
      manufacturer: "XX制药有限公司",
      batch: "20250101",
      expireDate: "2027-01-01",
      quantity: 50
    }
  ],
  
  operator: "张三",           // 自动获取
  operatorId: "user_001",
  
  remark: "",
  
  createTime: "2025-01-27 17:00:00"
}
```

### 8. requisition_records (请领记录表)
```javascript
{
  _id: "req_001",
  recordNo: "QL20250127001",
  status: "completed",
  
  deptId: "dept_001",
  deptName: "内科",
  
  items: [
    {
      drugId: "drug_001",
      drugName: "阿莫西林胶囊",
      spec: "0.25g*24粒",
      unit: "盒",
      manufacturer: "XX制药有限公司",
      batch: "20250101",
      expireDate: "2027-01-01",
      quantity: 20,
      price: 12.5             // 选填
    }
  ],
  
  // 双签（同时）
  requester: "王医生",
  requesterId: "user_004",
  requesterSign: "cloud://sign1.png",
  requesterSignTime: "2025-01-27 16:25:00",
  
  dispenser: "李药师",
  dispenserId: "user_002",
  dispenserSign: "cloud://sign2.png",
  dispenserSignTime: "2025-01-27 16:26:00",
  
  createTime: "2025-01-27 16:20:00",
  completeTime: "2025-01-27 16:26:00"
}
```

### 9. inventory_records (盘点记录表)
```javascript
{
  _id: "inv_001",
  recordNo: "PD20250127001",
  status: "completed",
  
  items: [
    {
      drugId: "drug_001",
      drugName: "阿莫西林胶囊",
      spec: "0.25g*24粒",
      unit: "盒",
      manufacturer: "XX制药有限公司",
      batch: "20250101",
      expireDate: "2027-01-01",
      bookQuantity: 850,      // 账面数量
      actualQuantity: 848,    // 实盘数量
      difference: -2,         // 差异
      differenceReason: "破损2盒" // 差异原因
    }
  ],
  
  // 双签
  operator: "王五",
  operatorId: "user_003",
  operatorSign: "cloud://sign1.png",
  operatorSignTime: "2025-01-27 18:30:00",
  
  reviewer: "张三",
  reviewerId: "user_001",
  reviewerSign: "cloud://sign2.png",
  reviewerSignTime: "2025-01-27 19:00:00",
  
  createTime: "2025-01-27 18:00:00",
  completeTime: "2025-01-27 19:00:00"
}
```

### 10. damage_records (报损记录表)
```javascript
{
  _id: "dmg_001",
  recordNo: "BS20250127001",
  status: "completed",
  
  damageType: "expired",      // expired/damaged/quality/other
  
  items: [
    {
      drugId: "drug_001",
      drugName: "阿莫西林胶囊",
      spec: "0.25g*24粒",
      unit: "盒",
      manufacturer: "XX制药有限公司",
      batch: "20250101",
      expireDate: "2027-01-01",
      quantity: 10
    }
  ],
  
  reason: "药品过期",         // 报损原因
  photos: [                   // 报损照片（必须）
    "cloud://photo1.png",
    "cloud://photo2.png"
  ],
  
  // 单签
  operator: "张三",
  operatorId: "user_001",
  operatorSign: "cloud://sign.png",
  operatorSignTime: "2025-01-27 10:00:00",
  
  createTime: "2025-01-27 09:50:00",
  completeTime: "2025-01-27 10:00:00"
}
```

### 11. return_records (退货记录表)
```javascript
{
  _id: "ret_001",
  recordNo: "TH20250127001",
  status: "completed",
  
  supplier: "XX医药公司",      // 供应商
  
  items: [
    {
      drugId: "drug_001",
      drugName: "阿莫西林胶囊",
      spec: "0.25g*24粒",
      unit: "盒",
      manufacturer: "XX制药有限公司",
      batch: "20250101",
      expireDate: "2027-01-01",
      quantity: 50
    }
  ],
  
  reason: "质量问题",         // 退货原因
  photos: [                   // 退货照片
    "cloud://photo1.png"
  ],
  
  // 双签
  initiator: "张三",
  initiatorId: "user_001",
  initiatorSign: "cloud://sign1.png",
  initiatorSignTime: "2025-01-27 14:00:00",
  
  reviewer: "李四",
  reviewerId: "user_002",
  reviewerSign: "cloud://sign2.png",
  reviewerSignTime: "2025-01-27 14:30:00",
  
  createTime: "2025-01-27 13:50:00",
  completeTime: "2025-01-27 14:30:00"
}
```

### 12. departments (部门表)
```javascript
{
  _id: "dept_001",
  name: "内科",              // 部门名称
  manager: "张医生",         // 负责人
  phone: "138xxxx1234",     // 联系电话
  status: "active",         // active/inactive
  sort: 1,
  createTime: "2025-01-27",
  updateTime: "2025-01-27"
}
```

### 13. locations (园区配置表)
```javascript
{
  _id: "loc_001",
  code: "land_park",        // 园区代码
  name: "陆园",             // 园区名称
  icon: "🏞️",              // 图标
  status: "active",
  sort: 1,
  createTime: "2025-01-27"
}
```

### 14. system_config (系统配置表)
```javascript
{
  _id: "config_001",
  
  // 医务室信息
  clinicName: "北京欢乐谷医务室",
  clinicAddress: "北京市朝阳区东四环小武基北路",
  clinicPhone: "010-12345678",
  clinicManager: "张主任",
  clinicLogo: "cloud://logo.png",
  
  // 业务参数
  safeStock: 100,            // 安全库存阈值
  minStock: 50,              // 最低库存阈值
  expireWarningDays: 90,     // 效期预警天数
  
  updateTime: "2025-01-27"
}
```

---

## 🎨 界面规范

### 表单抬头
```
┌─────────────────────────────────┐
│     北京欢乐谷医务室              │ ← 医务室名称（居中、加粗）
│        [表单名称]                │ ← 表单类型（居中）
├─────────────────────────────────┤
```

### 统一字段顺序
```
所有单据必含7字段：
  1. 药品名称
  2. 规格
  3. 单位
  4. 批号
  5. 有效期
  6. 数量
  7. 生产厂家
```

### PDF页眉页脚
```
页眉：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
         北京欢乐谷医务室
           [表单名称]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

页脚：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
          北京欢乐谷医务室
     生成时间：2025-01-27 11:00:15
          第 1 页 / 共 1 页
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## ✅ 功能确认清单

### 核心功能 (P0 - MVP必须)
- [x] 药品档案管理（含条形码、高值/急救标记）
- [x] 入库管理（扫码+连续扫码+双签）
- [x] 出库管理（园区选择+扫码+高值确认+双签）
- [x] 园区间调拨（双签）
- [x] 药房日消耗（扫码+自动记录人）
- [x] 部门请领（自定义部门+扫码+双签）
- [x] 库存盘点（月度+扫码+差异校正+双签）
- [x] 药品报损（简单报损+拍照+单签）
- [x] 药品退货（退货出库单+拍照+双签）
- [x] 库存查询（实时库存+批次明细+零库存显示）
- [x] 库存预警（全局统一值+急救药零库存预警）
- [x] 有效期管理（90天单级预警+FIFO）
- [x] 报表统计（日/周/月/年/自定义+PDF/Excel）
- [x] 签名功能（全屏签名板+横屏支持）
- [x] 单据状态管理（驳回后可修改）
- [x] 批量导入（Excel导入药品档案）

### 基础功能 (P0 - MVP必须)
- [x] 用户管理（全部权限）
- [x] 部门管理（自定义）
- [x] 园区管理（陆园默认、水园）
- [x] 系统配置（医务室信息、预警参数）

### 可选功能 (P1 - 后续迭代)
- [ ] 供应商管理
- [ ] 采购申请流程
- [ ] 库位管理
- [ ] 损耗率统计
- [ ] 操作审计日志
- [ ] 离线操作支持
- [ ] 快捷功能（收藏、模板）
- [ ] 打印功能

---

## 📊 开发计划

### 第一阶段：项目搭建（1-2天）
- [ ] 创建Uniapp项目
- [ ] 配置微信云开发
- [ ] 搭建项目结构
- [ ] 集成uView Plus UI
- [ ] 配置TypeScript

### 第二阶段：基础功能（3-5天）
- [ ] 用户登录与鉴权
- [ ] 药品档案管理
- [ ] 部门管理
- [ ] 园区管理
- [ ] 系统配置

### 第三阶段：核心业务（7-10天）
- [ ] 入库管理（扫码+双签）
- [ ] 出库管理（园区+扫码+双签）
- [ ] 园区间调拨
- [ ] 药房日消耗
- [ ] 部门请领
- [ ] 库存盘点

### 第四阶段：扩展功能（5-7天）
- [ ] 药品报损
- [ ] 药品退货
- [ ] 库存查询与预警
- [ ] 有效期管理
- [ ] 批量导入

### 第五阶段：报表统计（3-5天）
- [ ] 各维度统计报表
- [ ] ECharts图表
- [ ] PDF导出
- [ ] Excel导出

### 第六阶段：测试优化（5-7天）
- [ ] 功能测试
- [ ] 性能优化
- [ ] 用户体验优化
- [ ] Bug修复

### 第七阶段：上线部署（2-3天）
- [ ] 云函数部署
- [ ] 数据库初始化
- [ ] 小程序审核
- [ ] 正式上线

**预计总工期：25-40天**

---

## 📝 后续说明

1. **价格字段**：所有涉及价格的字段均为选填，不影响核心业务流程
2. **园区管理**：出库、消耗、请领均需选择园区（默认陆园），从指定园区药房扣减库存
3. **记录人自动填充**：消耗记录、报损记录等自动获取当前登录用户
4. **全屏签名**：所有签名均支持全屏签名板，支持横屏
5. **导出规则**：带签名的表单仅支持PDF导出，无签名的支持PDF+Excel
6. **单据修改**：已完成的单据不可修改，驳回后可修改重新提交
7. **特殊药品**：高值药品出库二次确认，急救药品零库存立即预警
8. **FIFO原则**：出库、请领、盘点时自动按效期排序，优先推荐近效期批次

---

**文档版本**：v1.0  
**最后更新**：2025-01-27  
**负责人**：[待填写]


