{"version":3,"sources":["webpack:///D:/AK-PMS/components/drug-create-popup/index.vue?5271","webpack:///D:/AK-PMS/components/drug-create-popup/index.vue?ce19","webpack:///D:/AK-PMS/components/drug-create-popup/index.vue?9c9f","webpack:///D:/AK-PMS/components/drug-create-popup/index.vue?f7cd","uni-app:///components/drug-create-popup/index.vue","webpack:///D:/AK-PMS/components/drug-create-popup/index.vue?63a1","webpack:///D:/AK-PMS/components/drug-create-popup/index.vue?2121"],"names":["name","props","show","type","default","defaultBarcode","emits","data","showPopup","form","drugName","barcode","specification","unit","manufacturer","category","categoryOptions","categoryIndex","saving","computed","canSave","watch","mounted","methods","initForm","handleScan","uni","onlyFromCamera","res","title","icon","onCategoryChange","handleSaveAndContinue","drugData","handleSaveAndAdd","createDrug","action","spec","packUnit","isHighValue","isEmergency","result","_id","drugCode","console","handleClose","setTimeout"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACsC;;;AAG1F;AACqO;AACrO,gBAAgB,yOAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA+5B,CAAgB,25BAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eC8Gn7B;EACAA;EACAC;IACAC;MACAC;MACAC;IACA;IACAC;MACAF;MACAC;IACA;EACA;EACAE;EACAC;IACA;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC,kBACA,QACA,QACA,SACA,SACA,SACA,QACA,QACA,QACA,KACA;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA,uBACA,6BACA,kCACA;IACA;EACA;EACAC;IACAnB;MACA;MACA;QACA;MACA;IACA;IACAM;MACA;QACA;MACA;IACA;IACAH;MACA;QACA;MACA;IACA;EACA;EACAiB;IACA;IACA;MACA;IACA;EACA;EACAC;IACA;IACAC;MACA;QACAd;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACA;IACA;IAEA;IACAU;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEAC;kBACAC;gBACA;cAAA;gBAFAC;gBAGA;gBACAF;kBACAG;kBACAC;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEA;kBACAJ;oBACAG;oBACAC;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAC;MACA;MACA;IACA;IAEA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAEA;gBAAA;gBAAA;gBAAA,OAGA;cAAA;gBAAAC;gBAEA;gBACA;;gBAEA;gBACA;gBAEAP;kBACAG;kBACAC;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAJ;kBACAG;kBACAC;gBACA;cAAA;gBAAA;gBAEA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAI;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAEA;gBAAA;gBAAA;gBAAA,OAGA;cAAA;gBAAAD;gBAEA;gBACA;;gBAEA;gBACA;gBAEAP;kBACAG;kBACAC;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAJ;kBACAG;kBACAC;gBACA;cAAA;gBAAA;gBAEA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAK;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEA;kBACAC;kBACA7B;oBACAP;oBACAW;oBACA0B;oBACAxB;oBACAC;oBACAC;oBACAuB;oBACAC;oBACAC;kBACA;gBACA;cAAA;gBAbAC;gBAAA,MAeAA;kBAAA;kBAAA;gBAAA;gBAAA,kCACA;kBACAC;kBACAC;kBACA3C;kBACAY;kBACAC;kBACAC;kBACAC;kBACAuB;kBACAC;kBACAC;gBACA;cAAA;gBAAA,MAEA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAI;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAGA;IAEA;IACAC;MAAA;MACA;MACA;MACAC;QACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACzUA;AAAA;AAAA;AAAA;AAAkuD,CAAgB,kpDAAG,EAAC,C;;;;;;;;;;;ACAtvD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/drug-create-popup/index.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=0e96aa80&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=0e96aa80&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0e96aa80\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/drug-create-popup/index.vue\"\nexport default component.exports","export * from \"-!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=template&id=0e96aa80&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"drug-create-popup\">\r\n\t\t<u-popup \r\n\t\t\tv-if=\"showPopup\"\r\n\t\t\t:value=\"true\"\r\n\t\t\tmode=\"center\" \r\n\t\t\twidth=\"90%\"\r\n\t\t\tmax-height=\"80%\"\r\n\t\t\tborder-radius=\"20\"\r\n\t\t\t:closeable=\"true\"\r\n\t\t\t@close=\"handleClose\"\r\n\t\t>\r\n\t\t\t<view class=\"popup-content\">\r\n\t\t\t\t<!-- 标题栏 -->\r\n\t\t\t\t<view class=\"popup-header\">\r\n\t\t\t\t\t<text class=\"header-title\">新建药品</text>\r\n\t\t\t\t\t<text class=\"close-btn\" @tap=\"handleClose\">✕</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<!-- 表单内容 -->\r\n\t\t\t\t<scroll-view class=\"form-content\" scroll-y>\r\n\t\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t\t<text class=\"form-label\">药品名称 *</text>\r\n\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\tclass=\"form-input\"\r\n\t\t\t\t\t\t\tv-model=\"form.drugName\"\r\n\t\t\t\t\t\t\tplaceholder=\"请输入药品名称\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t\t<text class=\"form-label\">条形码</text>\r\n\t\t\t\t\t\t<view class=\"input-with-btn\">\r\n\t\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\t\tclass=\"form-input\"\r\n\t\t\t\t\t\t\t\tv-model=\"form.barcode\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"请输入或扫码\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<u-button \r\n\t\t\t\t\t\t\t\ttype=\"primary\" \r\n\t\t\t\t\t\t\t\tsize=\"mini\"\r\n\t\t\t\t\t\t\t\ttext=\"扫码\"\r\n\t\t\t\t\t\t\t\t@click=\"handleScan\"\r\n\t\t\t\t\t\t\t></u-button>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t\t<text class=\"form-label\">规格 *</text>\r\n\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\tclass=\"form-input\"\r\n\t\t\t\t\t\t\tv-model=\"form.specification\"\r\n\t\t\t\t\t\t\tplaceholder=\"如：0.5g*12片\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t\t<text class=\"form-label\">单位 *</text>\r\n\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\tclass=\"form-input\"\r\n\t\t\t\t\t\t\tv-model=\"form.unit\"\r\n\t\t\t\t\t\t\tplaceholder=\"如：盒\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t\t<text class=\"form-label\">生产厂家</text>\r\n\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\tclass=\"form-input\"\r\n\t\t\t\t\t\t\tv-model=\"form.manufacturer\"\r\n\t\t\t\t\t\t\tplaceholder=\"请输入生产厂家\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t\t<text class=\"form-label\">药品分类</text>\r\n\t\t\t\t\t\t<picker \r\n\t\t\t\t\t\t\t:value=\"categoryIndex\" \r\n\t\t\t\t\t\t\t:range=\"categoryOptions\"\r\n\t\t\t\t\t\t\t@change=\"onCategoryChange\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<view class=\"picker-view\">\r\n\t\t\t\t\t\t\t\t{{ form.category || '请选择分类' }}\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</picker>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t\t\r\n\t\t\t\t<!-- 底部操作栏 -->\r\n\t\t\t\t<view class=\"popup-footer\">\r\n\t\t\t\t\t<u-button \r\n\t\t\t\t\t\ttype=\"info\" \r\n\t\t\t\t\t\ttext=\"保存并继续\"\r\n\t\t\t\t\t\tplain\r\n\t\t\t\t\t\t@click=\"handleSaveAndContinue\"\r\n\t\t\t\t\t\t:disabled=\"!canSave\"\r\n\t\t\t\t\t></u-button>\r\n\t\t\t\t\t<u-button \r\n\t\t\t\t\t\ttype=\"primary\" \r\n\t\t\t\t\t\ttext=\"保存并添加\"\r\n\t\t\t\t\t\t@click=\"handleSaveAndAdd\"\r\n\t\t\t\t\t\t:disabled=\"!canSave\"\r\n\t\t\t\t\t></u-button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</u-popup>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\tname: 'DrugCreatePopup',\r\n\tprops: {\r\n\t\tshow: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\tdefaultBarcode: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t}\r\n\t},\r\n\temits: ['update:show', 'created', 'save-and-continue'],\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tshowPopup: false,\r\n\t\t\tform: {\r\n\t\t\t\tdrugName: '',\r\n\t\t\t\tbarcode: '',\r\n\t\t\t\tspecification: '',\r\n\t\t\t\tunit: '盒',\r\n\t\t\t\tmanufacturer: '',\r\n\t\t\t\tcategory: ''\r\n\t\t\t},\r\n\t\t\tcategoryOptions: [\r\n\t\t\t\t'抗生素类',\r\n\t\t\t\t'心血管类',\r\n\t\t\t\t'消化系统类',\r\n\t\t\t\t'呼吸系统类',\r\n\t\t\t\t'解热镇痛类',\r\n\t\t\t\t'维生素类',\r\n\t\t\t\t'外用药类',\r\n\t\t\t\t'急救药品',\r\n\t\t\t\t'其他'\r\n\t\t\t],\r\n\t\t\tcategoryIndex: -1,\r\n\t\t\tsaving: false\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tcanSave() {\r\n\t\t\treturn !this.saving && \r\n\t\t\t\tthis.form.drugName.trim() && \r\n\t\t\t\tthis.form.specification.trim() && \r\n\t\t\t\tthis.form.unit.trim()\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tshow(newVal) {\r\n\t\t\tthis.showPopup = newVal\r\n\t\t\tif (newVal) {\r\n\t\t\t\tthis.initForm()\r\n\t\t\t}\r\n\t\t},\r\n\t\tshowPopup(newVal) {\r\n\t\t\tif (!newVal) {\r\n\t\t\t\tthis.$emit('update:show', false)\r\n\t\t\t}\r\n\t\t},\r\n\t\tdefaultBarcode(newVal) {\r\n\t\t\tif (newVal && this.showPopup) {\r\n\t\t\t\tthis.form.barcode = newVal\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\tthis.showPopup = this.show\r\n\t\tif (this.defaultBarcode) {\r\n\t\t\tthis.form.barcode = this.defaultBarcode\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t// 初始化表单\r\n\t\tinitForm() {\r\n\t\t\tthis.form = {\r\n\t\t\t\tdrugName: '',\r\n\t\t\t\tbarcode: this.defaultBarcode || '',\r\n\t\t\t\tspecification: '',\r\n\t\t\t\tunit: '盒',\r\n\t\t\t\tmanufacturer: '',\r\n\t\t\t\tcategory: ''\r\n\t\t\t}\r\n\t\t\tthis.categoryIndex = -1\r\n\t\t},\r\n\t\t\r\n\t\t// 扫码\r\n\t\tasync handleScan() {\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await uni.scanCode({\r\n\t\t\t\t\tonlyFromCamera: true\r\n\t\t\t\t})\r\n\t\t\t\tthis.form.barcode = res.result || res[1].result\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '扫码成功',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t})\r\n\t\t\t} catch (err) {\r\n\t\t\t\tif (!err.errMsg?.includes('cancel')) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '扫码失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 分类选择\r\n\t\tonCategoryChange(e) {\r\n\t\t\tthis.categoryIndex = e.detail.value\r\n\t\t\tthis.form.category = this.categoryOptions[e.detail.value]\r\n\t\t},\r\n\t\t\r\n\t\t// 保存并继续（不关闭弹窗，清空表单继续创建）\r\n\t\tasync handleSaveAndContinue() {\r\n\t\t\tif (!this.canSave) return\r\n\t\t\t\r\n\t\t\tthis.saving = true\r\n\t\t\ttry {\r\n\t\t\t\t// 创建药品\r\n\t\t\t\tconst drugData = await this.createDrug()\r\n\t\t\t\t\r\n\t\t\t\t// 发送创建成功事件\r\n\t\t\t\tthis.$emit('save-and-continue', drugData)\r\n\t\t\t\t\r\n\t\t\t\t// 清空表单，继续创建\r\n\t\t\t\tthis.initForm()\r\n\t\t\t\t\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '保存成功，继续添加',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t})\r\n\t\t\t} catch (err) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: err.message || '保存失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t} finally {\r\n\t\t\t\tthis.saving = false\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 保存并添加（关闭弹窗，添加到入库单）\r\n\t\tasync handleSaveAndAdd() {\r\n\t\t\tif (!this.canSave) return\r\n\t\t\t\r\n\t\t\tthis.saving = true\r\n\t\t\ttry {\r\n\t\t\t\t// 创建药品\r\n\t\t\t\tconst drugData = await this.createDrug()\r\n\t\t\t\t\r\n\t\t\t\t// 发送创建成功事件\r\n\t\t\t\tthis.$emit('created', drugData)\r\n\t\t\t\t\r\n\t\t\t\t// 关闭弹窗\r\n\t\t\t\tthis.handleClose()\r\n\t\t\t\t\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '创建成功',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t})\r\n\t\t\t} catch (err) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: err.message || '保存失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t} finally {\r\n\t\t\t\tthis.saving = false\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 创建药品\r\n\t\tasync createDrug() {\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await this.$api.callFunction('drugManage', {\r\n\t\t\t\t\taction: 'create',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tname: this.form.drugName.trim(),\r\n\t\t\t\t\t\tbarcode: this.form.barcode.trim(),\r\n\t\t\t\t\t\tspec: this.form.specification.trim(),\r\n\t\t\t\t\t\tunit: this.form.unit.trim(),\r\n\t\t\t\t\t\tmanufacturer: this.form.manufacturer.trim(),\r\n\t\t\t\t\t\tcategory: this.form.category,\r\n\t\t\t\t\t\tpackUnit: this.form.unit.trim(),\r\n\t\t\t\t\t\tisHighValue: false,\r\n\t\t\t\t\t\tisEmergency: false\r\n\t\t\t\t\t}\r\n\t\t\t\t}, true)\r\n\t\t\t\t\r\n\t\t\t\tif (result && result.success) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t_id: result.data._id || result._id,\r\n\t\t\t\t\t\tdrugCode: this.form.barcode.trim(),\r\n\t\t\t\t\t\tname: this.form.drugName.trim(),\r\n\t\t\t\t\t\tspecification: this.form.specification.trim(),\r\n\t\t\t\t\t\tunit: this.form.unit.trim(),\r\n\t\t\t\t\t\tmanufacturer: this.form.manufacturer.trim(),\r\n\t\t\t\t\t\tcategory: this.form.category,\r\n\t\t\t\t\t\tpackUnit: this.form.unit.trim(),\r\n\t\t\t\t\t\tisHighValue: false,\r\n\t\t\t\t\t\tisEmergency: false\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(result?.message || '创建失败')\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('创建药品失败:', err)\r\n\t\t\t\tthrow err\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 关闭弹窗\r\n\t\thandleClose() {\r\n\t\t\tthis.showPopup = false\r\n\t\t\t// 延迟清空表单，避免关闭动画时表单闪烁\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.initForm()\r\n\t\t\t}, 300)\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.drug-create-popup {\r\n\twidth: 100%;\r\n}\r\n\r\n.popup-content {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tbackground: #ffffff;\r\n\tmax-height: 80vh;\r\n}\r\n\r\n.popup-header {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: space-between;\r\n\tpadding: 30rpx;\r\n\tborder-bottom: 1rpx solid #f0f0f0;\r\n}\r\n\r\n.header-title {\r\n\tfont-size: 32rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333333;\r\n}\r\n\r\n.close-btn {\r\n\tfont-size: 40rpx;\r\n\tcolor: #999999;\r\n\tpadding: 0 10rpx;\r\n}\r\n\r\n.form-content {\r\n\tflex: 1;\r\n\tpadding: 20rpx 30rpx;\r\n\tmax-height: 60vh;\r\n}\r\n\r\n.form-item {\r\n\tmargin-bottom: 25rpx;\r\n}\r\n\r\n.form-label {\r\n\tdisplay: block;\r\n\tfont-size: 26rpx;\r\n\tcolor: #666666;\r\n\tmargin-bottom: 10rpx;\r\n\tfont-weight: 500;\r\n}\r\n\r\n.form-input {\r\n\twidth: 100%;\r\n\theight: 70rpx;\r\n\tpadding: 0 20rpx;\r\n\tbackground: #f8f9fa;\r\n\tborder-radius: 10rpx;\r\n\tfont-size: 28rpx;\r\n\tcolor: #333333;\r\n}\r\n\r\n.input-with-btn {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 15rpx;\r\n}\r\n\r\n.input-with-btn .form-input {\r\n\tflex: 1;\r\n}\r\n\r\n.picker-view {\r\n\theight: 70rpx;\r\n\tpadding: 0 20rpx;\r\n\tbackground: #f8f9fa;\r\n\tborder-radius: 10rpx;\r\n\tfont-size: 28rpx;\r\n\tcolor: #333333;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n}\r\n\r\n.popup-footer {\r\n\tpadding: 20rpx 30rpx;\r\n\tborder-top: 1rpx solid #f0f0f0;\r\n\tdisplay: flex;\r\n\tgap: 20rpx;\r\n}\r\n\r\n.popup-footer .u-button {\r\n\tflex: 1;\r\n}\r\n</style>\r\n\r\n","import mod from \"-!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&id=0e96aa80&lang=scss&scoped=true&\"; export default mod; export * from \"-!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\dujia\\\\AppData\\\\Local\\\\Temp\\\\Rar$EXa14240.14831.rartemp\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&id=0e96aa80&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1762413248017\n      var cssReload = require(\"C:/Users/dujia/AppData/Local/Temp/Rar$EXa14240.14831.rartemp/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}