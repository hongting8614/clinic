{"version":3,"sources":["uni-app:///main.js","webpack:///D:/AK-PMS/pages-sub/drug/add.vue?f4a7","webpack:///D:/AK-PMS/pages-sub/drug/add.vue?da1a","webpack:///D:/AK-PMS/pages-sub/drug/add.vue?5bfa","webpack:///D:/AK-PMS/pages-sub/drug/add.vue?f373","uni-app:///pages-sub/drug/add.vue","webpack:///D:/AK-PMS/pages-sub/drug/add.vue?3479","webpack:///D:/AK-PMS/pages-sub/drug/add.vue?5462"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","Scanner","data","isEdit","drugId","form","drugCode","drugName","specification","manufacturer","barcode","category","packUnit","minUnit","conversionRate","safeStock","minStock","isHighValue","isEmergency","remark","categoryOptions","categoryIndex","onLoad","methods","onScanSuccess","console","exists","uni","title","content","confirmText","cancelText","success","url","sourceText","icon","duration","fillFormFromScanData","parseConversionFromSpec","rate","onBarcodeNotFound","showCancel","scrollTop","checkBarcodeExists","name","action","res","loadDrugDetail","_id","drug","index","onCategoryChange","validateForm","handleSubmit","submitData","updateTime","setTimeout","generateDrugCode","handleCancel"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,YAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA4H;AAC5H;AACuD;AACL;AACsC;;;AAGxF;AAC0K;AAC1K,gBAAgB,uLAAU;AAC1B,EAAE,yEAAM;AACR,EAAE,0FAAM;AACR,EAAE,mGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,8FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,4KAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AClDA;AAAA;AAAA;AAAA;AAAmoB,CAAgB,+pBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eCmPvpB;EACAC;IACAC;EACA;EAEAC;IACA;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC,kBACA,QACA,QACA,SACA,SACA,SACA,QACA,QACA,QACA,KACA;MACAC;IACA;EACA;EAEAC;IACA;MACA;MACA;MACA;IACA;EACA;EAEAC;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAC;gBAEAf,4BAEA;gBAAA;gBAAA,OACA;cAAA;gBAAAgB;gBAAA,KAEAA;kBAAA;kBAAA;gBAAA;gBACAC;kBACAC;kBACAC;kBACAC;kBACAC;kBACAC;oBACA;sBACAL;wBACAM;sBACA;oBACA;kBACA;gBACA;gBAAA;cAAA;gBAIA;gBACA;;gBAEA;gBACAC;kBACA;kBACA;kBACA;gBACA;gBAEAP;kBACAC;kBACAO;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACAC;MACAZ;;MAEA;MACA;QACA;MACA;MAEA;QACA;MACA;MAEA;QACA;MACA;MAEA;QACA;MACA;;MAEA;MACA;QACA;QACA;QACA;UACA;QACA;MACA;;MAEA;MACA;QACA;MACA;;MAEA;MACA;QACA;QACA;UACA;UACA;YACA;UACA;QACA;MACA;MAEAA;IACA;IAEA;IACAa;MACA;MACA;MACA;MACA;;MAEA,gBACA;MAAA;MACA;MAAA,CACA;;MAEA;QAAA;QACA;QACA;UACA;YACAC;YACA1B;UACA;QACA;MACA;MAEA;IACA;IAEA;IACA2B;MAAA;MACAf;MAEA;MAEAE;QACAC;QACAC;QACAY;QACAX;QACAE;UACA;UACA;;UAEA;UACAL;YACAe;YACAN;UACA;QACA;MACA;IACA;IAEA;IACAO;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEAhD;kBACAiD;kBACA1C;oBACA2C;oBACAnC;kBACA;gBACA;cAAA;gBANAoC;gBAAA,MAQAA;kBAAA;kBAAA;gBAAA;gBAAA,kCACAA;cAAA;gBAAA,kCAEA;cAAA;gBAAA;gBAAA;gBAEArB;gBAAA,kCACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAsB;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACApB;kBAAAC;gBAAA;gBAAA;gBAAA;gBAAA,OAGAjC;kBACAiD;kBACA1C;oBACA2C;oBACAG;kBACA;gBACA;cAAA;gBANAF;gBAQA;kBACAG;kBACA;oBACA3C;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;kBACA;;kBAEA;kBACA+B;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAzB;gBACAE;kBACAC;kBACAO;gBACA;cAAA;gBAAA;gBAEAR;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAwB;MACA;MACA;IACA;IAEA;IACAC;MACA;QACAzB;UACAC;UACAO;QACA;QACA;MACA;MAEA;QACAR;UACAC;UACAO;QACA;QACA;MACA;MAEA;QACAR;UACAC;UACAO;QACA;QACA;MACA;MAEA;QACAR;UACAC;UACAO;QACA;QACA;MACA;MAEA;QACAR;UACAC;UACAO;QACA;QACA;MACA;MAEA;QACAR;UACAC;UACAO;QACA;QACA;MACA;MAEA;IACA;IAEA;IACAkB;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAIA1B;kBAAAC;gBAAA;gBAAA;gBAGA;gBACA;kBACA;gBACA;gBAEA0B,6CACA;kBACAC;gBAAA;gBAAA,KAGA;kBAAA;kBAAA;gBAAA;gBACA;gBACAD;gBAAA;gBAAA,OACA3D;kBACAiD;kBACA1C;oBACA2C;kBAAA,GACAS;gBAEA;cAAA;gBAAA;gBAAA;cAAA;gBAEA;gBACAA;gBAAA;gBAAA,OACA3D;kBACAiD;kBACA1C;oBACA2C;kBAAA,GACAS;gBAEA;cAAA;gBAGA3B;kBACAC;kBACAO;gBACA;gBAEAqB;kBACA7B;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAF;gBACAE;kBACAC;kBACAO;gBACA;cAAA;gBAAA;gBAEAR;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACA8B;MACA;MACA;MACA;MACA;;MAEA;MACA;MACA;MAEA;IACA;IAEA;IACAC;MACA/B;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AChoBA;AAAA;AAAA;AAAA;AAAkuC,CAAgB,8sCAAG,EAAC,C;;;;;;;;;;;ACAtvC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages-sub/drug/add.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages-sub/drug/add.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./add.vue?vue&type=template&id=cfbffdd0&scoped=true&\"\nvar renderjs\nimport script from \"./add.vue?vue&type=script&lang=js&\"\nexport * from \"./add.vue?vue&type=script&lang=js&\"\nimport style0 from \"./add.vue?vue&type=style&index=0&id=cfbffdd0&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"cfbffdd0\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages-sub/drug/add.vue\"\nexport default component.exports","export * from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=template&id=cfbffdd0&scoped=true&\"","var components\ntry {\n  components = {\n    scanner: function () {\n      return import(\n        /* webpackChunkName: \"components/scanner/index\" */ \"@/components/scanner/index.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. æ’æŸ¥ç»„ä»¶åç§°æ‹¼å†™æ˜¯å¦æ­£ç¡®\")\n    console.error(\n      \"2. æ’æŸ¥ç»„ä»¶æ˜¯å¦ç¬¦åˆ easycom è§„èŒƒï¼Œæ–‡æ¡£ï¼šhttps://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. è‹¥ç»„ä»¶ä¸ç¬¦åˆ easycom è§„èŒƒï¼Œéœ€æ‰‹åŠ¨å¼•å…¥ï¼Œå¹¶åœ¨ components ä¸­æ³¨å†Œè¯¥ç»„ä»¶\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.form.remark.length\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      _vm.form.isHighValue = $event.detail.value\n    }\n    _vm.e1 = function ($event) {\n      _vm.form.isEmergency = $event.detail.value\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"page-container\">\r\n\t\t<!-- æ ‡é¢˜æ  -->\r\n\t\t<view class=\"page-header\">\r\n\t\t\t<view class=\"clinic-name\">ğŸ¥ çˆ±åº·åŒ»åŠ¡å®¤ç®¡ç†ç³»ç»Ÿ</view>\r\n\t\t\t<view class=\"doc-type\">åŒ—äº¬æ¬¢ä¹è°·åŒ»åŠ¡å®¤ Â· è¯ææ¡£æ¡ˆ{{ isEdit ? 'ç¼–è¾‘' : 'æ·»åŠ ' }}</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- æ‰«ç åŒºåŸŸ - ä»…è¯ææ¡£æ¡ˆé¡µé¢ä¿ç•™æ‰«ç åŠŸèƒ½ -->\r\n\t\t<view class=\"scan-section\">\r\n\t\t\t<view class=\"scan-title\">ğŸ“· æ‰«ç å½•å…¥</view>\r\n\t\t\t<view class=\"scan-desc\">æ‰«æè¯ææ¡å½¢ç å¿«é€Ÿå½•å…¥è¯æä¿¡æ¯</view>\r\n\t\t\t<scanner \r\n\t\t\t\tbutton-text=\"ğŸ“· æ‰«ç æ·»åŠ è¯æ\"\r\n\t\t\t\tbutton-type=\"primary\"\r\n\t\t\t\t@success=\"onScanSuccess\"\r\n\t\t\t\t@notFound=\"onBarcodeNotFound\"\r\n\t\t\t></scanner>\r\n\t\t</view>\r\n\r\n\t\t<!-- åŸºæœ¬ä¿¡æ¯ -->\r\n\t\t<view class=\"form-section\">\r\n\t\t\t<view class=\"section-title\">ğŸ“‹ åŸºæœ¬ä¿¡æ¯</view>\r\n\r\n\t\t\t<!-- è¯æåç§° -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"label required\">è¯æåç§°</view>\r\n\t\t\t\t<input \r\n\t\t\t\t\tv-model=\"form.drugName\" \r\n\t\t\t\t\tclass=\"input\" \r\n\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥è¯æåç§°\"\r\n\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t/>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- è¯æä»£ç  -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"label\">è¯æä»£ç </view>\r\n\t\t\t\t<input \r\n\t\t\t\t\tv-model=\"form.drugCode\" \r\n\t\t\t\t\tclass=\"input\" \r\n\t\t\t\t\tplaceholder=\"å¦‚ï¼šAMOX500-TABï¼ˆå¯é€‰ï¼Œç³»ç»Ÿå¯è‡ªåŠ¨ç”Ÿæˆï¼‰\"\r\n\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t/>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- æ¡å½¢ç  -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"label\">æ¡å½¢ç </view>\r\n\t\t\t\t<input \r\n\t\t\t\t\tv-model=\"form.barcode\" \r\n\t\t\t\t\tclass=\"input\" \r\n\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥æˆ–æ‰«ææ¡å½¢ç \"\r\n\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t/>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- è§„æ ¼ -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"label required\">è§„æ ¼</view>\r\n\t\t\t\t<input \r\n\t\t\t\t\tv-model=\"form.specification\" \r\n\t\t\t\t\tclass=\"input\" \r\n\t\t\t\t\tplaceholder=\"å¦‚ï¼š0.25g*24ç²’\"\r\n\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t/>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- ç”Ÿäº§å‚å®¶ -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"label required\">ç”Ÿäº§å‚å®¶</view>\r\n\t\t\t\t<input \r\n\t\t\t\t\tv-model=\"form.manufacturer\" \r\n\t\t\t\t\tclass=\"input\" \r\n\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥ç”Ÿäº§å‚å®¶\"\r\n\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t/>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- è¯æåˆ†ç±» -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"label\">è¯æåˆ†ç±»</view>\r\n\t\t\t\t<picker \r\n\t\t\t\t\tmode=\"selector\" \r\n\t\t\t\t\t:range=\"categoryOptions\" \r\n\t\t\t\t\t@change=\"onCategoryChange\"\r\n\t\t\t\t\t:value=\"categoryIndex\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<view class=\"picker-display\">\r\n\t\t\t\t\t\t{{ form.category || 'è¯·é€‰æ‹©è¯æåˆ†ç±»' }}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</picker>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- å•ä½ä¿¡æ¯ -->\r\n\t\t<view class=\"form-section\">\r\n\t\t\t<view class=\"section-title\">ğŸ“¦ å•ä½è½¬æ¢</view>\r\n\t\t\t<view class=\"section-desc\">è®¾ç½®åŒ…è£…å•ä½å’Œæœ€å°å•ä½çš„è½¬æ¢å…³ç³»</view>\r\n\r\n\t\t\t<!-- åŒ…è£…å•ä½ -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"label required\">åŒ…è£…å•ä½</view>\r\n\t\t\t\t<view class=\"input-row\">\r\n\t\t\t\t\t<input \r\n\t\t\t\t\t\tv-model=\"form.packUnit\" \r\n\t\t\t\t\t\tclass=\"input flex-input\" \r\n\t\t\t\t\t\tplaceholder=\"å¦‚ï¼šç›’ã€ç“¶\"\r\n\t\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<text class=\"hint\">ï¼ˆä¸»åº“å­˜å•ä½ï¼‰</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- æœ€å°å•ä½ -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"label required\">æœ€å°å•ä½</view>\r\n\t\t\t\t<view class=\"input-row\">\r\n\t\t\t\t\t<input \r\n\t\t\t\t\t\tv-model=\"form.minUnit\" \r\n\t\t\t\t\t\tclass=\"input flex-input\" \r\n\t\t\t\t\t\tplaceholder=\"å¦‚ï¼šç‰‡ã€ç²’ã€ml\"\r\n\t\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<text class=\"hint\">ï¼ˆå›­åŒºä½¿ç”¨å•ä½ï¼‰</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- è½¬æ¢ç‡ -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"label required\">è½¬æ¢ç‡</view>\r\n\t\t\t\t<view class=\"conversion-row\">\r\n\t\t\t\t\t<text class=\"conversion-text\">1 {{ form.packUnit || 'ç›’' }} = </text>\r\n\t\t\t\t\t<input \r\n\t\t\t\t\t\tv-model.number=\"form.conversionRate\" \r\n\t\t\t\t\t\tclass=\"input conversion-input\" \r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tplaceholder=\"24\"\r\n\t\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<text class=\"conversion-text\">{{ form.minUnit || 'ç‰‡' }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- è½¬æ¢ç¤ºä¾‹ -->\r\n\t\t\t<view v-if=\"form.conversionRate\" class=\"conversion-example\">\r\n\t\t\t\t<text class=\"example-icon\">ğŸ’¡</text>\r\n\t\t\t\t<text class=\"example-text\">\r\n\t\t\t\t\tç¤ºä¾‹ï¼šå…¥åº“ 1{{ form.packUnit || 'ç›’' }}ï¼Œå‡ºåº“åˆ°å›­åŒºåå¯ç”¨ {{ form.conversionRate }}{{ form.minUnit || 'ç‰‡' }}\r\n\t\t\t\t</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- åº“å­˜ç®¡ç† -->\r\n\t\t<view class=\"form-section\">\r\n\t\t\t<view class=\"section-title\">ğŸ“Š åº“å­˜ç®¡ç†</view>\r\n\r\n\t\t\t<!-- å®‰å…¨åº“å­˜ -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"label\">å®‰å…¨åº“å­˜</view>\r\n\t\t\t\t<view class=\"input-row\">\r\n\t\t\t\t\t<input \r\n\t\t\t\t\t\tv-model.number=\"form.safeStock\" \r\n\t\t\t\t\t\tclass=\"input flex-input\" \r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥å®‰å…¨åº“å­˜æ•°é‡\"\r\n\t\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<text class=\"hint\">{{ form.packUnit || 'å•ä½' }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- æœ€ä½åº“å­˜ -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"label\">æœ€ä½åº“å­˜</view>\r\n\t\t\t\t<view class=\"input-row\">\r\n\t\t\t\t\t<input \r\n\t\t\t\t\t\tv-model.number=\"form.minStock\" \r\n\t\t\t\t\t\tclass=\"input flex-input\" \r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥æœ€ä½åº“å­˜æ•°é‡\"\r\n\t\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<text class=\"hint\">{{ form.packUnit || 'å•ä½' }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- ç‰¹æ®Šæ ‡è®° -->\r\n\t\t<view class=\"form-section\">\r\n\t\t\t<view class=\"section-title\">ğŸ·ï¸ ç‰¹æ®Šæ ‡è®°</view>\r\n\r\n\t\t\t<view class=\"switch-item\">\r\n\t\t\t\t<view class=\"switch-label\">\r\n\t\t\t\t\t<text class=\"label-text\">é«˜å€¼è¯æ</text>\r\n\t\t\t\t\t<text class=\"label-desc\">æ ‡è®°ä¸ºé«˜å€¼è¯æï¼Œéœ€ç‰¹æ®Šç®¡ç†</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<switch \r\n\t\t\t\t\t:checked=\"form.isHighValue\" \r\n\t\t\t\t\t@change=\"form.isHighValue = $event.detail.value\"\r\n\t\t\t\t\tcolor=\"#FF9800\"\r\n\t\t\t\t/>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"switch-item\">\r\n\t\t\t\t<view class=\"switch-label\">\r\n\t\t\t\t\t<text class=\"label-text\">æ€¥æ•‘è¯æ</text>\r\n\t\t\t\t\t<text class=\"label-desc\">æ ‡è®°ä¸ºæ€¥æ•‘è¯æï¼Œä¼˜å…ˆç®¡ç†</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<switch \r\n\t\t\t\t\t:checked=\"form.isEmergency\" \r\n\t\t\t\t\t@change=\"form.isEmergency = $event.detail.value\"\r\n\t\t\t\t\tcolor=\"#F44336\"\r\n\t\t\t\t/>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- å¤‡æ³¨ -->\r\n\t\t<view class=\"form-section\">\r\n\t\t\t<view class=\"section-title\">ğŸ“ å¤‡æ³¨ä¿¡æ¯</view>\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<textarea \r\n\t\t\t\t\tv-model=\"form.remark\" \r\n\t\t\t\t\tclass=\"textarea\" \r\n\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯ï¼ˆé€‰å¡«ï¼‰\"\r\n\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\tmaxlength=\"200\"\r\n\t\t\t\t></textarea>\r\n\t\t\t\t<view class=\"char-count\">{{ form.remark.length }}/200</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->\r\n\t\t<view class=\"bottom-actions\">\r\n\t\t\t<button class=\"btn-cancel\" @tap=\"handleCancel\">å–æ¶ˆ</button>\r\n\t\t\t<button class=\"btn-submit\" @tap=\"handleSubmit\">{{ isEdit ? 'ä¿å­˜ä¿®æ”¹' : 'ğŸ’¾ ä¿å­˜è¯æ' }}</button>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport Scanner from '@/components/scanner/index.vue'\r\n\r\nexport default {\r\n\tcomponents: {\r\n\t\tScanner\r\n\t},\r\n\t\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tisEdit: false,\r\n\t\t\tdrugId: '',\r\n\t\t\tform: {\r\n\t\t\t\tdrugCode: '',\r\n\t\t\t\tdrugName: '',\r\n\t\t\t\tspecification: '',\r\n\t\t\t\tmanufacturer: '',\r\n\t\t\t\tbarcode: '',\r\n\t\t\t\tcategory: '',\r\n\t\t\t\tpackUnit: 'ç›’',\r\n\t\t\t\tminUnit: 'ç‰‡',\r\n\t\t\t\tconversionRate: 1,\r\n\t\t\t\tsafeStock: 100,\r\n\t\t\t\tminStock: 50,\r\n\t\t\t\tisHighValue: false,\r\n\t\t\t\tisEmergency: false,\r\n\t\t\t\tremark: ''\r\n\t\t\t},\r\n\t\t\tcategoryOptions: [\r\n\t\t\t\t'æŠ—ç”Ÿç´ ç±»',\r\n\t\t\t\t'å¿ƒè¡€ç®¡ç±»',\r\n\t\t\t\t'æ¶ˆåŒ–ç³»ç»Ÿç±»',\r\n\t\t\t\t'å‘¼å¸ç³»ç»Ÿç±»',\r\n\t\t\t\t'è§£çƒ­é•‡ç—›ç±»',\r\n\t\t\t\t'ç»´ç”Ÿç´ ç±»',\r\n\t\t\t\t'å¤–ç”¨è¯ç±»',\r\n\t\t\t\t'æ€¥æ•‘è¯æ',\r\n\t\t\t\t'å…¶ä»–'\r\n\t\t\t],\r\n\t\t\tcategoryIndex: -1\r\n\t\t}\r\n\t},\r\n\r\n\tonLoad(options) {\r\n\t\tif (options.id) {\r\n\t\t\tthis.isEdit = true\r\n\t\t\tthis.drugId = options.id\r\n\t\t\tthis.loadDrugDetail()\r\n\t\t}\r\n\t},\r\n\r\n\tmethods: {\r\n\t\t// æ‰«ç æˆåŠŸå›è°ƒ\r\n\t\tasync onScanSuccess(drugInfo) {\r\n\t\t\tconsole.log('âœ… æ‰«ç æˆåŠŸï¼Œè·å–åˆ°è¯æä¿¡æ¯:', drugInfo)\r\n\t\t\t\r\n\t\t\tconst barcode = drugInfo.barcode\r\n\t\t\t\r\n\t\t\t// æ£€æŸ¥æ•°æ®åº“ä¸­æ˜¯å¦å·²å­˜åœ¨è¯¥æ¡å½¢ç \r\n\t\t\tconst exists = await this.checkBarcodeExists(barcode)\r\n\t\t\t\r\n\t\t\tif (exists) {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: 'ğŸ’Š è¯æå·²å­˜åœ¨',\r\n\t\t\t\t\tcontent: `è¯¥æ¡å½¢ç è¯æå·²å½•å…¥ç³»ç»Ÿ\\n\\nè¯æåç§°ï¼š${exists.drugName}\\nè§„æ ¼ï¼š${exists.specification}\\n\\næ˜¯å¦æŸ¥çœ‹è¯¦æƒ…ï¼Ÿ`,\r\n\t\t\t\t\tconfirmText: 'æŸ¥çœ‹è¯¦æƒ…',\r\n\t\t\t\t\tcancelText: 'é‡æ–°å½•å…¥',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\t\turl: `/pages-sub/drug/detail?id=${exists._id}`\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// è‡ªåŠ¨å¡«å……è¡¨å•\r\n\t\t\tthis.fillFormFromScanData(drugInfo)\r\n\t\t\t\r\n\t\t\t// æ˜¾ç¤ºæˆåŠŸæç¤º\r\n\t\t\tconst sourceText = {\r\n\t\t\t\t'local': 'æœ¬åœ°æ¡£æ¡ˆ',\r\n\t\t\t\t'cache': 'ç¼“å­˜æ•°æ®',\r\n\t\t\t\t'gs1': 'APIæŸ¥è¯¢'\r\n\t\t\t}[drugInfo.source] || 'æ‰«ç '\r\n\t\t\t\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: `âœ… ä¿¡æ¯å·²è‡ªåŠ¨å¡«å…… (${sourceText})`,\r\n\t\t\t\ticon: 'success',\r\n\t\t\t\tduration: 2000\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// ä»æ‰«ç æ•°æ®å¡«å……è¡¨å•\r\n\t\tfillFormFromScanData(drugInfo) {\r\n\t\t\tconsole.log('ğŸ“ è‡ªåŠ¨å¡«å……è¡¨å•:', drugInfo)\r\n\t\t\t\r\n\t\t\t// å¡«å……åŸºæœ¬ä¿¡æ¯\r\n\t\t\tif (drugInfo.name) {\r\n\t\t\t\tthis.form.drugName = drugInfo.name\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (drugInfo.specification) {\r\n\t\t\t\tthis.form.specification = drugInfo.specification\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (drugInfo.manufacturer) {\r\n\t\t\t\tthis.form.manufacturer = drugInfo.manufacturer\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (drugInfo.barcode) {\r\n\t\t\t\tthis.form.barcode = drugInfo.barcode\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// å¡«å……åˆ†ç±»\r\n\t\t\tif (drugInfo.category) {\r\n\t\t\t\tthis.form.category = drugInfo.category\r\n\t\t\t\tconst index = this.categoryOptions.indexOf(drugInfo.category)\r\n\t\t\t\tif (index >= 0) {\r\n\t\t\t\t\tthis.categoryIndex = index\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// æ™ºèƒ½è§£æå•ä½ä¿¡æ¯\r\n\t\t\tif (drugInfo.unit) {\r\n\t\t\t\tthis.form.packUnit = drugInfo.unit\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// å°è¯•ä»è§„æ ¼ä¸­è§£æè½¬æ¢ç‡\r\n\t\t\tif (drugInfo.specification) {\r\n\t\t\t\tconst conversionInfo = this.parseConversionFromSpec(drugInfo.specification)\r\n\t\t\t\tif (conversionInfo) {\r\n\t\t\t\t\tthis.form.conversionRate = conversionInfo.rate\r\n\t\t\t\t\tif (conversionInfo.minUnit) {\r\n\t\t\t\t\t\tthis.form.minUnit = conversionInfo.minUnit\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconsole.log('âœ… è¡¨å•å¡«å……å®Œæˆ:', this.form)\r\n\t\t},\r\n\t\t\r\n\t\t// ä»è§„æ ¼å­—ç¬¦ä¸²è§£æè½¬æ¢ç‡\r\n\t\tparseConversionFromSpec(spec) {\r\n\t\t\t// åŒ¹é…å¸¸è§æ ¼å¼ï¼š\r\n\t\t\t// \"0.25g*24ç²’\" -> 24ç²’\r\n\t\t\t// \"10ml*10æ”¯\" -> 10æ”¯\r\n\t\t\t// \"100mgÃ—20ç‰‡\" -> 20ç‰‡\r\n\t\t\t\r\n\t\t\tconst patterns = [\r\n\t\t\t\t/[*Ã—](\\d+)([ç‰‡ç²’ç²’æ”¯è¢‹åŒ…])/,  // åŒ¹é… *24ç‰‡ æˆ– Ã—24ç‰‡\r\n\t\t\t\t/(\\d+)([ç‰‡ç²’æ”¯è¢‹åŒ…])\\/[ç›’ç“¶]/  // åŒ¹é… 24ç‰‡/ç›’\r\n\t\t\t]\r\n\t\t\t\r\n\t\t\tfor (let pattern of patterns) {\r\n\t\t\t\tconst match = spec.match(pattern)\r\n\t\t\t\tif (match) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\trate: parseInt(match[1]),\r\n\t\t\t\t\t\tminUnit: match[2]\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn null\r\n\t\t},\r\n\r\n\t\t// æ¡å½¢ç ä¸å­˜åœ¨å›è°ƒ\r\n\t\tonBarcodeNotFound(data) {\r\n\t\t\tconsole.log('âš ï¸ æœªæ‰¾åˆ°æ¡å½¢ç :', data)\r\n\t\t\t\r\n\t\t\tconst barcode = data.barcode || data\r\n\t\t\t\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: 'ğŸ’Š æ–°è¯æå½•å…¥',\r\n\t\t\t\tcontent: `æ¡å½¢ç ï¼š${barcode}\\n\\nè¯¥è¯ææœªåœ¨ç³»ç»Ÿä¸­æ‰¾åˆ°ï¼Œè¯·æ‰‹åŠ¨å¡«å†™è¯æä¿¡æ¯ã€‚\\n\\næç¤ºï¼šå¡«å†™å®Œæˆåï¼Œä¸‹æ¬¡æ‰«ææ­¤æ¡å½¢ç å°†è‡ªåŠ¨è¯†åˆ«ã€‚`,\r\n\t\t\t\tshowCancel: false,\r\n\t\t\t\tconfirmText: 'å¼€å§‹å¡«å†™',\r\n\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t// åªå¡«å……æ¡å½¢ç ï¼Œå…¶ä»–ä¿¡æ¯éœ€è¦æ‰‹åŠ¨å¡«å†™\r\n\t\t\t\t\tthis.form.barcode = barcode\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ»šåŠ¨åˆ°è¡¨å•é¡¶éƒ¨\r\n\t\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\t\tscrollTop: 200,\r\n\t\t\t\t\t\tduration: 300\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\t// æ£€æŸ¥æ¡å½¢ç æ˜¯å¦å­˜åœ¨\r\n\t\tasync checkBarcodeExists(barcode) {\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await wx.cloud.callFunction({\r\n\t\t\t\t\tname: 'drugManage',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'checkBarcode',\r\n\t\t\t\t\t\tbarcode: barcode\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif (res.result.success && res.result.data) {\r\n\t\t\t\t\treturn res.result.data\r\n\t\t\t\t}\r\n\t\t\t\treturn null\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('æ£€æŸ¥æ¡å½¢ç å¤±è´¥:', err)\r\n\t\t\t\treturn null\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// åŠ è½½è¯æè¯¦æƒ…ï¼ˆç¼–è¾‘æ¨¡å¼ï¼‰\r\n\t\tasync loadDrugDetail() {\r\n\t\t\tuni.showLoading({ title: 'åŠ è½½ä¸­...' })\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await wx.cloud.callFunction({\r\n\t\t\t\t\tname: 'drugManage',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'getDetail',\r\n\t\t\t\t\t\t_id: this.drugId\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif (res.result.success) {\r\n\t\t\t\t\tconst drug = res.result.data\r\n\t\t\t\t\tthis.form = {\r\n\t\t\t\t\t\tdrugCode: drug.drugCode || '',\r\n\t\t\t\t\t\tdrugName: drug.drugName || '',\r\n\t\t\t\t\t\tspecification: drug.specification || '',\r\n\t\t\t\t\t\tmanufacturer: drug.manufacturer || '',\r\n\t\t\t\t\t\tbarcode: drug.barcode || '',\r\n\t\t\t\t\t\tcategory: drug.category || '',\r\n\t\t\t\t\t\tpackUnit: drug.packUnit || 'ç›’',\r\n\t\t\t\t\t\tminUnit: drug.minUnit || 'ç‰‡',\r\n\t\t\t\t\t\tconversionRate: drug.conversionRate || 1,\r\n\t\t\t\t\t\tsafeStock: drug.safeStock || 100,\r\n\t\t\t\t\t\tminStock: drug.minStock || 50,\r\n\t\t\t\t\t\tisHighValue: drug.isHighValue || false,\r\n\t\t\t\t\t\tisEmergency: drug.isEmergency || false,\r\n\t\t\t\t\t\tremark: drug.remark || ''\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// è®¾ç½®åˆ†ç±»ç´¢å¼•\r\n\t\t\t\t\tconst index = this.categoryOptions.indexOf(this.form.category)\r\n\t\t\t\t\tthis.categoryIndex = index >= 0 ? index : -1\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('åŠ è½½è¯æè¯¦æƒ…å¤±è´¥:', err)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'åŠ è½½å¤±è´¥',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t} finally {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// åˆ†ç±»é€‰æ‹©\r\n\t\tonCategoryChange(e) {\r\n\t\t\tthis.categoryIndex = e.detail.value\r\n\t\t\tthis.form.category = this.categoryOptions[e.detail.value]\r\n\t\t},\r\n\r\n\t\t// è¡¨å•éªŒè¯\r\n\t\tvalidateForm() {\r\n\t\t\tif (!this.form.drugName) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'è¯·è¾“å…¥è¯æåç§°',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.form.specification) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'è¯·è¾“å…¥è¯æè§„æ ¼',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.form.manufacturer) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'è¯·è¾“å…¥ç”Ÿäº§å‚å®¶',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.form.packUnit) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'è¯·è¾“å…¥åŒ…è£…å•ä½',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.form.minUnit) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'è¯·è¾“å…¥æœ€å°å•ä½',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.form.conversionRate || this.form.conversionRate <= 0) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'è¯·è¾“å…¥æ­£ç¡®çš„è½¬æ¢ç‡',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\r\n\t\t\treturn true\r\n\t\t},\r\n\r\n\t\t// æäº¤è¡¨å•\r\n\t\tasync handleSubmit() {\r\n\t\t\tif (!this.validateForm()) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tuni.showLoading({ title: this.isEdit ? 'ä¿å­˜ä¸­...' : 'æ·»åŠ ä¸­...' })\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// å¦‚æœæ²¡æœ‰è¯æä»£ç ï¼Œè‡ªåŠ¨ç”Ÿæˆ\r\n\t\t\t\tif (!this.form.drugCode) {\r\n\t\t\t\t\tthis.form.drugCode = this.generateDrugCode()\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst submitData = {\r\n\t\t\t\t\t...this.form,\r\n\t\t\t\t\tupdateTime: new Date().getTime()\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.isEdit) {\r\n\t\t\t\t\t// æ›´æ–°è¯æ\r\n\t\t\t\t\tsubmitData._id = this.drugId\r\n\t\t\t\t\tawait wx.cloud.callFunction({\r\n\t\t\t\t\t\tname: 'drugManage',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\taction: 'update',\r\n\t\t\t\t\t\t\t...submitData\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// æ–°å¢è¯æ\r\n\t\t\t\t\tsubmitData.createTime = new Date().getTime()\r\n\t\t\t\t\tawait wx.cloud.callFunction({\r\n\t\t\t\t\t\tname: 'drugManage',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\taction: 'add',\r\n\t\t\t\t\t\t\t...submitData\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: this.isEdit ? 'ä¿å­˜æˆåŠŸ' : 'æ·»åŠ æˆåŠŸ',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t})\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tuni.navigateBack()\r\n\t\t\t\t}, 1500)\r\n\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('æäº¤å¤±è´¥:', err)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'æäº¤å¤±è´¥',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t} finally {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// ç”Ÿæˆè¯æä»£ç \r\n\t\tgenerateDrugCode() {\r\n\t\t\t// ç®€å•çš„ä»£ç ç”Ÿæˆé€»è¾‘ï¼šå–è¯æåç§°æ‹¼éŸ³é¦–å­—æ¯ + è§„æ ¼é¦–å­—æ¯ + æ—¶é—´æˆ³å4ä½\r\n\t\t\tconst name = this.form.drugName\r\n\t\t\tconst spec = this.form.specification\r\n\t\t\tconst timestamp = Date.now().toString().slice(-4)\r\n\t\t\t\r\n\t\t\t// è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…åº”è¯¥ç”¨æ‹¼éŸ³åº“\r\n\t\t\tconst nameCode = name.substring(0, 3).toUpperCase()\r\n\t\t\tconst specCode = spec ? spec.substring(0, 3).replace(/[^a-zA-Z0-9]/g, '').toUpperCase() : ''\r\n\t\t\t\r\n\t\t\treturn `${nameCode}${specCode}-${timestamp}`\r\n\t\t},\r\n\r\n\t\t// å–æ¶ˆ\r\n\t\thandleCancel() {\r\n\t\t\tuni.navigateBack()\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.page-container {\r\n\tmin-height: 100vh;\r\n\t/* ä¸å‡ºå…¥åº“/åº“å­˜é¡µé¢ç»Ÿä¸€çš„è“è‰²æ¸å˜èƒŒæ™¯ */\r\n\tbackground: linear-gradient(180deg, #00c9ff 0%, #00a0ff 35%, #e5e7eb 100%);\r\n\tpadding: 24rpx 24rpx 150rpx;\r\n}\r\n\r\n.page-header {\r\n\tmax-width: 702rpx;\r\n\tmargin: 10rpx auto 8rpx;\r\n\tbackground: #fffff0;\r\n\tpadding: 26rpx 26rpx 20rpx;\r\n\ttext-align: center;\r\n\tborder-radius: 22rpx;\r\n\tbox-shadow:\r\n\t\t0 1rpx 0 rgba(255, 255, 255, 0.9) inset,\r\n\t\t0 -1rpx 0 rgba(15, 23, 42, 0.06) inset,\r\n\t\t0 18rpx 40rpx rgba(15, 23, 42, 0.14);\r\n}\r\n\r\n.clinic-name {\r\n\tfont-size: 40rpx;\r\n\tfont-weight: bold;\r\n\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\t-webkit-background-clip: text;\r\n\t-webkit-text-fill-color: transparent;\r\n\tmargin-bottom: 12rpx;\r\n\tletter-spacing: 2rpx;\r\n}\r\n\r\n.doc-type {\r\n\tfont-size: 26rpx;\r\n\tcolor: #666666;\r\n\tletter-spacing: 1rpx;\r\n}\r\n\r\n.scan-section {\r\n\tmax-width: 702rpx;\r\n\tmargin: 0 auto 8rpx;\r\n\tbackground: #fffff0;\r\n\tborder-radius: 22rpx;\r\n\tpadding: 30rpx 26rpx 26rpx;\r\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\r\n}\r\n\r\n.scan-title {\r\n\tfont-size: 32rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #FFFFFF;\r\n\tmargin-bottom: 10rpx;\r\n\ttext-align: center;\r\n}\r\n\r\n.scan-desc {\r\n\tfont-size: 24rpx;\r\n\tcolor: rgba(255, 255, 255, 0.8);\r\n\ttext-align: center;\r\n\tmargin-bottom: 30rpx;\r\n}\r\n\r\n.form-section {\r\n\tmax-width: 702rpx;\r\n\tmargin: 0 auto 8rpx;\r\n\tbackground-color: #fffff0;\r\n\tborder-radius: 22rpx;\r\n\tpadding: 26rpx 26rpx 22rpx;\r\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\r\n}\r\n\r\n.section-title {\r\n\tfont-size: 32rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333333;\r\n\tmargin-bottom: 10rpx;\r\n\tpadding-bottom: 20rpx;\r\n\tborder-bottom: 2rpx solid #F0F0F0;\r\n}\r\n\r\n.section-desc {\r\n\tfont-size: 24rpx;\r\n\tcolor: #999999;\r\n\tmargin-bottom: 30rpx;\r\n\tline-height: 1.6;\r\n}\r\n\r\n.form-item {\r\n\tmargin-bottom: 30rpx;\r\n}\r\n\r\n.label {\r\n\tfont-size: 28rpx;\r\n\tcolor: #333333;\r\n\tmargin-bottom: 15rpx;\r\n\tdisplay: block;\r\n\tfont-weight: 500;\r\n}\r\n\r\n.required::before {\r\n\tcontent: '*';\r\n\tcolor: #FF4444;\r\n\tmargin-right: 5rpx;\r\n}\r\n\r\n.input {\r\n\twidth: 100%;\r\n\theight: 80rpx;\r\n\tbackground-color: #F8F9FA;\r\n\tborder-radius: 12rpx;\r\n\tpadding: 0 20rpx;\r\n\tfont-size: 28rpx;\r\n\tcolor: #333333;\r\n\tborder: 2rpx solid transparent;\r\n\ttransition: all 0.3s;\r\n\tbox-sizing: border-box;\r\n}\r\n\r\n.input:focus {\r\n\tbackground-color: #FFFFFF;\r\n\tborder-color: #667eea;\r\n}\r\n\r\n.placeholder {\r\n\tcolor: #CCCCCC;\r\n}\r\n\r\n.picker-display {\r\n\theight: 80rpx;\r\n\tbackground-color: #F8F9FA;\r\n\tborder-radius: 12rpx;\r\n\tpadding: 0 20rpx;\r\n\tfont-size: 28rpx;\r\n\tcolor: #333333;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tborder: 2rpx solid transparent;\r\n}\r\n\r\n.input-row {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 15rpx;\r\n}\r\n\r\n.flex-input {\r\n\tflex: 1;\r\n}\r\n\r\n.hint {\r\n\tfont-size: 24rpx;\r\n\tcolor: #999999;\r\n\twhite-space: nowrap;\r\n}\r\n\r\n.conversion-row {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 15rpx;\r\n\tbackground-color: #F8F9FA;\r\n\tborder-radius: 12rpx;\r\n\tpadding: 20rpx;\r\n}\r\n\r\n.conversion-text {\r\n\tfont-size: 28rpx;\r\n\tcolor: #666666;\r\n\twhite-space: nowrap;\r\n}\r\n\r\n.conversion-input {\r\n\twidth: 120rpx;\r\n\theight: 60rpx;\r\n\tbackground-color: #FFFFFF;\r\n\ttext-align: center;\r\n\tfont-weight: bold;\r\n\tcolor: #667eea;\r\n}\r\n\r\n.conversion-example {\r\n\tmargin-top: 20rpx;\r\n\tpadding: 20rpx;\r\n\tbackground: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%);\r\n\tborder-radius: 12rpx;\r\n\tdisplay: flex;\r\n\talign-items: flex-start;\r\n\tgap: 10rpx;\r\n}\r\n\r\n.example-icon {\r\n\tfont-size: 32rpx;\r\n\tline-height: 1;\r\n}\r\n\r\n.example-text {\r\n\tflex: 1;\r\n\tfont-size: 24rpx;\r\n\tcolor: #F57C00;\r\n\tline-height: 1.6;\r\n}\r\n\r\n.switch-item {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tpadding: 25rpx 0;\r\n\tborder-bottom: 1rpx solid #F0F0F0;\r\n}\r\n\r\n.switch-item:last-child {\r\n\tborder-bottom: none;\r\n}\r\n\r\n.switch-label {\r\n\tflex: 1;\r\n}\r\n\r\n.label-text {\r\n\tfont-size: 28rpx;\r\n\tcolor: #333333;\r\n\tfont-weight: 500;\r\n\tdisplay: block;\r\n\tmargin-bottom: 8rpx;\r\n}\r\n\r\n.label-desc {\r\n\tfont-size: 24rpx;\r\n\tcolor: #999999;\r\n\tdisplay: block;\r\n}\r\n\r\n.textarea {\r\n\twidth: 100%;\r\n\tmin-height: 200rpx;\r\n\tbackground-color: #F8F9FA;\r\n\tborder-radius: 12rpx;\r\n\tpadding: 20rpx;\r\n\tfont-size: 28rpx;\r\n\tcolor: #333333;\r\n\tline-height: 1.6;\r\n\tbox-sizing: border-box;\r\n}\r\n\r\n.char-count {\r\n\ttext-align: right;\r\n\tfont-size: 24rpx;\r\n\tcolor: #999999;\r\n\tmargin-top: 10rpx;\r\n}\r\n\r\n.bottom-actions {\r\n\tposition: fixed;\r\n\tbottom: 0;\r\n\tleft: 0;\r\n\tright: 0;\r\n\tbackground-color: #FFFFFF;\r\n\tpadding: 18rpx 24rpx 26rpx;\r\n\tdisplay: flex;\r\n\tgap: 20rpx;\r\n\tbox-shadow: 0 -4rpx 20rpx rgba(0, 0, 0, 0.08);\r\n\tz-index: 100;\r\n}\r\n\r\n.btn-cancel,\r\n.btn-submit {\r\n\tflex: 1;\r\n\theight: 90rpx;\r\n\tborder-radius: 999rpx;\r\n\tfont-size: 32rpx;\r\n\tfont-weight: bold;\r\n\tborder: none;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n}\r\n\r\n.btn-cancel {\r\n\tbackground-color: #ffffff;\r\n\tcolor: #64748b;\r\n\tborder: 1rpx solid #cbd5e1;\r\n}\r\n\r\n.btn-submit {\r\n\tbackground: linear-gradient(135deg, #00c9ff 0%, #00a0ff 100%);\r\n\tcolor: #ffffff;\r\n\tbox-shadow: 0 8rpx 20rpx rgba(0, 160, 255, 0.3);\r\n}\r\n</style>\r\n","import mod from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=style&index=0&id=cfbffdd0&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=style&index=0&id=cfbffdd0&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1767327913758\n      var cssReload = require(\"D:/HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}