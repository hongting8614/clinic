{"version":3,"sources":["uni-app:///main.js","webpack:///D:/AK-PMS/pages-sub/in/add.vue?96a1","webpack:///D:/AK-PMS/pages-sub/in/add.vue?6aee","webpack:///D:/AK-PMS/pages-sub/in/add.vue?cd25","webpack:///D:/AK-PMS/pages-sub/in/add.vue?10b2","uni-app:///pages-sub/in/add.vue","webpack:///D:/AK-PMS/pages-sub/in/add.vue?484a","webpack:///D:/AK-PMS/pages-sub/in/add.vue?d16f"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","signature","data","recordNo","currentDate","operator","remark","drugList","operatorSign","searchKeyword","searchFocused","showSearchResult","searchResults","searchTimer","isSearchingAPI","showCreateForm","createFormSource","newDrug","name","spec","unit","barcode","manufacturer","approvalNumber","unitOptions","unitIndex","minDate","maxDate","maxExpDate","computed","totalQuantity","totalAmount","onLoad","methods","initPage","onSearchFocus","onSearchBlur","setTimeout","onSearchInput","clearTimeout","onSearchConfirm","searchDrugs","keyword","drugName","result","drugs","_id","specification","packUnit","source","sourceText","uni","title","icon","duration","console","activateCreateFormWithAPI","activateCreateFormManual","clearSearch","cancelCreate","confirmCreate","mask","db","createTime","createSource","newDrugItem","drugId","batch","productionDate","expireDate","daysToExpiry","quantity","price","amount","hasError","selectDrug","scrollTop","type","scanBarcode","apiStats","content","showCancel","confirmText","cancelText","res","scanType","onlyFromCamera","autoDecrypt","scanRes","cleanBarcode","getAPIStats","action","todayUsed","remaining","limit","warning","critical","queryDrugByBarcode","drugInfo","exists","item","isTemp","stats","success","itemList","actionRes","createMappingAndQuery","drug","æ‰¹å·","æœ‰æ•ˆæœŸ","æ•°é‡","å•ä»·","apiSource","selectExistingDrug","drugNames","selectedDrug","linkBarcodeToDrug","isPrescription","prescriptionType","onUnitChange","startVoiceInput","onDateChange","calculateAmount","validateRow","formatAmount","deleteDrug","validateForm","submit","userInfo","items","operatorId","operatorSignTime","status"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,YAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA4H;AAC5H;AACuD;AACL;AACsC;;;AAGxF;AAC4M;AAC5M,gBAAgB,gNAAU;AAC1B,EAAE,yEAAM;AACR,EAAE,0FAAM;AACR,EAAE,mGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,8FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,kLAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC5FA;AAAA;AAAA;AAAA;AAAgyB,CAAgB,4xBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;ACyVpzB;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eAEA;EACAC;IACAC;EACA;EAEAC;IACA;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IACAC;MACA;QACA;MACA;IACA;IAEAC;MACA;QACA;MACA;IACA;EACA;EAEAC;IACA;EACA;EAEAC;IACAC;MACA;MACA;;MAEA;MACA;MACA;MACA;;MAEA;MACA;MACA;IACA;IAGA;IACAC;MACA;MACA;MACA;MACA;QACA;MACA;IACA;IAEAC;MAAA;MACA;MACA;MACAC;QACA;MACA;IACA;IAEAC;MAAA;MACA;MAEA;QACA;QACA;QACA;MACA;;MAEA;MACA;QACAC;MACA;MAEA;QACA;MACA;IACA;IAEAC;MACA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAC;gBAAA,IACAA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAGA;gBACA;gBACA;;gBAEA;gBAAA;gBAAA,OACA/C;kBACAuB;kBACAhB;oBAAAyC;kBAAA;gBACA;cAAA;gBAHAC;gBAKA;gBAEA;kBACA;kBACAC,4BAEA;kBACA;oBAAA;sBACAC;sBACA5B;sBACAC;sBACA4B;sBACA3B;sBACA4B;sBACA1B;sBACAD;sBACAE;sBACA0B;oBACA;kBAAA;;kBAEA;kBACA;kBACA;;kBAEA;kBACAC;oBACA;oBACA;kBACA;kBAEAC;oBACAC;oBACAC;oBACAC;kBACA;gBAEA;kBACA;kBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAC;gBACA;gBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAC;MACA;MACA;MACA;;MAEA;MACA;QACAtC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;;MAEA;MACA;MACA;MAEA4B;QACAC;QACAC;QACAC;MACA;IACA;IAEA;IACAG;MACA;MACA;MACA;;MAEA;MACA;QACAvC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACA;MAEA4B;QACAC;QACAC;QACAC;MACA;IACA;IAEAI;MACA;MACA;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;QACAzC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACA;IACA;IAEA;IACAqC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,MAEA;kBAAA;kBAAA;gBAAA;gBACAT;kBACAC;kBACAC;gBACA;gBAAA;cAAA;gBAIAF;kBAAAC;kBAAAS;gBAAA;gBAAA;gBAGAC,0BAEA;gBAAA;gBAAA,OACAA;kBACA5D;oBACAgB;oBACAC;oBACA4B;oBAAA;oBACAC;oBACA5B;oBAAA;oBACAC;oBACAC;oBACAC;oBACAwC;oBACAC;kBACA;gBACA;cAAA;gBAbApB;gBAeAO;gBAEA;kBACAA;oBACAC;oBACAC;oBACAC;kBACA;;kBAEA;kBACAW;oBACAC;oBACAvB;oBACAI;oBACA3B;oBACAE;oBACA6C;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;kBACA,GAEA;kBACA;;kBAEA;kBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAnB;gBACAJ;gBACAA;kBACAC;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAsB;MAAA;MACA;MACA;QAAA;MAAA;MACA;QACAxB;UACAC;UACAC;QACA;QACA;MACA;;MAEA;MACAF;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;UACA;UACA;YACAe;YACAvB;YACAI;YACA3B;YACAE;YACA6C;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;UACA;;UAEA;UACA;YACAvB;cACAyB;cACAtB;YACA;UACA;;UAEA;UACAH;YACAC;YACAC;YACAC;UACA;;UAEA;UACA3D;YAAAkF;UAAA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAIA;cAAA;gBAAAC;gBAAA,MAEAA;kBAAA;kBAAA;gBAAA;gBACA5B;kBACAC;kBACA4B;kBACAC;gBACA;gBAAA;cAAA;gBAAA,KAKAF;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACA5B;kBACAC;kBACA4B;kBACAE;kBACAC;gBACA;cAAA;gBALAC;gBAAA,IAOAA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA,OAMAjC;kBACA;kBACAkC,WACA;kBAAA;kBACA;kBAAA;kBACA;kBAAA;kBACA;kBAAA,CACA;;kBACA;kBACAC;kBACA;kBACAC;gBACA;cAAA;gBAZAC;gBAcAjC;gBACAA;gBACAA;;gBAEA;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBACAA;gBACAJ;kBACAC;kBACAC;gBACA;gBAAA;cAAA;gBAIA;gBACAoC;gBACAlC;;gBAEA;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBACAJ;kBACAC;kBACAC;gBACA;gBAAA;cAAA;gBAAA;gBAAA,OAIA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAE;gBACA;kBACAJ;oBACAC;oBACAC;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAqC;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEA/F;kBACAuB;kBACAhB;oBACAyF;kBACA;gBACA;cAAA;gBALA/C;gBAAA,MAOAA;kBAAA;kBAAA;gBAAA;gBAAA,kCACAA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAW;cAAA;gBAAA,kCAGA;kBACAqC;kBACAC;kBACAC;kBACAC;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA1C;gBACAA;gBACAA;gBAEAJ;kBAAAC;kBAAAS;gBAAA;gBAAA;gBAGA;gBACAN;gBAAA;gBAAA,OACA5D;kBACAuB;kBACAhB;oBACAyF;oBACAtE;kBACA;gBACA;cAAA;gBANA+D;gBAQA7B;gBACAA;gBACAA;gBAEAJ;gBAAA,MAEAiC;kBAAA;kBAAA;gBAAA;gBACA7B;gBACA;gBACA2C,4BAEA;gBACAC;kBAAA,OACAC,mCACAA;gBAAA,EACA;gBAAA,KAEAD;kBAAA;kBAAA;gBAAA;gBACAhD;kBACAC;kBACAC;gBACA;gBAAA;cAAA;gBAIA;gBACA;kBACAa;kBACAvB;kBACAI;kBACA3B;kBACAE;kBACA6C;kBACAC;kBACAC;kBACAC;kBACAC;kBACAC;kBACAC;kBACAC;kBACA2B;gBACA;;gBAEA;gBACAnD;kBACA;kBACA;gBACA;gBAEAC;kBACAC;kBACAC;kBACAC;gBACA;;gBAEA;gBACA;kBACAgD;kBACA;oBACAjE;sBACAc;wBACAC;wBACAC;wBACAC;sBACA;oBACA;kBACA;gBACA;;gBAEA;gBACA3D;kBAAAkF;gBAAA;gBAAA;gBAAA;cAAA;gBAEA;kBACA;kBACA1B;oBACAC;oBACA4B;oBACAE;oBACAC;oBACAoB;sBACA;wBACA;wBACA;sBACA;oBACA;kBACA;gBAEA;kBACA;kBACAhD;kBACAJ;;kBAEA;kBACAA;oBACAC;oBACAoD;oBACAD;sBAAA;wBAAA;0BAAA;4BAAA;8BAAA;gCAAA,MACAE;kCAAA;kCAAA;gCAAA;gCAAA;gCAAA,OAEA;8BAAA;gCAAA;gCAAA;8BAAA;gCACA;kCACA;kCACA;kCACA;gCACA;8BAAA;8BAAA;gCAAA;4BAAA;0BAAA;wBAAA;sBAAA,CACA;sBAAA;wBAAA;sBAAA;sBAAA;oBAAA;kBACA;gBACA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAtD;gBACAI;gBAEAJ;kBACAC;kBACA4B;kBACAE;kBACAC;kBACAoB;oBACA;sBACA;sBACA;oBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAG;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAvD;kBAAAC;kBAAAS;gBAAA;gBAAA;gBAGAN;gBACAA;gBACAA;gBAAA;gBAAA,OAEA;kBACArC;kBACAhB;oBACAyF;oBACAtE;oBACAsB;oBACAI;oBAAA;oBACA3B;kBACA;gBACA;cAAA;gBATAgE;gBAWAjC;gBAEAI;gBAEA;kBACAoD,wBAEA;kBACA;oBACAzC;oBACA7C;oBACAH;oBACA6B;oBACA3B;oBACAE;oBACAsF;oBACAC;oBACAC;oBACAC;oBACAC;kBACA;kBAEA7D;oBACAC;oBACAC;oBACAC;kBACA;;kBAEA;kBACAjB;oBACAc;sBACAC;sBACAC;sBACAC;oBACA;kBACA;gBAEA;kBACAH;oBACAC;oBACA4B;oBACAC;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGA9B;gBACAI;gBAEAJ;kBACAC;kBACA4B;kBACAE;kBACAC;kBACAoB;oBACA;sBACA;sBACA;sBACA;oBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAU;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA9D;kBAAAC;kBAAAS;gBAAA;gBAAA;gBAAA;gBAAA,OAIA;kBACA3C;kBACAhB;oBACAyF;kBACA;gBACA;cAAA;gBALAP;gBAOAjC;gBAEA;kBACA;kBACA+D;oBAAA;kBAAA;kBAEA/D;oBACAqD;oBACAD;sBAAA;wBAAA;wBAAA;0BAAA;4BAAA;8BAAA;gCACAY;gCACA5D;;gCAEA;gCAAA;gCAAA,OACA;8BAAA;8BAAA;gCAAA;4BAAA;0BAAA;wBAAA;sBAAA,CACA;sBAAA;wBAAA;sBAAA;sBAAA;oBAAA;kBACA;gBACA;kBACAJ;oBACAC;oBACAC;kBACA;kBACA;kBACAhB;oBACA;oBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAc;gBACAI;gBACAJ;kBACAC;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACA+D;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAjE;kBAAAC;kBAAAS;gBAAA;gBAAA;gBAAA;gBAAA,OAIA;kBACA3C;kBACAhB;oBACAyF;oBACAzB;oBACA7C;kBACA;gBACA;cAAA;gBAEA;gBACAyC;gBAAA;gBAAA,OACAA;kBACA5D;oBACAmB;oBACAsB;oBACAI;oBACA3B;oBACAE;oBACAC;oBACA8F;oBACAC;oBACArE;oBACAc;kBACA;gBACA;cAAA;gBAEAZ;;gBAEA;gBACA;kBACAe;kBACA7C;kBACAH;kBACA6B;kBACA3B;kBACAE;kBACAsF;kBACAC;kBACAC;kBACAC;gBACA;gBAEA5D;kBACAC;kBACAC;gBACA;gBAEAhB;kBACAc;oBACAC;oBACAC;oBACAC;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAH;gBACAI;gBACAJ;kBACAC;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAkE;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;QACA;QACA;MACA;MAEArE;QACAC;QACA4B;QACAC;QACAC;MACA;IACA;IAEA;IACAuC;MACA;;MAEA;MACA;QACA;QACA;QACA;QACA;MACA;MAEA;IACA;IAEAC;MACA;MACA;MACA;MACAtB;IACA;IAEAuB;MACA;MACA;MAEA;QACAjD;MACA;MAEA0B;IACA;IAEAwB;MACA;MACA;IACA;IAEAC;MAAA;MACA1E;QACAC;QACA4B;QACAuB;UACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACAuB;MACA;QACA3E;UAAAC;UAAAC;QAAA;QACA;MACA;MAEA;QACA;QACA;QAEA;UACAF;YAAAC;YAAAC;UAAA;UACA;QACA;QACA;UACAF;YAAAC;YAAAC;UAAA;UACA;QACA;QACA;UACAF;YAAAC;YAAAC;UAAA;UACA;QACA;QACA;UACAF;YAAAC;YAAAC;UAAA;UACA;QACA;QACA;UACAF;YAAAC;YAAAC;UAAA;UACA;QACA;MACA;MAEA;QACAF;UAAAC;UAAAC;QAAA;QACA;MACA;MAEA;IACA;IAEA0E;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAIA5E;kBAAAC;kBAAAS;gBAAA;gBAAA;gBAGAmE;gBAAA;gBAAA,OAEArI;kBACAuB;kBACAhB;oBACAyF;oBACAzF;sBACAC;sBACAG;sBACA2H;wBAAA;0BACA/D;0BACAvB;0BACAI;0BACA5B;0BACAC;0BACAE;0BACA6C;0BACAC;0BACAC;0BACAE;0BACAC;wBACA;sBAAA;sBACAnE;sBACA6H;sBACA1H;sBACA2H;sBACAC;oBACA;kBACA;gBACA;cAAA;gBA3BAxF;gBA6BAO;gBAAA,MAEAP;kBAAA;kBAAA;gBAAA;gBACAO;kBACAC;kBACAC;kBACAC;gBACA;gBAEAjB;kBACAc;gBACA;gBAAA;gBAAA;cAAA;gBAAA,MAEA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAIAA;gBACAI;gBACAJ;kBACAC;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC12CA;AAAA;AAAA;AAAA;AAA+/C,CAAgB,+6CAAG,EAAC,C;;;;;;;;;;;ACAnhD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages-sub/in/add.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages-sub/in/add.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./add.vue?vue&type=template&id=58f3a51d&scoped=true&\"\nvar renderjs\nimport script from \"./add.vue?vue&type=script&lang=js&\"\nexport * from \"./add.vue?vue&type=script&lang=js&\"\nimport style0 from \"./add.vue?vue&type=style&index=0&id=58f3a51d&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"58f3a51d\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages-sub/in/add.vue\"\nexport default component.exports","export * from \"-!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add.vue?vue&type=template&id=58f3a51d&scoped=true&\"","var components\ntry {\n  components = {\n    signature: function () {\n      return import(\n        /* webpackChunkName: \"components/signature/index\" */ \"@/components/signature/index.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. æ’æŸ¥ç»„ä»¶åç§°æ‹¼å†™æ˜¯å¦æ­£ç¡®\")\n    console.error(\n      \"2. æ’æŸ¥ç»„ä»¶æ˜¯å¦ç¬¦åˆ easycom è§„èŒƒï¼Œæ–‡æ¡£ï¼šhttps://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. è‹¥ç»„ä»¶ä¸ç¬¦åˆ easycom è§„èŒƒï¼Œéœ€æ‰‹åŠ¨å¼•å…¥ï¼Œå¹¶åœ¨ components ä¸­æ³¨å†Œè¯¥ç»„ä»¶\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.showSearchResult && _vm.searchResults.length > 0\n  var g1 = _vm.drugList.length\n  var g2 = _vm.drugList.length\n  var l0 =\n    g2 > 0\n      ? _vm.__map(_vm.drugList, function (item, index) {\n          var $orig = _vm.__get_orig(item)\n          var m0 = item.amount > 0 ? _vm.formatAmount(item.amount) : null\n          return {\n            $orig: $orig,\n            m0: m0,\n          }\n        })\n      : null\n  var g3 =\n    _vm.drugList.length === 0 && !_vm.searchKeyword && !_vm.showSearchResult\n  var g4 = _vm.drugList.length\n  var g5 = g4 > 0 ? _vm.drugList.length : null\n  var m1 =\n    g4 > 0 && _vm.totalAmount > 0 ? _vm.formatAmount(_vm.totalAmount) : null\n  if (!_vm._isMounted) {\n    _vm.e0 = function (e, index) {\n      var args = [],\n        len = arguments.length - 2\n      while (len-- > 0) args[len] = arguments[len + 2]\n\n      var _temp = args[args.length - 1].currentTarget.dataset,\n        _temp2 = _temp.eventParams || _temp[\"event-params\"],\n        index = _temp2.index\n      var _temp, _temp2\n      return _vm.onDateChange(index, \"productionDate\", e.detail.value)\n    }\n    _vm.e1 = function (e, index) {\n      var args = [],\n        len = arguments.length - 2\n      while (len-- > 0) args[len] = arguments[len + 2]\n\n      var _temp3 = args[args.length - 1].currentTarget.dataset,\n        _temp4 = _temp3.eventParams || _temp3[\"event-params\"],\n        index = _temp4.index\n      var _temp3, _temp4\n      return _vm.onDateChange(index, \"expireDate\", e.detail.value)\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n        l0: l0,\n        g3: g3,\n        g4: g4,\n        g5: g5,\n        m1: m1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"page\">\r\n\t\t<!-- é¡µé¢å¤´éƒ¨ -->\r\n\t\t<view class=\"page-header\">\r\n\t\t\t<view class=\"header-content\">\r\n\t\t\t\t<text class=\"header-title\">è¯æå…¥åº“</text>\r\n\t\t\t\t<text class=\"header-subtitle\">å…¥åº“æ—¥æœŸï¼š{{ currentDate }}</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- åŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->\r\n\t\t<view class=\"info-card\">\r\n\t\t\t<view class=\"info-row\">\r\n\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t<text class=\"label\">å•å·ï¼š</text>\r\n\t\t\t\t\t<text class=\"value\">{{ recordNo }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t<text class=\"label\">åŒ»ç”Ÿï¼š</text>\r\n\t\t\t\t\t<text class=\"value\">{{ operator }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t<view class=\"info-row\">\r\n\t\t\t<view class=\"info-item full\">\r\n\t\t\t\t\t<text class=\"label\">å¤‡æ³¨</text>\r\n\t\t\t\t\t<input \r\n\t\t\t\t\t\tclass=\"input-value\" \r\n\t\t\t\t\t\tv-model=\"remark\" \r\n\t\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯ï¼ˆé€‰å¡«ï¼‰\"\r\n\t\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t/>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- æ™ºèƒ½è¾“å…¥æ¡† -->\r\n\t\t<view class=\"search-card\">\r\n\t\t\t<view class=\"search-wrapper\" :class=\"{ 'focused': searchFocused }\">\r\n\t\t\t\t<view class=\"search-icon-wrapper\">\r\n\t\t\t\t\t<text class=\"search-icon\">ğŸ”</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<input \r\n\t\t\t\t\tclass=\"search-input\"\r\n\t\t\t\t\tv-model=\"searchKeyword\"\r\n\t\t\t\t\tplaceholder=\"æ‰«ç /æœç´¢è¯æåç§°\"\r\n\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t@focus=\"onSearchFocus\"\r\n\t\t\t\t\t@blur=\"onSearchBlur\"\r\n\t\t\t\t\t@input=\"onSearchInput\"\r\n\t\t\t\t\t@confirm=\"onSearchConfirm\"\r\n\t\t\t\t/>\r\n\t\t\t\t<view v-if=\"searchKeyword\" class=\"clear-icon\" @tap=\"clearSearch\">\r\n\t\t\t\t\t<text>âœ•</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"scan-btn\" @tap=\"scanBarcode\">\r\n\t\t\t\t\t<view class=\"scan-icon-frame\"></view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- æœç´¢ç»“æœä¸‹æ‹‰åˆ—è¡¨ï¼ˆä½¿ç”¨transitionï¼‰ -->\r\n\t\t\t<view \r\n\t\t\t\tclass=\"search-results\" \r\n\t\t\t\t:class=\"{ 'show': showSearchResult && searchResults.length > 0 }\"\r\n\t\t\t>\r\n\t\t\t\t<view \r\n\t\t\t\t\tv-for=\"(drug, index) in searchResults\" \r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\tclass=\"result-item\"\r\n\t\t\t\t\t@tap=\"selectDrug(drug)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<view class=\"drug-info\">\r\n\t\t\t\t\t\t<text class=\"drug-name\">{{ drug.name }}</text>\r\n\t\t\t\t\t\t<text class=\"drug-spec\">{{ drug.spec }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<text class=\"select-icon\">â€º</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- APIæœç´¢ä¸­ -->\r\n\t\t\t<view v-if=\"isSearchingAPI\" class=\"api-searching\">\r\n\t\t\t\t<view class=\"loading-wrapper\">\r\n\t\t\t\t\t<text class=\"loading-icon\">â³</text>\r\n\t\t\t\t\t<text class=\"loading-text\">æ­£åœ¨æŸ¥è¯¢è¯ç›‘å±€æ•°æ®åº“...</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- åˆ›å»ºè¯æè¡¨å•ï¼ˆå†…è”ï¼‰ -->\r\n\t\t\t<view v-if=\"showCreateForm\" class=\"create-form-inline\">\r\n\t\t\t\t<!-- æç¤ºä¿¡æ¯ -->\r\n\t\t\t\t<view class=\"create-tip\" :class=\"createFormSource === 'api' ? 'tip-success' : 'tip-warning'\">\r\n\t\t\t\t\t<text class=\"tip-icon\">{{ createFormSource === 'api' ? 'âœ…' : 'ğŸ’¡' }}</text>\r\n\t\t\t\t\t<view class=\"tip-content\">\r\n\t\t\t\t\t\t<text class=\"tip-title\">\r\n\t\t\t\t\t\t\t{{ createFormSource === 'api' ? 'å·²ä»è¯ç›‘å±€è·å–æ•°æ®' : 'æœªæ‰¾åˆ°ç›¸å…³è¯æ' }}\r\n\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t<text class=\"tip-subtitle\">\r\n\t\t\t\t\t\t\t{{ createFormSource === 'api' ? 'ç¡®è®¤ä¿¡æ¯åå³å¯åˆ›å»º' : 'è¯·å®Œå–„ä»¥ä¸‹ä¿¡æ¯' }}\r\n\t\t\t\t\t\t</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<!-- åˆ›å»ºè¡¨å• -->\r\n\t\t\t\t<view class=\"inline-form\">\r\n\t\t\t\t\t<view class=\"inline-form-title\">ğŸ“ æ–°å»ºè¯ææ¡£æ¡ˆ</view>\r\n\t\t\t\t\t\r\n\t\t\t\t<!-- è¯æåç§° -->\r\n\t\t\t\t\t<view class=\"inline-form-item\">\r\n\t\t\t\t\t<text class=\"inline-label\">è¯æåç§° <text class=\"required\">*</text></text>\r\n\t\t\t\t\t<view class=\"input-with-voice\">\r\n\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\tclass=\"inline-input voice-input\" \r\n\t\t\t\t\t\t\tv-model=\"newDrug.name\" \r\n\t\t\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥è¯æåç§°\"\r\n\t\t\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<view class=\"voice-btn\" @tap=\"startVoiceInput('name')\">\r\n\t\t\t\t\t\t\t<text class=\"voice-icon\">ğŸ¤</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- è§„æ ¼ -->\r\n\t\t\t\t\t<view class=\"inline-form-item\">\r\n\t\t\t\t\t\t<text class=\"inline-label\">è§„æ ¼ <text class=\"required\">*</text></text>\r\n\t\t\t\t\t\t<view class=\"input-with-voice\">\r\n\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\t\tclass=\"inline-input voice-input\" \r\n\t\t\t\t\t\t\tv-model=\"newDrug.spec\" \r\n\t\t\t\t\t\t\tplaceholder=\"å¦‚ï¼š0.25gÃ—24ç²’/ç›’\"\r\n\t\t\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<view class=\"voice-btn\" @tap=\"startVoiceInput('spec')\">\r\n\t\t\t\t\t\t\t\t<text class=\"voice-icon\">ğŸ¤</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- å•ä½ -->\r\n\t\t\t\t\t<view class=\"inline-form-item\">\r\n\t\t\t\t\t\t<text class=\"inline-label\">å•ä½ <text class=\"required\">*</text></text>\r\n\t\t\t\t\t\t<picker \r\n\t\t\t\t\t\t\tmode=\"selector\"\r\n\t\t\t\t\t\t\t:range=\"unitOptions\"\r\n\t\t\t\t\t\t\t:value=\"unitIndex\"\r\n\t\t\t\t\t\t\t@change=\"onUnitChange\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<view class=\"inline-picker\">\r\n\t\t\t\t\t\t\t\t<text :class=\"['picker-text', !newDrug.unit && 'picker-placeholder']\">\r\n\t\t\t\t\t\t\t\t\t{{ newDrug.unit || 'è¯·é€‰æ‹©å•ä½' }}\r\n\t\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t\t\t<text class=\"picker-arrow\">â–¼</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</picker>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- æ“ä½œæŒ‰é’® -->\r\n\t\t\t\t\t<view class=\"inline-form-actions\">\r\n\t\t\t\t\t\t<view class=\"inline-btn btn-cancel\" @tap=\"cancelCreate\">\r\n\t\t\t\t\t\t\t<text>å–æ¶ˆ</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"inline-btn btn-confirm\" @tap=\"confirmCreate\">\r\n\t\t\t\t\t\t\t<text>ç¡®è®¤åˆ›å»ºå¹¶æ·»åŠ </text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- è¯æåˆ—è¡¨ -->\r\n\t\t<view class=\"drug-list-section\">\r\n\t\t\t<view class=\"section-header\">\r\n\t\t\t\t<text class=\"section-title\">å…¥åº“æ˜ç»†</text>\r\n\t\t\t\t<text class=\"section-count\">{{ drugList.length }} ç§</text>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- è¯æå¡ç‰‡åˆ—è¡¨ -->\r\n\t\t\t<view v-if=\"drugList.length > 0\" class=\"drug-cards\">\r\n\t\t\t\t<view \r\n\t\t\t\t\tv-for=\"(item, index) in drugList\" \r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\tclass=\"drug-card\"\r\n\t\t\t\t\t:class=\"{ 'has-error': item.hasError }\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<!-- è¯æå¤´éƒ¨ -->\r\n\t\t\t\t\t<view class=\"card-header\">\r\n\t\t\t\t\t\t<view class=\"drug-name-wrapper\">\r\n\t\t\t\t\t\t\t<text class=\"drug-name\">{{ item.drugName }}</text>\r\n\t\t\t\t\t\t\t<text class=\"drug-spec\">{{ item.specification }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"delete-btn\" @tap=\"deleteDrug(index)\">\r\n\t\t\t\t\t\t\t<text class=\"delete-icon\">âœ•</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- è¯æä¿¡æ¯è¡¨å• -->\r\n\t\t\t\t\t<view class=\"card-form\">\r\n\t\t\t\t\t\t<!-- ç¬¬ä¸€è¡Œï¼šæ‰¹å·ã€ç”Ÿäº§æ—¥æœŸã€æœ‰æ•ˆæœŸ -->\r\n\t\t\t\t\t\t<view class=\"form-row\">\r\n\t\t\t\t\t\t\t<view class=\"form-item third\">\r\n\t\t\t\t\t\t\t<text class=\"form-label\">æ‰¹å· <text class=\"required\">*</text></text>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tclass=\"form-input\"\r\n\t\t\t\t\t\t\t\tv-model=\"item.batch\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥æ‰¹å·\"\r\n\t\t\t\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t\t\t\t@blur=\"validateRow(index)\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<view class=\"form-item third\">\r\n\t\t\t\t\t\t\t<text class=\"form-label\">ç”Ÿäº§æ—¥æœŸ <text class=\"required\">*</text></text>\r\n\t\t\t\t\t\t\t<picker \r\n\t\t\t\t\t\t\t\tmode=\"date\"\r\n\t\t\t\t\t\t\t\t:value=\"item.productionDate\"\r\n\t\t\t\t\t\t\t\t:start=\"minDate\"\r\n\t\t\t\t\t\t\t\t:end=\"maxDate\"\r\n\t\t\t\t\t\t\t\t@change=\"e => onDateChange(index, 'productionDate', e.detail.value)\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<view class=\"picker-input\" :class=\"{ 'has-value': item.productionDate }\">\r\n\t\t\t\t\t\t\t\t\t{{ item.productionDate || 'è¯·é€‰æ‹©' }}\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</picker>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<view class=\"form-item third\">\r\n\t\t\t\t\t\t\t<text class=\"form-label\">æœ‰æ•ˆæœŸ <text class=\"required\">*</text></text>\r\n\t\t\t\t\t\t\t<picker \r\n\t\t\t\t\t\t\t\tmode=\"date\"\r\n\t\t\t\t\t\t\t\t:value=\"item.expireDate\"\r\n\t\t\t\t\t\t\t\t:start=\"minDate\"\r\n\t\t\t\t\t\t\t\t:end=\"maxExpDate\"\r\n\t\t\t\t\t\t\t\t@change=\"e => onDateChange(index, 'expireDate', e.detail.value)\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<view class=\"picker-input\" :class=\"{ 'has-value': item.expireDate }\">\r\n\t\t\t\t\t\t\t\t\t{{ item.expireDate || 'è¯·é€‰æ‹©' }}\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</picker>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t<!-- è·æœ‰æ•ˆæœŸ -->\r\n\t\t\t\t\t\t\t<view v-if=\"item.daysToExpiry !== null\" class=\"expiry-badge-inline\" :class=\"[\r\n\t\t\t\t\t\titem.daysToExpiry < 0 ? 'expired' : '',\r\n\t\t\t\t\t\titem.daysToExpiry >= 0 && item.daysToExpiry < 30 ? 'danger' : '',\r\n\t\t\t\t\t\titem.daysToExpiry >= 30 && item.daysToExpiry < 90 ? 'warning' : '',\r\n\t\t\t\t\t\titem.daysToExpiry >= 90 ? 'safe' : ''\r\n\t\t\t\t\t]\">\r\n\t\t\t\t\t\t<text>{{ item.daysToExpiry }}å¤©</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<!-- ç¬¬äºŒè¡Œï¼šæ•°é‡å’Œå•ä»· -->\r\n\t\t\t\t\t\t<view class=\"form-row\">\r\n\t\t\t\t\t\t\t<view class=\"form-item half\">\r\n\t\t\t\t\t\t\t\t<text class=\"form-label\">æ•°é‡ <text class=\"required\">*</text></text>\r\n\t\t\t\t\t\t\t\t<view class=\"input-with-unit\">\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\tclass=\"form-input\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t\tv-model=\"item.quantity\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"æ•°é‡\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t\t\t\t\t\t@blur=\"validateRow(index)\"\r\n\t\t\t\t\t\t\t\t\t\t@input=\"calculateAmount(index)\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<text class=\"unit-text\">{{ item.unit }}</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<view class=\"form-item half\">\r\n\t\t\t\t\t\t\t\t<text class=\"form-label\">å•ä»·</text>\r\n\t\t\t\t\t\t\t\t<view class=\"input-with-unit\">\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\tclass=\"form-input\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"digit\"\r\n\t\t\t\t\t\t\t\t\t\tv-model=\"item.price\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"é€‰å¡«\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t\t\t\t\t\t@input=\"calculateAmount(index)\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<text class=\"unit-text\">å…ƒ</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<!-- é‡‘é¢ -->\r\n\t\t\t\t\t\t<view v-if=\"item.amount > 0\" class=\"amount-display\">\r\n\t\t\t\t\t\t\t<text class=\"amount-label\">é‡‘é¢ï¼š</text>\r\n\t\t\t\t\t\t\t<text class=\"amount-value\">Â¥{{ formatAmount(item.amount) }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t<!-- ç©ºçŠ¶æ€ï¼ˆä»…åœ¨æ²¡æœ‰æœç´¢æ—¶æ˜¾ç¤ºï¼‰ -->\r\n\t\t<view v-if=\"drugList.length === 0 && !searchKeyword && !showSearchResult\" class=\"empty-state\">\r\n\t\t\t<text class=\"empty-icon\">ğŸ“¦</text>\r\n\t\t\t<text class=\"empty-text\">æš‚æ— è¯æ</text>\r\n\t\t\t<text class=\"empty-hint\">è¯·åœ¨ä¸Šæ–¹æœç´¢æ¡†æ‰«ç æˆ–æœç´¢æ·»åŠ è¯æ</text>\r\n\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t<!-- ç­¾ååŒºåŸŸï¼ˆä»…åœ¨æœ‰è¯ææ—¶æ˜¾ç¤ºï¼‰ -->\r\n\t<view v-if=\"drugList.length > 0\" class=\"signature-section\">\r\n\t\t<!-- åˆè®¡ä¿¡æ¯ -->\r\n\t\t<view class=\"summary-card\">\r\n\t\t\t<view class=\"summary-item\">\r\n\t\t\t\t<text class=\"summary-label\">å“ç§</text>\r\n\t\t\t\t<text class=\"summary-value\">{{ drugList.length }} ç§</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"summary-item\">\r\n\t\t\t\t<text class=\"summary-label\">æ€»æ•°é‡</text>\r\n\t\t\t\t<text class=\"summary-value\">{{ totalQuantity }}</text>\r\n\t\t\t</view>\r\n\t\t\t<view v-if=\"totalAmount > 0\" class=\"summary-item highlight\">\r\n\t\t\t\t<text class=\"summary-label\">æ€»é‡‘é¢</text>\r\n\t\t\t\t<text class=\"summary-value\">Â¥{{ formatAmount(totalAmount) }}</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t<!-- æ“ä½œå‘˜ç­¾å -->\r\n\t\t<view class=\"signature-card\">\r\n\t\t\t<view class=\"signature-header\">\r\n\t\t\t<text class=\"signature-title\">æ“ä½œå‘˜ç­¾å</text>\r\n\t\t\t\t<text class=\"required\">*</text>\r\n\t\t\t</view>\r\n\t\t<signature \r\n\t\t\tv-model=\"operatorSign\"\r\n\t\t\ttitle=\"æ“ä½œå‘˜ç­¾å\"\r\n\t\t></signature>\r\n\t</view>\r\n\t\t\r\n\t<!-- æäº¤æŒ‰é’® -->\r\n\t<view class=\"submit-btn-container\">\r\n\t\t<view class=\"submit-btn\" @tap=\"submit\">\r\n\t\t\t<view class=\"submit-icon\">âœ“</view>\r\n\t\t\t<text class=\"submit-text\">æäº¤å…¥åº“</text>\r\n\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport Signature from '@/components/signature/index.vue'\r\nimport Common from '@/utils/common.js'\r\n\r\nexport default {\r\n\tcomponents: {\r\n\t\tsignature: Signature\r\n\t},\r\n\t\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\t// åŸºæœ¬ä¿¡æ¯\r\n\t\t\trecordNo: '',\r\n\t\t\tcurrentDate: '',\r\n\t\t\toperator: '',\r\n\t\tremark: '',\r\n\t\t\tdrugList: [],\r\n\t\t\toperatorSign: '',\r\n\t\t\t\r\n\t\t// è¯ææœç´¢ç›¸å…³\r\n\t\t\tsearchKeyword: '',\r\n\t\t\tsearchFocused: false,\r\n\t\t\tshowSearchResult: false,\r\n\t\t\tsearchResults: [],\r\n\t\t\tsearchTimer: null,\r\n\t\t\tisSearchingAPI: false,\r\n\t\t\t\r\n\t\t\t// æ–°å»ºè¯æï¼ˆå†…è”è¡¨å•ï¼‰\r\n\t\t\tshowCreateForm: false,\r\n\t\t\tcreateFormSource: '',\r\n\t\t\tnewDrug: {\r\n\t\t\t\tname: '',\r\n\t\t\t\tspec: '',\r\n\t\t\t\tunit: '',\r\n\t\t\t\tbarcode: '',\r\n\t\t\t\tmanufacturer: '',\r\n\t\t\t\tapprovalNumber: ''\r\n\t\t\t},\r\n\t\t\tunitOptions: ['ç›’', 'ç“¶', 'è¢‹', 'æ”¯', 'æ¿', 'ç‰‡', 'ç²’', 'ä¸¸'],\r\n\t\t\tunitIndex: 0,\r\n\t\t\t\r\n\t\t\t// æ—¥æœŸèŒƒå›´\r\n\t\t\tminDate: '2020-01-01',\r\n\t\t\tmaxDate: '',\r\n\t\t\tmaxExpDate: '2035-12-31'\r\n\t\t}\r\n\t},\r\n\t\r\n\tcomputed: {\r\n\t\ttotalQuantity() {\r\n\t\t\treturn this.drugList.reduce((sum, item) => {\r\n\t\t\t\treturn sum + (Number(item.quantity) || 0)\r\n\t\t\t}, 0)\r\n\t\t},\r\n\t\t\r\n\t\ttotalAmount() {\r\n\t\t\treturn this.drugList.reduce((sum, item) => {\r\n\t\t\t\treturn sum + (Number(item.amount) || 0)\r\n\t\t\t}, 0)\r\n\t\t}\r\n\t},\r\n\t\r\n\tonLoad() {\r\n\t\tthis.initPage()\r\n\t},\r\n\t\r\n\tmethods: {\r\n\t\tinitPage() {\r\n\t\t\t// ç”Ÿæˆå…¥åº“å•å·\r\n\t\t\tthis.recordNo = Common.generateRecordNo('RK')\r\n\t\t\t\r\n\t\t\t// è·å–å½“å‰æ—¶é—´\r\n\t\t\tconst now = new Date()\r\n\t\t\tthis.currentDate = Common.formatDate(now)\r\n\t\t\tthis.maxDate = Common.formatDate(now)\r\n\t\t\t\r\n\t\t\t// è·å–å½“å‰ç”¨æˆ·\r\n\t\t\tconst userInfo = uni.getStorageSync('userInfo')\r\n\t\t\tthis.operator = userInfo?.name || 'æœªç™»å½•'\r\n\t\t},\r\n\t\t\r\n\t\t\r\n\t\t// ========== è¯ææœç´¢ç›¸å…³ ==========\r\n\t\tonSearchFocus() {\r\n\t\t\tthis.searchFocused = true\r\n\t\t\t// èšç„¦æœç´¢æ¡†æ—¶ï¼Œéšè—åˆ›å»ºè¡¨å•\r\n\t\t\tthis.showCreateForm = false\r\n\t\t\tif (this.searchKeyword) {\r\n\t\t\t\tthis.showSearchResult = true\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tonSearchBlur() {\r\n\t\t\tthis.searchFocused = false\r\n\t\t\t// å»¶è¿Ÿéšè—ï¼Œä»¥ä¾¿ç‚¹å‡»æœç´¢ç»“æœ\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.showSearchResult = false\r\n\t\t\t}, 200)\r\n\t\t},\r\n\t\t\r\n\t\tonSearchInput(e) {\r\n\t\t\tconst keyword = e.detail.value.trim()\r\n\t\t\t\r\n\t\t\tif (!keyword) {\r\n\t\t\t\tthis.searchResults = []\r\n\t\t\t\tthis.showSearchResult = false\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// é˜²æŠ–æœç´¢\r\n\t\t\tif (this.searchTimer) {\r\n\t\t\t\tclearTimeout(this.searchTimer)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.searchTimer = setTimeout(() => {\r\n\t\t\t\tthis.searchDrugs(keyword)\r\n\t\t\t}, 300)\r\n\t\t},\r\n\t\t\r\n\t\tonSearchConfirm() {\r\n\t\t\tif (this.searchKeyword.trim()) {\r\n\t\t\t\tthis.searchDrugs()\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// â­ æ™ºèƒ½æœç´¢ï¼šæœ¬åœ° â†’ NMPA â†’ æ‰‹åŠ¨åˆ›å»º\r\n\tasync searchDrugs(inputKeyword) {\r\n\t\tconst keyword = (inputKeyword || this.searchKeyword).trim()\r\n\t\tif (!keyword) return\r\n\t\t\r\n\t\ttry {\r\n\t\t\t// æ˜¾ç¤ºæœç´¢ä¸­çŠ¶æ€\r\n\t\t\tthis.isSearchingAPI = true\r\n\t\t\tthis.showSearchResult = false\r\n\t\t\t\r\n\t\t\t// è°ƒç”¨äº‘å‡½æ•°ï¼ˆå†…éƒ¨ä¼šå…ˆæŸ¥æœ¬åœ°ï¼Œæœ¬åœ°æ— åˆ™æŸ¥NMPAå¹¶ä¿å­˜ï¼‰\r\n\t\t\tconst result = await wx.cloud.callFunction({\r\n\t\t\t\tname: 'drugSearch',\r\n\t\t\t\tdata: { drugName: keyword }\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\tthis.isSearchingAPI = false\r\n\t\t\t\r\n\t\t\tif (result.result && result.result.success) {\r\n\t\t\t\t// æ‰¾åˆ°ç»“æœï¼ˆå¯èƒ½æ˜¯æœ¬åœ°æˆ–NMPAï¼‰\r\n\t\t\t\tconst drugs = result.result.data\r\n\t\t\t\t\r\n\t\t\t\t// æ ¼å¼åŒ–ä¸ºç»Ÿä¸€ç»“æ„\r\n\t\t\t\tthis.searchResults = drugs.map(drug => ({\r\n\t\t\t\t\t_id: drug._id || 'temp_' + Date.now(),\r\n\t\t\t\t\tname: drug.name,\r\n\t\t\t\t\tspec: drug.specification || '',\r\n\t\t\t\t\tspecification: drug.specification || '',\r\n\t\t\t\t\tunit: drug.unit || 'ç›’',\r\n\t\t\t\t\tpackUnit: drug.unit || 'ç›’',\r\n\t\t\t\t\tmanufacturer: drug.manufacturer || '',\r\n\t\t\t\t\tbarcode: drug.barcode || '',\r\n\t\t\t\t\tapprovalNumber: drug.approvalNumber || '',\r\n\t\t\t\t\tsource: drug.source || result.result.source\r\n\t\t\t\t}))\r\n\t\t\t\t\r\n\t\t\t\t// æ˜¾ç¤ºæœç´¢ç»“æœï¼Œéšè—åˆ›å»ºè¡¨å•\r\n\t\t\t\t\tthis.showSearchResult = true\r\n\t\t\t\t\tthis.showCreateForm = false\r\n\t\t\t\t\r\n\t\t\t\t// æ˜¾ç¤ºæ•°æ®æ¥æºæç¤º\r\n\t\t\t\tconst sourceText = {\r\n\t\t\t\t\t'local': 'æœ¬åœ°æ¡£æ¡ˆ',\r\n\t\t\t\t\t'nmpa': 'å›½å®¶è¯ç›‘å±€'\r\n\t\t\t\t}[result.result.source] || 'æ•°æ®åº“'\r\n\t\t\t\t\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: `æ‰¾åˆ° ${drugs.length} æ¡ (${sourceText})`,\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 1500\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t// æœªæ‰¾åˆ°ï¼Œæç¤ºæ‰‹åŠ¨åˆ›å»º\r\n\t\t\t\tthis.showSearchResult = false\r\n\t\t\t\t\tthis.activateCreateFormManual(keyword)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('æœç´¢å¤±è´¥:', err)\r\n\t\t\t\tthis.isSearchingAPI = false\r\n\t\t\t\t// å‡ºé”™ä¹Ÿæ¿€æ´»æ‰‹åŠ¨åˆ›å»º\r\n\t\t\t\tthis.activateCreateFormManual(keyword)\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// æ¿€æ´»åˆ›å»ºè¡¨å•ï¼ˆAPIæ•°æ®ï¼‰â­\r\n\t\tactivateCreateFormWithAPI(apiData) {\r\n\t\t\tthis.showCreateForm = true\r\n\t\t\tthis.createFormSource = 'api'\r\n\t\t\tthis.showSearchResult = false\r\n\t\t\t\r\n\t\t\t// è‡ªåŠ¨å¡«å……APIè¿”å›çš„æ•°æ®\r\n\t\t\tthis.newDrug = {\r\n\t\t\t\tname: apiData.name || '',\r\n\t\t\t\tspec: apiData.specification || apiData.spec || '',\r\n\t\t\t\tunit: apiData.unit || '',\r\n\t\t\t\tbarcode: apiData.barcode || '',\r\n\t\t\t\tmanufacturer: apiData.manufacturer || '',\r\n\t\t\t\tapprovalNumber: apiData.approvalNumber || ''\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// è®¾ç½®å•ä½é€‰æ‹©å™¨ç´¢å¼•\r\n\t\t\tconst unitIdx = this.unitOptions.indexOf(this.newDrug.unit)\r\n\t\t\tthis.unitIndex = unitIdx >= 0 ? unitIdx : 0\r\n\t\t\t\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: 'âœ… å·²ä»è¯ç›‘å±€è·å–æ•°æ®',\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 2000\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// æ¿€æ´»åˆ›å»ºè¡¨å•ï¼ˆæ‰‹åŠ¨ï¼‰â­\r\n\t\tactivateCreateFormManual(keyword) {\r\n\t\t\tthis.showCreateForm = true\r\n\t\t\tthis.createFormSource = 'manual'\r\n\t\t\tthis.showSearchResult = false\r\n\t\t\t\r\n\t\t\t// ä»…å¡«å……æœç´¢è¯\r\n\t\t\tthis.newDrug = {\r\n\t\t\t\tname: keyword,\r\n\t\t\t\tspec: '',\r\n\t\t\t\tunit: '',\r\n\t\t\t\tbarcode: '',\r\n\t\t\t\tmanufacturer: '',\r\n\t\t\t\tapprovalNumber: ''\r\n\t\t\t}\r\n\t\t\tthis.unitIndex = 0\r\n\t\t\t\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: 'ğŸ’¡ æœªæ‰¾åˆ°ï¼Œè¯·å®Œå–„ä¿¡æ¯',\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 2000\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\tclearSearch() {\r\n\t\t\tthis.searchKeyword = ''\r\n\t\t\tthis.searchResults = []\r\n\t\t\tthis.showSearchResult = false\r\n\t\t\tthis.showCreateForm = false\r\n\t\t\tthis.isSearchingAPI = false\r\n\t\t},\r\n\t\t\r\n\t\t// å–æ¶ˆåˆ›å»º\r\n\t\tcancelCreate() {\r\n\t\t\tthis.showCreateForm = false\r\n\t\t\tthis.newDrug = {\r\n\t\t\t\tname: '',\r\n\t\t\t\tspec: '',\r\n\t\t\t\tunit: '',\r\n\t\t\t\tbarcode: '',\r\n\t\t\t\tmanufacturer: '',\r\n\t\t\t\tapprovalNumber: ''\r\n\t\t\t}\r\n\t\t\tthis.unitIndex = 0\r\n\t\t},\r\n\t\t\r\n\t\t// ç¡®è®¤åˆ›å»ºå¹¶æ·»åŠ  â­â­â­\r\n\t\tasync confirmCreate() {\r\n\t\t\t// éªŒè¯å¿…å¡«é¡¹\r\n\t\t\tif (!this.newDrug.name || !this.newDrug.spec || !this.newDrug.unit) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'è¯·å¡«å†™å®Œæ•´ä¿¡æ¯',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tuni.showLoading({ title: 'åˆ›å»ºä¸­...', mask: true })\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconst db = wx.cloud.database()\r\n\t\t\t\t\r\n\t\t\t\t// 1. åˆ›å»ºè¯ææ¡£æ¡ˆ\r\n\t\t\t\tconst result = await db.collection('drugs').add({\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tname: this.newDrug.name,\r\n\t\t\t\t\t\tspec: this.newDrug.spec,\r\n\t\t\t\t\t\tspecification: this.newDrug.spec,  // å…¼å®¹å­—æ®µ\r\n\t\t\t\t\t\tpackUnit: this.newDrug.unit,\r\n\t\t\t\t\t\tunit: this.newDrug.unit,  // å…¼å®¹å­—æ®µ\r\n\t\t\t\t\t\tbarcode: this.newDrug.barcode || '',\r\n\t\t\t\t\t\tmanufacturer: this.newDrug.manufacturer || '',\r\n\t\t\t\t\t\tapprovalNumber: this.newDrug.approvalNumber || '',\r\n\t\t\t\t\t\tcreateTime: new Date(),\r\n\t\t\t\t\t\tcreateSource: this.createFormSource  // è®°å½•æ¥æºï¼šapi æˆ– manual\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\r\n\t\t\t\tif (result._id) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'âœ… åˆ›å»ºæˆåŠŸ',\r\n\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 2. è‡ªåŠ¨æ·»åŠ åˆ°å…¥åº“åˆ—è¡¨ â­â­â­\r\n\t\t\t\t\tconst newDrugItem = {\r\n\t\t\t\t\t\tdrugId: result._id,\r\n\t\t\t\t\t\tdrugName: this.newDrug.name,\r\n\t\t\t\t\t\tspecification: this.newDrug.spec,\r\n\t\t\t\t\t\tunit: this.newDrug.unit,\r\n\t\t\t\t\t\tmanufacturer: this.newDrug.manufacturer || '',\r\n\t\t\t\t\t\tbatch: '',\r\n\t\t\t\t\t\tproductionDate: '',\r\n\t\t\t\t\t\texpireDate: '',\r\n\t\t\t\t\t\tdaysToExpiry: null,\r\n\t\t\t\t\t\tquantity: '',\r\n\t\t\t\t\t\tprice: '',\r\n\t\t\t\t\t\tamount: '',\r\n\t\t\t\t\t\thasError: false\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ·»åŠ åˆ°åˆ—è¡¨æœ€å‰é¢ï¼ˆæ–°çš„åœ¨ä¸Šï¼‰\r\n\t\t\t\t\tthis.drugList.unshift(newDrugItem)\r\n\t\t\t\t\t\r\n\t\t\t\t\t// é‡ç½®è¡¨å•\r\n\t\t\t\t\tthis.cancelCreate()\r\n\t\t\t\t\tthis.searchKeyword = ''\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('åˆ›å»ºå¤±è´¥:', error)\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'åˆ›å»ºå¤±è´¥: ' + error.message,\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tselectDrug(drug) {\r\n\t\t\t// æ£€æŸ¥æ˜¯å¦å·²æ·»åŠ \r\n\t\t\tconst exists = this.drugList.some(item => item.drugId === drug._id)\r\n\t\t\tif (exists) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'è¯¥è¯æå·²æ·»åŠ ',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// è®°å½•å½“å‰æ»šåŠ¨ä½ç½®\r\n\t\t\tuni.createSelectorQuery().selectViewport().scrollOffset((res) => {\r\n\t\t\t\tconst currentScrollTop = res.scrollTop || 0\r\n\t\t\t\t\r\n\t\t\t\t// ç«‹å³æ¸…ç©ºæœç´¢å’Œéšè—ç»“æœ\r\n\t\tthis.searchKeyword = ''\r\n\t\tthis.searchResults = []\r\n\t\tthis.showSearchResult = false\r\n\t\tthis.showCreateForm = false\r\n\t\tthis.isSearchingAPI = false\r\n\t\t\r\n\t\t\t\t// ä½¿ç”¨nextTickç¡®ä¿DOMæ›´æ–°åå†æ·»åŠ è¯æ\r\n\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t// æ·»åŠ è¯æåˆ°åˆ—è¡¨é¡¶éƒ¨\r\n\t\t\tthis.drugList.unshift({\r\n\t\t\t\tdrugId: drug._id,\r\n\t\t\t\tdrugName: drug.name,\r\n\t\t\t\tspecification: drug.spec || drug.specification,\r\n\t\t\t\tunit: drug.packUnit || drug.unit || 'ç›’',\r\n\t\t\t\tmanufacturer: drug.manufacturer || '',\r\n\t\t\t\tbatch: '',\r\n\t\t\t\tproductionDate: '',\r\n\t\t\t\texpireDate: '',\r\n\t\t\t\tdaysToExpiry: null,\r\n\t\t\t\tquantity: '',\r\n\t\t\t\tprice: '',\r\n\t\t\t\tamount: 0,\r\n\t\t\t\thasError: false\r\n\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\t// ç«‹å³è¡¥å¿æ»šåŠ¨ä½ç½®ï¼ˆæ–°å¢è¯æå¡ç‰‡é«˜åº¦çº¦450rpxï¼‰\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\t\t\tscrollTop: currentScrollTop + uni.upx2px(450),\r\n\t\t\t\t\t\t\tduration: 0  // æ— åŠ¨ç”»ï¼Œç¬é—´å®Œæˆ\r\n\t\t\t\t\t\t})\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\t// ç”¨æˆ·åé¦ˆ\r\n\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'å·²æ·»åŠ åˆ°åˆ—è¡¨',\r\n\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\tduration: 1500\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\t// æŒ¯åŠ¨åé¦ˆ\r\n\t\t\twx.vibrateShort({ type: 'light' })\r\n\t\t})\r\n\t\t\t}).exec()\r\n\t\t},\r\n\t\t\r\n\t\t// ========== æ‰«ç ç›¸å…³ ==========\r\n\t\tasync scanBarcode() {\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\t// æ£€æŸ¥APIå‰©ä½™æ¬¡æ•°\r\n\t\t\t\tconst apiStats = await this.getAPIStats()\r\n\t\t\t\t\r\n\t\t\t\tif (apiStats.remaining === 0) {\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\ttitle: 'ğŸš« APIæ¬¡æ•°å·²ç”¨å®Œ',\r\n\t\t\t\t\t\tcontent: `ä»Šæ—¥APIè°ƒç”¨æ¬¡æ•°å·²è¾¾ä¸Šé™ (${apiStats.todayUsed}/${apiStats.limit})\\n\\nå»ºè®®ï¼š\\n1. æ‰‹åŠ¨æœç´¢è¯ææ¡£æ¡ˆ\\n2. æ–°å»ºè¯ææ¡£æ¡ˆ\\n3. ç­‰å¾…æ˜å¤©é‡ç½®`,\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// è­¦å‘Šæç¤º\r\n\t\t\t\tif (apiStats.critical) {\r\n\t\t\t\t\tconst res = await uni.showModal({\r\n\t\t\t\t\t\ttitle: 'âš ï¸ APIæ¬¡æ•°ä¸è¶³',\r\n\t\t\t\t\t\tcontent: `ä»Šæ—¥APIæ¬¡æ•°ä»…å‰© ${apiStats.remaining} æ¬¡\\n\\næ˜¯å¦ç»§ç»­æ‰«ç ï¼Ÿ`,\r\n\t\t\t\t\t\tconfirmText: 'ç»§ç»­',\r\n\t\t\t\t\t\tcancelText: 'å–æ¶ˆ'\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (!res.confirm) {\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// è°ƒç”¨å¾®ä¿¡å®˜æ–¹æ‰«ç API\r\n\t\t\t\tconst scanRes = await uni.scanCode({\r\n\t\t\t\t\t// æ”¯æŒçš„ç ç±»å‹\r\n\t\t\t\t\tscanType: [\r\n\t\t\t\t\t\t'barCode',    // æ¡å½¢ç ï¼ˆä¸€ç»´ç ï¼‰\r\n\t\t\t\t\t\t'qrCode',     // äºŒç»´ç \r\n\t\t\t\t\t\t'datamatrix', // Data Matrixç \r\n\t\t\t\t\t\t'pdf417'      // PDF417ç \r\n\t\t\t\t\t],\r\n\t\t\t\t\t// æ˜¯å¦åªèƒ½ä»ç›¸æœºæ‰«ç ï¼Œé»˜è®¤falseï¼ˆå¯ä»¥ä»ç›¸å†Œé€‰æ‹©ï¼‰\r\n\t\t\t\t\tonlyFromCamera: false,\r\n\t\t\t\t\t// æ˜¯å¦è‡ªåŠ¨è§£ç \r\n\t\t\t\t\tautoDecrypt: true\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('ğŸ“· æ‰«ç ç»“æœ:', scanRes)\r\n\t\t\t\tconsole.log('ğŸ“· æ¡å½¢ç :', scanRes.result)\r\n\t\t\t\tconsole.log('ğŸ“· æ¡å½¢ç ç±»å‹:', scanRes.scanType)\r\n\t\t\t\t\r\n\t\t\t\t// æ£€æŸ¥æ‰«ç ç»“æœ\r\n\t\t\t\tif (!scanRes || !scanRes.result) {\r\n\t\t\t\t\tconsole.error('âŒ æ‰«ç ç»“æœä¸ºç©º')\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'æ‰«ç å¤±è´¥ï¼Œè¯·é‡è¯•',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// æ¸…æ´—æ¡å½¢ç ï¼šå»é™¤ç©ºæ ¼ã€ç‰¹æ®Šå­—ç¬¦\r\n\t\t\t\tconst cleanBarcode = scanRes.result.trim().replace(/\\s/g, '')\r\n\t\t\t\tconsole.log('ğŸ“· æ¸…æ´—åæ¡å½¢ç :', cleanBarcode)\r\n\t\t\t\t\r\n\t\t\t\t// éªŒè¯æ¡å½¢ç æ ¼å¼\r\n\t\t\t\tif (!cleanBarcode || cleanBarcode.length < 8) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'æ¡å½¢ç æ ¼å¼é”™è¯¯',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tawait this.queryDrugByBarcode(cleanBarcode)\r\n\t\t\t\t\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('æ‰«ç é”™è¯¯:', err)\r\n\t\t\t\tif (err.errMsg && !err.errMsg.includes('cancel')) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'æ‰«ç å¤±è´¥',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tasync getAPIStats() {\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await wx.cloud.callFunction({\r\n\t\t\t\t\tname: 'drugBarcodeQuery',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'getUsageStats'\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif (result.result && result.result.success) {\r\n\t\t\t\t\treturn result.result.data\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('è·å–APIç»Ÿè®¡å¤±è´¥:', err)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn {\r\n\t\t\t\ttodayUsed: 0,\r\n\t\t\t\tremaining: 99,\r\n\t\t\t\tlimit: 99,\r\n\t\t\t\twarning: false,\r\n\t\t\t\tcritical: false\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tasync queryDrugByBarcode(barcode) {\r\n\t\t\tconsole.log('========================================')\r\n\t\t\tconsole.log('ğŸ” å¼€å§‹æŸ¥è¯¢æ¡å½¢ç :', barcode)\r\n\t\t\tconsole.log('========================================')\r\n\t\t\t\r\n\t\t\tuni.showLoading({ title: 'è¯†åˆ«ä¸­...', mask: true })\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\t// è°ƒç”¨äº‘å‡½æ•°æŸ¥è¯¢ï¼ˆä¼˜å…ˆæœ¬åœ°æ¡£æ¡ˆ â†’ APIæ¬¡æ•°æ£€æŸ¥ â†’ ç¬¬ä¸‰æ–¹APIï¼‰\r\n\t\t\t\tconsole.log('ğŸ“¡ è°ƒç”¨äº‘å‡½æ•°...')\r\n\t\t\t\tconst res = await wx.cloud.callFunction({\r\n\t\t\t\t\tname: 'drugBarcodeQuery',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'queryByBarcode',\r\n\t\t\t\t\t\tbarcode: barcode\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('ğŸ“¡ äº‘å‡½æ•°è¿”å›:', res)\r\n\t\t\t\tconsole.log('result.success:', res.result?.success)\r\n\t\t\t\tconsole.log('result.data:', res.result?.data)\r\n\t\t\t\t\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\r\n\t\t\t\tif (res.result && res.result.success) {\r\n\t\t\t\t\tconsole.log('âœ… æ‰¾åˆ°è¯æï¼')\r\n\t\t\t\t\t// æ‰¾åˆ°è¯æ\r\n\t\t\t\t\tconst drugInfo = res.result.data\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ£€æŸ¥æ˜¯å¦å·²æ·»åŠ \r\n\t\t\t\t\tconst exists = this.drugList.some(item => \r\n\t\t\t\t\t\titem.drugName === drugInfo.name && \r\n\t\t\t\t\t\titem.specification === drugInfo.specification\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (exists) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: 'è¯¥è¯æå·²æ·»åŠ ',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ·»åŠ åˆ°åˆ—è¡¨æœ€å‰é¢(æ–°çš„åœ¨ä¸Š)\r\n\t\t\t\t\tthis.drugList.unshift({\r\n\t\t\t\t\t\tdrugId: drugInfo.drugId || 'temp_' + Date.now(),\r\n\t\t\t\t\t\tdrugName: drugInfo.name,\r\n\t\t\t\t\t\tspecification: drugInfo.specification,\r\n\t\t\t\t\t\tunit: drugInfo.unit || 'ç›’',\r\n\t\t\t\t\t\tmanufacturer: drugInfo.manufacturer || '',\r\n\t\t\t\t\t\tbatch: '',\r\n\t\t\t\t\t\tproductionDate: '',\r\n\t\t\t\t\t\texpireDate: '',\r\n\t\t\t\t\t\tdaysToExpiry: null,\r\n\t\t\t\t\t\tquantity: '',\r\n\t\t\t\t\t\tprice: '',\r\n\t\t\t\t\t\tamount: 0,\r\n\t\t\t\t\t\thasError: false,\r\n\t\t\t\t\t\tisTemp: !drugInfo.drugId // æ ‡è®°æ˜¯å¦ä¸ºä¸´æ—¶è¯æ\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ˜¾ç¤ºæ•°æ®æ¥æº\r\n\t\t\t\t\tconst sourceText = {\r\n\t\t\t\t\t\t'local': 'æœ¬åœ°æ¡£æ¡ˆ',\r\n\t\t\t\t\t\t'api': 'APIæŸ¥è¯¢'\r\n\t\t\t\t\t}[res.result.source] || 'æ•°æ®åº“'\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: `âœ… å·²æ·»åŠ  (${sourceText})`,\r\n\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ˜¾ç¤ºAPIä½¿ç”¨æƒ…å†µ\r\n\t\t\t\t\tif (res.result.source === 'api' && res.result.apiStats) {\r\n\t\t\t\t\t\tconst stats = res.result.apiStats\r\n\t\t\t\t\t\tif (stats.warning) {\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: `âš ï¸ ä»Šæ—¥å‰©ä½™${stats.remaining}æ¬¡API`,\r\n\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}, 2000)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æŒ¯åŠ¨åé¦ˆ\r\n\t\t\t\t\twx.vibrateShort({ type: 'light' })\r\n\t\t\t\t\t\r\n\t\t\t\t} else if (res.result && res.result.reason === 'api_limit_exceeded') {\r\n\t\t\t\t\t// APIæ¬¡æ•°ä¸è¶³\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\ttitle: 'ğŸš« APIæ¬¡æ•°ä¸è¶³',\r\n\t\t\t\t\t\tcontent: res.result.message + '\\n\\n' + res.result.suggestion,\r\n\t\t\t\t\t\tconfirmText: 'æ‰‹åŠ¨æ–°å»º',\r\n\t\t\t\t\t\tcancelText: 'å–æ¶ˆ',\r\n\t\t\t\t\t\tsuccess: (modalRes) => {\r\n\t\t\t\t\t\t\tif (modalRes.confirm) {\r\n\t\t\t\t\t\t\t\tthis.newDrug.barcode = barcode\r\n\t\t\t\t\t\t\t\tthis.showCreateDrug = true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t// æœªæ‰¾åˆ°è¯æ - ç®€åŒ–å½•å…¥\r\n\t\t\t\tconsole.log('âŒ æœªæ‰¾åˆ°è¯æï¼Œäº‘å‡½æ•°è¿”å›:', res.result)\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\r\n\t\t\t\t// é€‰æ‹©å…³è”æ–¹å¼ï¼ˆåªæœ‰2ç§ï¼‰\r\n\t\t\t\tuni.showActionSheet({\r\n\t\t\t\t\ttitle: 'é¦–æ¬¡è¯†åˆ«æ­¤æ¡å½¢ç ',\r\n\t\t\t\t\titemList: ['ä»å·²æœ‰è¯æä¸­é€‰æ‹©', 'æ‰‹åŠ¨æ–°å»ºè¯æ'],\r\n\t\t\t\t\tsuccess: async (actionRes) => {\r\n\t\t\t\t\t\tif (actionRes.tapIndex === 0) {\r\n\t\t\t\t\t\t\t// ä»å·²æœ‰è¯æä¸­é€‰æ‹©\r\n\t\t\t\t\t\t\tawait this.selectExistingDrug(barcode)\r\n\t\t\t\t\t\t} else if (actionRes.tapIndex === 1) {\r\n\t\t\t\t\t\t\t// æ‰‹åŠ¨æ–°å»ºè¯æ\r\n\t\t\t\t\t\t\tthis.newDrug.barcode = barcode\r\n\t\t\t\t\t\t\tthis.showCreateDrug = true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} catch (err) {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tconsole.error('æŸ¥è¯¢å¤±è´¥:', err)\r\n\t\t\t\t\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: 'æŸ¥è¯¢å¤±è´¥',\r\n\t\t\t\t\tcontent: 'æ¡å½¢ç æŸ¥è¯¢å¤±è´¥ï¼Œæ˜¯å¦æ‰‹åŠ¨æ–°å»ºè¯æï¼Ÿ',\r\n\t\t\t\t\t\tconfirmText: 'æ–°å»º',\r\n\t\t\t\t\t\tcancelText: 'å–æ¶ˆ',\r\n\t\t\t\t\t\tsuccess: (modalRes) => {\r\n\t\t\t\t\t\t\tif (modalRes.confirm) {\r\n\t\t\t\t\t\t\t\tthis.newDrug.barcode = barcode\r\n\t\t\t\t\t\t\t\tthis.showCreateDrug = true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// åˆ›å»ºæ˜ å°„å¹¶æŸ¥è¯¢ï¼ˆé¦–æ¬¡å½•å…¥ï¼‰\r\n\t\tasync createMappingAndQuery(barcode, drugName) {\r\n\t\t\tuni.showLoading({ title: 'æŸ¥è¯¢ä¸­...', mask: true })\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log('ğŸ†• åˆ›å»ºæ˜ å°„å¹¶æŸ¥è¯¢NMPA...')\r\n\t\t\t\tconsole.log('æ¡å½¢ç :', barcode)\r\n\t\t\t\tconsole.log('è¯æåç§°:', drugName)\r\n\t\t\t\t\r\n\t\t\t\tconst res = await this.$api.callFunction({\r\n\t\t\t\t\tname: 'drugBarcodeQuery',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'createMappingAndQuery',\r\n\t\t\t\t\t\tbarcode: barcode,\r\n\t\t\t\t\t\tdrugName: drugName,\r\n\t\t\t\t\t\tspecification: '', // å¯é€‰ï¼Œç”¨æˆ·ç¨åå¡«å†™\r\n\t\t\t\t\t\tunit: 'ç›’'\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('äº‘å‡½æ•°è¿”å›:', res.result)\r\n\t\t\t\t\r\n\t\t\t\tif (res.result.success && res.result.data) {\r\n\t\t\t\t\tconst drug = res.result.data\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ·»åŠ åˆ°å…¥åº“åˆ—è¡¨\r\n\t\t\t\t\tthis.drugList.push({\r\n\t\t\t\t\t\tdrugId: null,\r\n\t\t\t\t\t\tbarcode: drug.barcode,\r\n\t\t\t\t\t\tname: drug.name,\r\n\t\t\t\t\t\tspecification: drug.specification || '',\r\n\t\t\t\t\t\tunit: drug.unit || 'ç›’',\r\n\t\t\t\t\t\tmanufacturer: drug.manufacturer || '',\r\n\t\t\t\t\t\tæ‰¹å·: '',\r\n\t\t\t\t\t\tæœ‰æ•ˆæœŸ: '',\r\n\t\t\t\t\t\tæ•°é‡: 1,\r\n\t\t\t\t\t\tå•ä»·: 0,\r\n\t\t\t\t\t\tapiSource: drug.apiSource\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'âœ… å½•å…¥æˆåŠŸ',\r\n\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ˜¾ç¤ºæç¤ºä¿¡æ¯\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: 'ä¸‹æ¬¡æ‰«ç å¯ç›´æ¥è¯†åˆ«',\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\tduration: 3000\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}, 2100)\r\n\t\t\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\ttitle: 'æç¤º',\r\n\t\t\t\t\t\tcontent: res.result.message || 'æŸ¥è¯¢å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•',\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} catch (err) {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tconsole.error('åˆ›å»ºæ˜ å°„å¤±è´¥:', err)\r\n\t\t\t\t\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: 'å½•å…¥å¤±è´¥',\r\n\t\t\t\t\tcontent: 'è‡ªåŠ¨å½•å…¥å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨æ–°å»ºè¯ææ¡£æ¡ˆ',\r\n\t\t\t\t\tconfirmText: 'æ–°å»ºæ¡£æ¡ˆ',\r\n\t\t\t\t\tcancelText: 'å–æ¶ˆ',\r\n\t\t\t\t\tsuccess: (modalRes) => {\r\n\t\t\t\t\t\tif (modalRes.confirm) {\r\n\t\t\t\t\t\t\tthis.newDrug.name = drugName\r\n\t\t\t\t\t\t\tthis.newDrug.barcode = barcode\r\n\t\t\t\t\t\t\tthis.showCreateDrug = true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// ä»å·²æœ‰è¯æä¸­é€‰æ‹©\r\n\t\tasync selectExistingDrug(barcode) {\r\n\t\t\tuni.showLoading({ title: 'åŠ è½½è¯æåˆ—è¡¨...', mask: true })\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\t// æŸ¥è¯¢æ‰€æœ‰è¯æ\r\n\t\t\t\tconst res = await this.$api.callFunction({\r\n\t\t\t\t\tname: 'drugSearch',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'getAllDrugs'\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\r\n\t\t\t\tif (res.result.success && res.result.data && res.result.data.length > 0) {\r\n\t\t\t\t\t// æ˜¾ç¤ºè¯æé€‰æ‹©å™¨\r\n\t\t\t\t\tconst drugNames = res.result.data.map(d => d.name)\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showActionSheet({\r\n\t\t\t\t\t\titemList: drugNames,\r\n\t\t\t\t\t\tsuccess: async (pickRes) => {\r\n\t\t\t\t\t\t\tconst selectedDrug = res.result.data[pickRes.tapIndex]\r\n\t\t\t\t\t\t\tconsole.log('é€‰æ‹©çš„è¯æ:', selectedDrug)\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// å…³è”æ¡å½¢ç åˆ°é€‰ä¸­çš„è¯æ\r\n\t\t\t\t\t\t\tawait this.linkBarcodeToDrug(barcode, selectedDrug)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'æš‚æ— è¯ææ¡£æ¡ˆ',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// æç¤ºæ‰‹åŠ¨æ–°å»º\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.newDrug.barcode = barcode\r\n\t\t\t\t\t\tthis.showCreateDrug = true\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} catch (err) {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tconsole.error('åŠ è½½è¯æå¤±è´¥:', err)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'åŠ è½½å¤±è´¥',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// å…³è”æ¡å½¢ç åˆ°ç°æœ‰è¯æ\r\n\t\tasync linkBarcodeToDrug(barcode, drug) {\r\n\t\t\tuni.showLoading({ title: 'å…³è”ä¸­...', mask: true })\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\t// æ›´æ–°è¯ææ¡£æ¡ˆï¼Œæ·»åŠ æ¡å½¢ç \r\n\t\t\t\tawait this.$api.callFunction({\r\n\t\t\t\t\tname: 'drugSearch',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'updateDrugBarcode',\r\n\t\t\t\t\t\tdrugId: drug._id,\r\n\t\t\t\t\t\tbarcode: barcode\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\t// ç›´æ¥åˆ›å»ºæ¡å½¢ç æ˜ å°„åˆ°æ•°æ®åº“ï¼ˆä¸éœ€è¦äº‘å‡½æ•°ï¼‰\r\n\t\t\t\tconst db = wx.cloud.database()\r\n\t\t\t\tawait db.collection('barcode_mapping').add({\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tbarcode: barcode,\r\n\t\t\t\t\t\tdrugName: drug.name,\r\n\t\t\t\t\t\tspecification: drug.specification || '',\r\n\t\t\t\t\t\tunit: drug.unit || 'ç›’',\r\n\t\t\t\t\t\tmanufacturer: drug.manufacturer || '',\r\n\t\t\t\t\t\tapprovalNumber: drug.approvalNumber || '',\r\n\t\t\t\t\t\tisPrescription: drug.isPrescription || false,\r\n\t\t\t\t\t\tprescriptionType: drug.prescriptionType || 'éå¤„æ–¹è¯',\r\n\t\t\t\t\t\tsource: 'manual',\r\n\t\t\t\t\t\tcreateTime: db.serverDate()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\r\n\t\t\t\t// æ·»åŠ åˆ°å…¥åº“åˆ—è¡¨\r\n\t\t\t\tthis.drugList.push({\r\n\t\t\t\t\tdrugId: drug._id,\r\n\t\t\t\t\tbarcode: barcode,\r\n\t\t\t\t\tname: drug.name,\r\n\t\t\t\t\tspecification: drug.specification || '',\r\n\t\t\t\t\tunit: drug.unit || 'ç›’',\r\n\t\t\t\t\tmanufacturer: drug.manufacturer || '',\r\n\t\t\t\t\tæ‰¹å·: '',\r\n\t\t\t\t\tæœ‰æ•ˆæœŸ: '',\r\n\t\t\t\t\tæ•°é‡: 1,\r\n\t\t\t\t\tå•ä»·: drug.price || 0\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'âœ… å…³è”æˆåŠŸ',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'ä¸‹æ¬¡æ‰«ç å¯ç›´æ¥è¯†åˆ«',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 1500)\r\n\t\t\t\t\r\n\t\t\t} catch (err) {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tconsole.error('å…³è”å¤±è´¥:', err)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'å…³è”å¤±è´¥',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// ========== æ–°å»ºè¯æ ==========\r\n\t\tonUnitChange(e) {\r\n\t\t\tthis.unitIndex = e.detail.value\r\n\t\t\tthis.newDrug.unit = this.unitOptions[e.detail.value]\r\n\t\t},\r\n\t\t\r\n\t\t// è¯­éŸ³è¾“å…¥æç¤ºï¼ˆä½¿ç”¨è¾“å…¥æ³•è¯­éŸ³åŠŸèƒ½ï¼‰\r\n\t\tstartVoiceInput(field) {\r\n\t\t\t// æ ¹æ®å­—æ®µæ˜¾ç¤ºä¸åŒæç¤º\r\n\t\t\tconst fieldNames = {\r\n\t\t\t\t'name': 'è¯æåç§°',\r\n\t\t\t\t'spec': 'è§„æ ¼'\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: 'ğŸ’¡ è¯­éŸ³è¾“å…¥æç¤º',\r\n\t\t\t\tcontent: `è¯·ä½¿ç”¨è¾“å…¥æ³•çš„è¯­éŸ³åŠŸèƒ½ï¼š\\n\\n1. ç‚¹å‡»${fieldNames[field]}è¾“å…¥æ¡†\\n2. ç‚¹å‡»é”®ç›˜ä¸Šçš„ğŸ¤å›¾æ ‡\\n3. è¯´å‡º${fieldNames[field]}\\n4. ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«å¹¶å¡«å…¥\\n\\nå¾®ä¿¡ã€æœç‹—ç­‰è¾“å…¥æ³•éƒ½æ”¯æŒè¯­éŸ³è¾“å…¥`,\r\n\t\t\t\tshowCancel: false,\r\n\t\t\t\tconfirmText: 'çŸ¥é“äº†'\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// ========== è¡¨å•æ“ä½œ ==========\r\n\t\tonDateChange(index, field, value) {\r\n\t\t\tthis.drugList[index][field] = value\r\n\t\t\t\r\n\t\t\t// è®¡ç®—è·æœ‰æ•ˆæœŸå¤©æ•°\r\n\t\t\tif (this.drugList[index].expireDate) {\r\n\t\t\t\tconst expDate = new Date(this.drugList[index].expireDate)\r\n\t\t\t\tconst today = new Date()\r\n\t\t\t\tconst days = Math.floor((expDate - today) / (1000 * 60 * 60 * 24))\r\n\t\t\t\tthis.drugList[index].daysToExpiry = days\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.validateRow(index)\r\n\t\t},\r\n\t\t\r\n\t\tcalculateAmount(index) {\r\n\t\t\tconst item = this.drugList[index]\r\n\t\t\tconst qty = Number(item.quantity) || 0\r\n\t\t\tconst price = Number(item.price) || 0\r\n\t\t\titem.amount = qty * price\r\n\t\t},\r\n\t\t\r\n\t\tvalidateRow(index) {\r\n\t\t\tconst item = this.drugList[index]\r\n\t\t\tlet hasError = false\r\n\t\t\t\r\n\t\t\tif (!item.batch || !item.productionDate || !item.expireDate || !item.quantity || item.quantity <= 0) {\r\n\t\t\t\thasError = true\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\titem.hasError = hasError\r\n\t\t},\r\n\t\t\r\n\t\tformatAmount(amount) {\r\n\t\t\tif (!amount) return '0.00'\r\n\t\t\treturn Number(amount).toFixed(2)\r\n\t\t},\r\n\t\t\r\n\t\tdeleteDrug(index) {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: 'ç¡®è®¤åˆ é™¤',\r\n\t\t\t\tcontent: 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè¯æå—ï¼Ÿ',\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\tthis.drugList.splice(index, 1)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// ========== æäº¤ ==========\r\n\t\tvalidateForm() {\r\n\t\t\tif (this.drugList.length === 0) {\r\n\t\t\t\tuni.showToast({ title: 'è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªè¯æ', icon: 'none' })\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (let i = 0; i < this.drugList.length; i++) {\r\n\t\t\t\tconst item = this.drugList[i]\r\n\t\t\t\tconst rowNum = i + 1\r\n\t\t\t\t\r\n\t\t\t\tif (!item.batch) {\r\n\t\t\t\t\tuni.showToast({ title: `ç¬¬${rowNum}è¡Œï¼šæ‰¹å·ä¸èƒ½ä¸ºç©º`, icon: 'none' })\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif (!item.productionDate) {\r\n\t\t\t\t\tuni.showToast({ title: `ç¬¬${rowNum}è¡Œï¼šç”Ÿäº§æ—¥æœŸä¸èƒ½ä¸ºç©º`, icon: 'none' })\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif (!item.expireDate) {\r\n\t\t\t\t\tuni.showToast({ title: `ç¬¬${rowNum}è¡Œï¼šæœ‰æ•ˆæœŸä¸èƒ½ä¸ºç©º`, icon: 'none' })\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif (item.daysToExpiry !== null && item.daysToExpiry < 0) {\r\n\t\t\t\t\tuni.showToast({ title: `ç¬¬${rowNum}è¡Œï¼šè¯æå·²è¿‡æœŸï¼Œä¸èƒ½å…¥åº“`, icon: 'none' })\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif (!item.quantity || item.quantity <= 0) {\r\n\t\t\t\t\tuni.showToast({ title: `ç¬¬${rowNum}è¡Œï¼šæ•°é‡å¿…é¡»å¤§äº0`, icon: 'none' })\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (!this.operatorSign) {\r\n\t\t\t\tuni.showToast({ title: 'è¯·å…ˆç­¾å', icon: 'none' })\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn true\r\n\t\t},\r\n\t\t\r\n\t\tasync submit() {\r\n\t\t\tif (!this.validateForm()) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tuni.showLoading({ title: 'æäº¤ä¸­...', mask: true })\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconst userInfo = uni.getStorageSync('userInfo')\r\n\t\t\t\t\r\n\t\t\t\tconst result = await wx.cloud.callFunction({\r\n\t\t\t\t\tname: 'inRecords',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'create',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\trecordNo: this.recordNo,\r\n\t\t\t\t\t\tremark: this.remark,\r\n\t\t\t\t\t\t\titems: this.drugList.map(item => ({\r\n\t\t\t\t\t\t\t\tdrugId: item.drugId,\r\n\t\t\t\t\t\t\t\tdrugName: item.drugName,\r\n\t\t\t\t\t\t\t\tspecification: item.specification,\r\n\t\t\t\t\t\t\t\tspec: item.specification,\r\n\t\t\t\t\t\t\t\tunit: item.unit,\r\n\t\t\t\t\t\t\t\tmanufacturer: item.manufacturer,\r\n\t\t\t\t\t\t\t\tbatch: item.batch,\r\n\t\t\t\t\t\t\t\tproductionDate: item.productionDate,\r\n\t\t\t\t\t\t\t\texpireDate: item.expireDate,\r\n\t\t\t\t\t\t\t\tquantity: Number(item.quantity),\r\n\t\t\t\t\t\t\t\tprice: Number(item.price) || 0\r\n\t\t\t\t\t\t\t})),\r\n\t\t\t\t\t\toperator: this.operator,\r\n\t\t\t\t\t\toperatorId: userInfo?._id || '',\r\n\t\t\t\t\t\toperatorSign: this.operatorSign,\r\n\t\t\t\t\t\toperatorSignTime: new Date().toISOString(),\r\n\t\t\t\t\t\tstatus: 'pending_review'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\r\n\t\t\t\tif (result.result && result.result.success) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'æäº¤æˆåŠŸï¼Œç­‰å¾…å¤æ ¸',\r\n\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tuni.navigateBack()\r\n\t\t\t\t\t}, 2000)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(result.result?.message || 'æäº¤å¤±è´¥')\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} catch (err) {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tconsole.error('æäº¤å¤±è´¥:', err)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: err.message || 'æäº¤å¤±è´¥',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.page {\r\n\tmin-height: 100vh;\r\n\t/* ä½¿ç”¨ä¸é¦–é¡µ/é—¨è¯Š/è¯æå·¥ä½œå°ä¸€è‡´çš„è“è‰²æ¸å˜èƒŒæ™¯ */\r\n\tbackground: linear-gradient(180deg, #00c9ff 0%, #00a0ff 35%, #e5e7eb 100%);\r\n\tpadding: 24rpx 24rpx 40rpx;\r\n}\r\n\r\n// é¡µé¢å¤´éƒ¨\r\n.page-header {\r\n\t/* é¡¶éƒ¨æ ‡é¢˜åŒºåŸŸï¼šè±¡ç‰™ç™½åœ†è§’å¡ç‰‡ï¼Œå®½åº¦ä¸å…¶å®ƒå·¥ä½œå° header-card å¯¹é½ */\r\n\tmax-width: 702rpx;\r\n\tmargin: 10rpx auto 8rpx;\r\n\tpadding: 30rpx 26rpx 26rpx;\r\n\tbackground: #FFFFF0;\r\n\tborder-radius: 22rpx;\r\n\tbox-shadow:\r\n\t\t0 1rpx 0 rgba(255, 255, 255, 0.9) inset,\r\n\t\t0 -1rpx 0 rgba(15, 23, 42, 0.06) inset,\r\n\t\t0 18rpx 40rpx rgba(15, 23, 42, 0.14);\r\n\t\r\n\t.header-content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\t\r\n\t\t.header-title {\r\n\t\t\tfont-size: 40rpx;\r\n\t\t\tfont-weight: bold;\r\n\t\t\tcolor: #111827;\r\n\t\t}\r\n\t\t\r\n\t\t.header-subtitle {\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #4b5563;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// ä¿¡æ¯å¡ç‰‡\r\n.info-card {\r\n\tmax-width: 702rpx;\r\n\tmargin: 0 auto 8rpx;\r\n\tpadding: 26rpx 26rpx 24rpx;\r\n\tbackground: #FFFFF0;\r\n\tborder-radius: 22rpx;\r\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\r\n\t\r\n\t.info-row {\r\n\t\tdisplay: flex;\r\n\t\tgap: 20rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\t\r\n\t\t&:last-child {\r\n\t\t\tmargin-bottom: 0;\r\n\t\t}\r\n\t\t\r\n\t\t.info-item {\r\n\t\t\tflex: 1;\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t\tgap: 12rpx;\r\n\t\t\t\r\n\t\t\t&.full {\r\n\t\t\t\tflex: 1 1 100%;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.label {\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tcolor: #646566;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.value {\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #323233;\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.input-value {\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #323233;\r\n\t\t\t\tborder-bottom: 1rpx solid #ebedf0;\r\n\t\t\t\tpadding: 8rpx 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// æ™ºèƒ½æœç´¢æ¡†\r\n.search-card {\r\n\tmax-width: 702rpx;\r\n\tmargin: 0 auto 4rpx;\r\n\tposition: relative;\r\n\tpadding-bottom: 8rpx;\r\n}\r\n\r\n.search-wrapper {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tbackground: #ffffff;\r\n\tborder-radius: 50rpx;\r\n\tpadding: 0 24rpx;\r\n\tbox-shadow: 0 2rpx 12rpx rgba(15, 23, 42, 0.06);\r\n\ttransition: all 0.3s;\r\n\t\r\n\t&.focused {\r\n\t\tbox-shadow: 0 4rpx 20rpx rgba(7, 193, 96, 0.15);\r\n\t\tborder: 2rpx solid #07C160;\r\n\t}\r\n\t\r\n\t.search-icon-wrapper {\r\n\t\tmargin-right: 16rpx;\r\n\t\t\r\n\t\t.search-icon {\r\n\t\t\tfont-size: 32rpx;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.search-input {\r\n\t\tflex: 1;\r\n\t\theight: 88rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #323233;\r\n\t}\r\n\t\r\n\t.clear-icon {\r\n\t\twidth: 40rpx;\r\n\t\theight: 40rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tmargin-right: 16rpx;\r\n\t\t\r\n\t\ttext {\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #969799;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.scan-btn {\r\n\t\twidth: 56rpx;\r\n\t\theight: 56rpx;\r\n\t\tbackground: linear-gradient(135deg, #00c9ff 0%, #00a0ff 100%);\r\n\t\tborder-radius: 50%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\ttransition: all 0.3s ease;\r\n\t\tbox-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.04);\r\n\t\t\r\n\t\t&:active {\r\n\t\t\ttransform: scale(0.95);\r\n\t\t\tbox-shadow: 0 1rpx 4rpx rgba(0, 0, 0, 0.2);\r\n\t\t}\r\n\t\t\r\n\t\t.scan-icon-frame {\r\n\t\t\twidth: 24rpx;\r\n\t\t\theight: 24rpx;\r\n\t\t\tposition: relative;\r\n\t\t\tbackground: \r\n\t\t\t\tlinear-gradient(#fff, #fff) 0 0 / 3rpx 10rpx,\r\n\t\t\t\tlinear-gradient(#fff, #fff) 0 0 / 10rpx 3rpx,\r\n\t\t\t\tlinear-gradient(#fff, #fff) 100% 0 / 3rpx 10rpx,\r\n\t\t\t\tlinear-gradient(#fff, #fff) 100% 0 / 10rpx 3rpx,\r\n\t\t\t\tlinear-gradient(#fff, #fff) 0 100% / 3rpx 10rpx,\r\n\t\t\t\tlinear-gradient(#fff, #fff) 0 100% / 10rpx 3rpx,\r\n\t\t\t\tlinear-gradient(#fff, #fff) 100% 100% / 3rpx 10rpx,\r\n\t\t\t\tlinear-gradient(#fff, #fff) 100% 100% / 10rpx 3rpx;\r\n\t\t\tbackground-repeat: no-repeat;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// æœç´¢ç»“æœ\r\n.search-results {\r\n\tposition: absolute;\r\n\ttop: 100%;\r\n\tleft: 0;\r\n\tright: 0;\r\n\tbackground: white;\r\n\tborder-radius: 16rpx;\r\n\tmargin-top: 12rpx;\r\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\r\n\tmax-height: 0;\r\n\toverflow: hidden;\r\n\tz-index: 100;\r\n\topacity: 0;\r\n\ttransition: max-height 0.25s cubic-bezier(0.4, 0, 0.2, 1), \r\n\t            opacity 0.2s ease-out,\r\n\t            transform 0.25s cubic-bezier(0.4, 0, 0.2, 1);\r\n\ttransform: translateY(-10rpx);\r\n\t\r\n\t&.show {\r\n\tmax-height: 600rpx;\r\n\t\topacity: 1;\r\n\toverflow-y: auto;\r\n\t\ttransform: translateY(0);\r\n\t}\r\n\t\r\n\t.result-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 24rpx 30rpx;\r\n\t\tborder-bottom: 1rpx solid #ebedf0;\r\n\t\t\r\n\t\t&:last-child {\r\n\t\t\tborder-bottom: none;\r\n\t\t}\r\n\t\t\r\n\t\t&:active {\r\n\t\t\tbackground: #f7f8fa;\r\n\t\t}\r\n\t\t\r\n\t\t.drug-info {\r\n\t\t\tflex: 1;\r\n\t\t\t\r\n\t\t\t.drug-name {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #323233;\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t\tmargin-bottom: 8rpx;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.drug-spec {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tcolor: #969799;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t.select-icon {\r\n\t\t\tfont-size: 40rpx;\r\n\t\t\tcolor: #c8c9cc;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// APIæœç´¢ä¸­\r\n.api-searching {\r\n\tposition: absolute;\r\n\ttop: 100%;\r\n\tleft: 0;\r\n\tright: 0;\r\n\tbackground: white;\r\n\tborder-radius: 16rpx;\r\n\tmargin-top: 12rpx;\r\n\tpadding: 40rpx 30rpx;\r\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\r\n\ttext-align: center;\r\n\tz-index: 100;\r\n\t\r\n\t.loading-wrapper {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 16rpx;\r\n\t\t\r\n\t\t.loading-icon {\r\n\t\t\tfont-size: 48rpx;\r\n\t\t\tanimation: rotate 2s linear infinite;\r\n\t\t}\r\n\t\t\r\n\t\t.loading-text {\r\n\t\t\tfont-size: 26rpx;\r\n\t\t\tcolor: #969799;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n@keyframes rotate {\r\n\tfrom { transform: rotate(0deg); }\r\n\tto { transform: rotate(360deg); }\r\n}\r\n\r\n// å†…è”åˆ›å»ºè¡¨å•\r\n.create-form-inline {\r\n\tposition: absolute;\r\n\ttop: 100%;\r\n\tleft: 0;\r\n\tright: 0;\r\n\tbackground: white;\r\n\tborder-radius: 16rpx;\r\n\tmargin-top: 12rpx;\r\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\r\n\tz-index: 100;\r\n\tanimation: slideDown 0.3s ease;\r\n\t\r\n\t.create-tip {\r\n\t\tdisplay: flex;\r\n\t\talign-items: flex-start;\r\n\t\tgap: 16rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tborder-radius: 16rpx 16rpx 0 0;\r\n\t\t\r\n\t\t&.tip-success {\r\n\t\t\tbackground: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);\r\n\t\t}\r\n\t\t\r\n\t\t&.tip-warning {\r\n\t\t\tbackground: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);\r\n\t\t}\r\n\t\t\r\n\t\t.tip-icon {\r\n\t\t\tfont-size: 40rpx;\r\n\t\t}\r\n\t\t\r\n\t\t.tip-content {\r\n\t\t\tflex: 1;\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t\tgap: 8rpx;\r\n\t\t\t\r\n\t\t\t.tip-title {\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t\tcolor: #323233;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.tip-subtitle {\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tcolor: #969799;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t.inline-form {\r\n\t\tpadding: 30rpx;\r\n\t\t\r\n\t\t.inline-form-title {\r\n\t\t\tfont-size: 30rpx;\r\n\t\t\tfont-weight: bold;\r\n\t\t\tcolor: #323233;\r\n\t\t\tmargin-bottom: 24rpx;\r\n\t\t}\r\n\t\t\r\n\t\t.inline-form-item {\r\n\t\t\tmargin-bottom: 24rpx;\r\n\t\t\t\r\n\t\t\t.inline-label {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\tcolor: #646566;\r\n\t\t\t\tmargin-bottom: 12rpx;\r\n\t\t\t\t\r\n\t\t\t\t.required {\r\n\t\t\t\t\tcolor: #ee0a24;\r\n\t\t\t\t\tmargin-left: 4rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.inline-input {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 80rpx;\r\n\t\t\t\tpadding: 0 20rpx;\r\n\t\t\t\tbackground: #f7f8fa;\r\n\t\t\t\tborder-radius: 12rpx;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #323233;\r\n\t\t\t\tborder: 2rpx solid transparent;\r\n\t\t\t\ttransition: all 0.3s;\r\n\t\t\t\t\r\n\t\t\t\t&:focus {\r\n\t\t\t\t\tbackground: white;\r\n\t\t\t\t\tborder-color: #07C160;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// è¯­éŸ³è¾“å…¥å®¹å™¨\r\n\t\t\t.input-with-voice {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: 16rpx;\r\n\t\t\t\t\r\n\t\t\t\t.voice-input {\r\n\t\t\t\t\tflex: 1;\r\n\t\t\t\t\twidth: auto;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.voice-btn {\r\n\t\t\t\t\tflex-shrink: 0;\r\n\t\t\t\t\twidth: 80rpx;\r\n\t\t\t\t\theight: 80rpx;\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\t\t\t\t\tborder-radius: 12rpx;\r\n\t\t\t\t\tbox-shadow: 0 4rpx 12rpx rgba(102, 126, 234, 0.3);\r\n\t\t\t\t\ttransition: all 0.3s;\r\n\t\t\t\t\t\r\n\t\t\t\t\t&:active {\r\n\t\t\t\t\t\ttransform: scale(0.95);\r\n\t\t\t\t\t\tbox-shadow: 0 2rpx 8rpx rgba(102, 126, 234, 0.4);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t.voice-icon {\r\n\t\t\t\t\t\tfont-size: 36rpx;\r\n\t\t\t\t\t\tfilter: brightness(0) invert(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.inline-picker {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\theight: 80rpx;\r\n\t\t\t\tpadding: 0 20rpx;\r\n\t\t\t\tbackground: #f7f8fa;\r\n\t\t\t\tborder-radius: 12rpx;\r\n\t\t\t\t\r\n\t\t\t\t.picker-text {\r\n\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\tcolor: #323233;\r\n\t\t\t\t\t\r\n\t\t\t\t\t&.picker-placeholder {\r\n\t\t\t\t\t\tcolor: #c8c9cc;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.picker-arrow {\r\n\t\t\t\t\tfont-size: 20rpx;\r\n\t\t\t\t\tcolor: #969799;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t.inline-form-actions {\r\n\t\t\tdisplay: flex;\r\n\t\t\tgap: 20rpx;\r\n\t\t\tmargin-top: 32rpx;\r\n\t\t\t\r\n\t\t\t.inline-btn {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\theight: 88rpx;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\tborder-radius: 44rpx;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t\t\r\n\t\t\t\t&.btn-cancel {\r\n\t\t\t\t\tbackground: #f7f8fa;\r\n\t\t\t\t\tcolor: #646566;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t&.btn-confirm {\r\n\t\t\t\t\tbackground: linear-gradient(135deg, #07C160 0%, #05a550 100%);\r\n\t\t\t\t\tcolor: white;\r\n\t\t\t\t\tbox-shadow: 0 4rpx 12rpx rgba(7, 193, 96, 0.3);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n@keyframes slideDown {\r\n\tfrom {\r\n\t\topacity: 0;\r\n\t\ttransform: translateY(-20rpx);\r\n\t}\r\n\tto {\r\n\t\topacity: 1;\r\n\t\ttransform: translateY(0);\r\n\t}\r\n}\r\n\r\n// è¯æåˆ—è¡¨\r\n.drug-list-section {\r\n\tmax-width: 702rpx;\r\n\tmargin: 0 auto;\r\n\ttransition: all 0.3s ease;\r\n}\r\n\r\n.section-header {\r\n\tmax-width: 702rpx;\r\n\tmargin: 0 auto 8rpx;\r\n\tpadding: 18rpx 22rpx;\r\n\tbackground: #FFFFF0;\r\n\tborder-radius: 22rpx;\r\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\t\r\n\t.section-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #111827;\r\n\t}\r\n\t\r\n\t.section-count {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #4b5563;\r\n\t\tpadding: 6rpx 16rpx;\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 999rpx;\r\n\t}\r\n}\r\n\r\n.drug-cards {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 0;\r\n}\r\n\r\n.drug-card {\r\n\tmax-width: 702rpx;\r\n\tmargin: 0 auto 8rpx;\r\n\tpadding: 24rpx;\r\n\tbackground: #FFFFF0;\r\n\tborder-radius: 22rpx;\r\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\r\n\t\r\n\t// æ·»åŠ å¹³æ»‘çš„å…¥åœºåŠ¨ç”»\r\n\tanimation: slideInFromTop 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);\r\n\t\r\n\t&.has-error {\r\n\t\tborder-left: 4rpx solid #ee0a24;\r\n\t}\r\n}\r\n\r\n// ä»é¡¶éƒ¨æ»‘å…¥çš„åŠ¨ç”»\r\n@keyframes slideInFromTop {\r\n\t0% {\r\n\t\topacity: 0;\r\n\t\ttransform: translateY(-20rpx);\r\n\t}\r\n\t100% {\r\n\t\topacity: 1;\r\n\t\ttransform: translateY(0);\r\n\t}\r\n}\r\n\r\n.card-header {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: flex-start;\r\n\tmargin-bottom: 20rpx;\r\n\tpadding-bottom: 20rpx;\r\n\tborder-bottom: 1rpx solid #ebedf0;\r\n\t\r\n\t.drug-name-wrapper {\r\n\t\tflex: 1;\r\n\t\t\r\n\t\t.drug-name {\r\n\t\t\tdisplay: block;\r\n\t\t\tfont-size: 30rpx;\r\n\t\t\tfont-weight: bold;\r\n\t\t\tcolor: #323233;\r\n\t\t\tmargin-bottom: 8rpx;\r\n\t\t}\r\n\t\t\r\n\t\t.drug-spec {\r\n\t\t\tdisplay: block;\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #646566;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.delete-btn {\r\n\t\twidth: 48rpx;\r\n\t\theight: 48rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbackground: #f7f8fa;\r\n\t\tborder-radius: 50%;\r\n\t\t\r\n\t\t.delete-icon {\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\tcolor: #ee0a24;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n.card-form {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 20rpx;\r\n}\r\n\r\n.form-item {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 12rpx;\r\n\t\r\n\t&.half {\r\n\t\tflex: 1;\r\n\t}\r\n\t\r\n\t&.third {\r\n\t\tflex: 1;\r\n\t\tmin-width: 0; // é˜²æ­¢å†…å®¹æº¢å‡º\r\n\t}\r\n\t\r\n\t.form-label {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #646566;\r\n\t\t\r\n\t\t.required {\r\n\t\t\tcolor: #ee0a24;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.form-input {\r\n\t\theight: 72rpx;\r\n\t\tpadding: 0 24rpx;\r\n\t\tbackground: #f7f8fa;\r\n\t\tborder-radius: 12rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #323233;\r\n\t\tborder: 2rpx solid transparent;\r\n\t\t\r\n\t\t&:focus {\r\n\t\t\tbackground: white;\r\n\t\t\tborder-color: #07C160;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.picker-input {\r\n\t\theight: 72rpx;\r\n\t\tpadding: 0 24rpx;\r\n\t\tbackground: #f7f8fa;\r\n\t\tborder-radius: 12rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #c8c9cc;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\t\r\n\t\t&.has-value {\r\n\t\t\tcolor: #323233;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.input-with-unit {\r\n\t\tposition: relative;\r\n\t\t\r\n\t\t.form-input {\r\n\t\t\tpadding-right: 80rpx;\r\n\t\t}\r\n\t\t\r\n\t\t.unit-text {\r\n\t\t\tposition: absolute;\r\n\t\t\tright: 24rpx;\r\n\t\t\ttop: 50%;\r\n\t\t\ttransform: translateY(-50%);\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #969799;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n.form-row {\r\n\tdisplay: flex;\r\n\tgap: 20rpx;\r\n\talign-items: flex-end; // è®©è·æœ‰æ•ˆæœŸæ ‡ç­¾åº•éƒ¨å¯¹é½\r\n\tflex-wrap: wrap; // å°å±å¹•æ—¶å…è®¸æ¢è¡Œ\r\n}\r\n\r\n.expiry-badge {\r\n\tdisplay: inline-flex;\r\n\talign-items: center;\r\n\tpadding: 8rpx 16rpx;\r\n\tborder-radius: 8rpx;\r\n\tfont-size: 22rpx;\r\n\tfont-weight: 500;\r\n\t\r\n\t&.safe {\r\n\t\tbackground: #d1fae5;\r\n\t\tcolor: #065f46;\r\n\t}\r\n\t\r\n\t&.warning {\r\n\t\tbackground: #fef3c7;\r\n\t\tcolor: #92400e;\r\n\t}\r\n\t\r\n\t&.danger {\r\n\t\tbackground: #fee2e2;\r\n\t\tcolor: #991b1b;\r\n\t}\r\n\t\r\n\t&.expired {\r\n\t\tbackground: #fee2e2;\r\n\t\tcolor: #991b1b;\r\n\t}\r\n}\r\n\r\n// è¡Œå†…æ˜¾ç¤ºçš„è·æœ‰æ•ˆæœŸæ ‡ç­¾\r\n.expiry-badge-inline {\r\n\tdisplay: inline-flex;\r\n\talign-items: center;\r\n\tpadding: 8rpx 16rpx;\r\n\tborder-radius: 8rpx;\r\n\tfont-size: 22rpx;\r\n\tfont-weight: 500;\r\n\tmargin-bottom: 12rpx; // ä¸è¾“å…¥æ¡†åº•éƒ¨å¯¹é½\r\n\twhite-space: nowrap; // ä¸æ¢è¡Œ\r\n\t\r\n\t&.safe {\r\n\t\tbackground: #d1fae5;\r\n\t\tcolor: #065f46;\r\n\t}\r\n\t\r\n\t&.warning {\r\n\t\tbackground: #fef3c7;\r\n\t\tcolor: #92400e;\r\n\t}\r\n\t\r\n\t&.danger {\r\n\t\tbackground: #fee2e2;\r\n\t\tcolor: #991b1b;\r\n\t}\r\n\t\r\n\t&.expired {\r\n\t\tbackground: #fee2e2;\r\n\t\tcolor: #991b1b;\r\n\t}\r\n}\r\n\r\n.amount-display {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 8rpx;\r\n\tpadding: 16rpx 24rpx;\r\n\tbackground: #f7f8fa;\r\n\tborder-radius: 12rpx;\r\n\t\r\n\t.amount-label {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #646566;\r\n\t}\r\n\t\r\n\t.amount-value {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #ee0a24;\r\n\t\tfont-weight: bold;\r\n\t}\r\n}\r\n\r\n// ç©ºçŠ¶æ€\r\n.empty-state {\r\n\ttext-align: center;\r\n\tpadding: 100rpx 0;\r\n\t\r\n\t.empty-icon {\r\n\t\tfont-size: 100rpx;\r\n\t\tdisplay: block;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.empty-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #969799;\r\n\t\tdisplay: block;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t.empty-hint {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #c8c9cc;\r\n\t\tdisplay: block;\r\n\t}\r\n}\r\n\r\n// ç­¾ååŒºåŸŸï¼ˆåŒ…å«åˆè®¡å’Œç­¾åï¼‰\r\n.signature-section {\r\n\tmax-width: 702rpx;\r\n\tmargin: 0 auto 8rpx;\r\n\tpadding-bottom: 0;\r\n}\r\n\r\n// åˆè®¡å¡ç‰‡\r\n.summary-card {\r\n\tmax-width: 702rpx;\r\n\tmargin: 0 auto 8rpx;\r\n\tpadding: 24rpx 26rpx;\r\n\tbackground: #FFFFF0;\r\n\tborder-radius: 22rpx;\r\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\r\n\tdisplay: flex;\r\n\tjustify-content: space-around;\r\n\t\r\n\t.summary-item {\r\n\t\ttext-align: center;\r\n\t\t\r\n\t\t.summary-label {\r\n\t\t\tdisplay: block;\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #6b7280;\r\n\t\t\tmargin-bottom: 12rpx;\r\n\t\t}\r\n\t\t\r\n\t\t.summary-value {\r\n\t\t\tdisplay: block;\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\tfont-weight: bold;\r\n\t\t\tcolor: #111827;\r\n\t\t}\r\n\t\t\r\n\t\t&.highlight .summary-value {\r\n\t\t\tfont-size: 36rpx;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// ç­¾åå¡ç‰‡\r\n.signature-card {\r\n\tmax-width: 702rpx;\r\n\tmargin: 0 auto 8rpx;\r\n\tpadding: 30rpx;\r\n\tbackground: white;\r\n\tborder-radius: 22rpx;\r\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\r\n\tborder: 2rpx solid #ebedf0;\r\n\t\r\n\t.signature-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\t\r\n\t\t.signature-title {\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tfont-weight: bold;\r\n\t\t\tcolor: #323233;\r\n\t\t}\r\n\t\t\r\n\t\t.required {\r\n\t\t\tcolor: #ee0a24;\r\n\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n// æäº¤æŒ‰é’®å®¹å™¨\r\n.submit-btn-container {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\tpadding: 0 30rpx 20rpx;\r\n\t\t\r\n\t.submit-btn {\r\n\t\t\twidth: 100%;\r\n\t\theight: 88rpx;\r\n\t\tbackground: linear-gradient(135deg, #07C160 0%, #05a550 100%);\r\n\t\tborder-radius: 50rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: center;\r\n\t\tgap: 12rpx;\r\n\t\tbox-shadow: 0 4rpx 16rpx rgba(7, 193, 96, 0.25);\r\n\t\tposition: relative;\r\n\t\toverflow: hidden;\r\n\t\t\r\n\t\t// å¾®ä¿¡é£æ ¼çš„å…‰æ³½æ•ˆæœ\r\n\t\t&::before {\r\n\t\t\tcontent: '';\r\n\t\t\tposition: absolute;\r\n\t\t\ttop: 0;\r\n\tleft: 0;\r\n\tright: 0;\r\n\t\t\theight: 50%;\r\n\t\t\tbackground: linear-gradient(180deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0) 100%);\r\n\t\t\tborder-radius: 50rpx 50rpx 0 0;\r\n}\r\n\r\n\t\t.submit-icon {\r\n\t\t\twidth: 48rpx;\r\n\t\t\theight: 48rpx;\r\n\t\t\tbackground: rgba(255, 255, 255, 0.2);\r\n\t\t\tborder-radius: 50%;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\tcolor: white;\r\n\t\t\tfont-weight: bold;\r\n\t\t\tz-index: 1;\r\n\t\t}\r\n\t\t\r\n\t\t.submit-text {\r\n\t\t\tcolor: white;\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\tfont-weight: 500;\r\n\t\t\tz-index: 1;\r\n\t}\r\n\t\r\n\t&:active {\r\n\t\ttransform: scale(0.98);\r\n\t\t\tbox-shadow: 0 2rpx 8rpx rgba(7, 193, 96, 0.3);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// å ä½ç¬¦æ ·å¼\r\n.placeholder {\r\n\tcolor: #c8c9cc;\r\n}\r\n</style>\r\n","import mod from \"-!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add.vue?vue&type=style&index=0&id=58f3a51d&lang=scss&scoped=true&\"; export default mod; export * from \"-!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add.vue?vue&type=style&index=0&id=58f3a51d&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1766576738246\n      var cssReload = require(\"F:/googleä¸‹è½½èµ„æ–™/HBuilderX.4.84.2025110307/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}