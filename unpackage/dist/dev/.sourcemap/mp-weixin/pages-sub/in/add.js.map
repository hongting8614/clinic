{"version":3,"sources":["uni-app:///main.js",null,"webpack:///D:/AK-PMS/pages-sub/in/add.vue?6aee","webpack:///D:/AK-PMS/pages-sub/in/add.vue?cd25","webpack:///D:/AK-PMS/pages-sub/in/add.vue?10b2","uni-app:///pages-sub/in/add.vue","webpack:///D:/AK-PMS/pages-sub/in/add.vue?484a","webpack:///D:/AK-PMS/pages-sub/in/add.vue?d16f"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","signature","data","recordNo","currentDate","operator","remark","drugList","operatorSign","searchKeyword","searchFocused","showSearchResult","searchResults","searchTimer","isSearchingAPI","showCreateForm","createFormSource","newDrug","name","spec","unit","barcode","manufacturer","approvalNumber","unitOptions","unitIndex","minDate","maxDate","maxExpDate","computed","totalQuantity","totalAmount","onLoad","methods","initPage","onSearchFocus","onSearchBlur","setTimeout","onSearchInput","clearTimeout","onSearchConfirm","searchDrugs","keyword","drugName","result","drugs","_id","specification","packUnit","uni","title","icon","duration","console","activateCreateFormManual","clearSearch","cancelCreate","confirmCreate","mask","db","createTime","createSource","source","newDrugItem","drugId","batch","productionDate","expireDate","daysToExpiry","quantity","price","amount","hasError","selectDrug","scrollTop","type","scanBarcode","scanType","onlyFromCamera","autoDecrypt","scanRes","cleanBarcode","queryDrugByBarcode","action","res","drugInfo","exists","item","sourceText","content","confirmText","cancelText","success","onUnitChange","startVoiceInput","showCancel","onDateChange","calculateAmount","validateRow","formatAmount","deleteDrug","validateForm","submit","userInfo","items","operatorId","operatorSignTime","status"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,YAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA4H;AAC5H;AACuD;AACL;AACsC;;;AAGxF;AAC0K;AAC1K,gBAAgB,uLAAU;AAC1B,EAAE,yEAAM;AACR,EAAE,0FAAM;AACR,EAAE,mGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,8FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,kLAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC5FA;AAAA;AAAA;AAAA;AAAmoB,CAAgB,+pBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;ACqVvpB;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eAEA;EACAC;IACAC;EACA;EAEAC;IACA;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IACAC;MACA;QACA;MACA;IACA;IAEAC;MACA;QACA;MACA;IACA;EACA;EAEAC;IACA;EACA;EAEAC;IACAC;MACA;MACA;;MAEA;MACA;MACA;MACA;;MAEA;MACA;MACA;IACA;IAGA;IACAC;MACA;MACA;MACA;MACA;QACA;MACA;IACA;IAEAC;MAAA;MACA;MACA;MACAC;QACA;MACA;IACA;IAEAC;MAAA;MACA;MAEA;QACA;QACA;QACA;MACA;;MAEA;MACA;QACAC;MACA;MAEA;QACA;MACA;IACA;IAEAC;MACA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAC;gBAAA,IACAA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAGA;gBACA;gBACA;;gBAEA;gBAAA;gBAAA,OACA/C;kBACAuB;kBACAhB;oBAAAyC;kBAAA;gBACA;cAAA;gBAHAC;gBAKA;gBAEA;kBACA;kBACAC,4BAEA;kBACA;oBAAA;sBACAC;sBACA5B;sBACAC;sBACA4B;sBACA3B;sBACA4B;sBACA1B;sBACAD;sBACAE;oBACA;kBAAA;;kBAEA;kBACA;kBACA;kBAEA0B;oBACAC;oBACAC;oBACAC;kBACA;gBAEA;kBACA;kBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAC;gBACA;gBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAC;MACA;MACA;MACA;;MAEA;MACA;QACApC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACA;MAEA0B;QACAC;QACAC;QACAC;MACA;IACA;IAEAG;MACA;MACA;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;QACAtC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACA;IACA;IAEA;IACAkC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,MAEA;kBAAA;kBAAA;gBAAA;gBACAR;kBACAC;kBACAC;gBACA;gBAAA;cAAA;gBAIAF;kBAAAC;kBAAAQ;gBAAA;gBAAA;gBAGAC,0BAEA;gBAAA;gBAAA,OACAA;kBACAzD;oBACAgB;oBACAC;oBACA4B;oBAAA;oBACAC;oBACA5B;oBAAA;oBACAC;oBACAC;oBACAC;oBACAqC;oBACAC;kBACA;gBACA;cAAA;gBAbAjB;gBAAA,KAgBA;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA;gBAAA,OAEAe;kBACAzD;oBACAmB;oBACAsB;oBACAI;oBACA3B;oBACAE;oBACAC;oBACAuC;oBACAF;kBACA;gBACA;cAAA;gBACAP;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;gBACA;cAAA;gBAIAJ;gBAEA;kBACAA;oBACAC;oBACAC;oBACAC;kBACA;;kBAEA;kBACAW;oBACAC;oBACArB;oBACAI;oBACA3B;oBACAE;oBACA2C;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;kBACA,GAEA;kBACA;;kBAEA;kBACA;kBACA;;kBAEA;kBACA;oBACAnC;sBACAY;wBACAC;wBACAC;wBACAC;sBACA;oBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAC;gBACAJ;gBACAA;kBACAC;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAsB;MAAA;MACA;MACA;QAAA;MAAA;MACA;QACAxB;UACAC;UACAC;QACA;QACA;MACA;;MAEA;MACAF;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;UACA;UACA;YACAe;YACArB;YACAI;YACA3B;YACAE;YACA2C;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;UACA;;UAEA;UACA;YACAvB;cACAyB;cACAtB;YACA;UACA;;UAEA;UACAH;YACAC;YACAC;YACAC;UACA;;UAEA;UACAzD;YAAAgF;UAAA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAGA3B;kBACA;kBACA4B,WACA;kBAAA;kBACA;kBAAA;kBACA;kBAAA;kBACA;kBAAA,CACA;;kBACA;kBACAC;kBACA;kBACAC;gBACA;cAAA;gBAZAC;gBAcA3B;gBACAA;gBACAA;;gBAEA;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBACAA;gBACAJ;kBACAC;kBACAC;gBACA;gBAAA;cAAA;gBAIA;gBACA8B;gBACA5B;;gBAEA;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBACAJ;kBACAC;kBACAC;gBACA;gBAAA;cAAA;gBAAA;gBAAA,OAIA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAE;gBACA;kBACAJ;oBACAC;oBACAC;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA+B;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA7B;gBACAA;gBACAA;gBAEAJ;kBAAAC;kBAAAQ;gBAAA;gBAAA;gBAGA;gBACAL;gBAAA;gBAAA,OACA1D;kBACAuB;kBACAhB;oBACAiF;oBACA9D;kBACA;gBACA;cAAA;gBANA+D;gBAQA/B;gBACAA;gBACAA;gBAEAJ;gBAAA,MAEAmC;kBAAA;kBAAA;gBAAA;gBACA/B;gBACA;gBACAgC,4BAEA;gBACAC;kBAAA,OACAC,mCACAA;gBAAA,EACA;gBAAA,KAEAD;kBAAA;kBAAA;gBAAA;gBACArC;kBACAC;kBACAC;gBACA;gBAAA;cAAA;gBAIA;gBACA;kBACAa;kBACArB;kBACAI;kBACA3B;kBACAE;kBACA2C;kBACAC;kBACAC;kBACAC;kBACAC;kBACAC;kBACAC;kBACAC;gBACA;;gBAEA;gBACAgB;kBACA;kBACA;kBACA;gBACA;gBAEAvC;kBACAC;kBACAC;kBACAC;gBACA;;gBAEA;gBACAzD;kBAAAgF;gBAAA;gBAAA;gBAAA;cAAA;gBAGA;gBACAtB;gBACAJ;gBAEAA;kBACAC;kBACAuC;kBACAC;kBACAC;kBACAC;oBACA;sBACA;sBACA;sBACA;sBACA;sBACA;oBACA;kBACA;gBACA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAIA3C;gBACAI;gBAEAJ;kBACAC;kBACAuC;kBACAC;kBACAC;kBACAC;oBACA;sBACA;sBACA;oBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAC;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;QACA;QACA;MACA;MAEA7C;QACAC;QACAuC;QACAM;QACAL;MACA;IACA;IAEA;IACAM;MACA;;MAEA;MACA;QACA;QACA;QACA;QACA;MACA;MAEA;IACA;IAEAC;MACA;MACA;MACA;MACAV;IACA;IAEAW;MACA;MACA;MAEA;QACA1B;MACA;MAEAe;IACA;IAEAY;MACA;MACA;IACA;IAEAC;MAAA;MACAnD;QACAC;QACAuC;QACAG;UACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACAS;MACA;QACApD;UAAAC;UAAAC;QAAA;QACA;MACA;MAEA;QACA;QACA;QAEA;UACAF;YAAAC;YAAAC;UAAA;UACA;QACA;QACA;UACAF;YAAAC;YAAAC;UAAA;UACA;QACA;QACA;UACAF;YAAAC;YAAAC;UAAA;UACA;QACA;QACA;UACAF;YAAAC;YAAAC;UAAA;UACA;QACA;QACA;UACAF;YAAAC;YAAAC;UAAA;UACA;QACA;MACA;MAEA;QACAF;UAAAC;UAAAC;QAAA;QACA;MACA;MAEA;IACA;IAEAmD;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAIArD;kBAAAC;kBAAAQ;gBAAA;gBAAA;gBAGA6C;gBAAA;gBAAA,OAEA5G;kBACAuB;kBACAhB;oBACAiF;oBACAjF;sBACAC;sBACAG;sBACAkG;wBAAA;0BACAxC;0BACArB;0BACAI;0BACA5B;0BACAC;0BACAE;0BACA2C;0BACAC;0BACAC;0BACAE;0BACAC;wBACA;sBAAA;sBACAjE;sBACAoG;sBACAjG;sBACAkG;sBACAC;oBACA;kBACA;gBACA;cAAA;gBA3BA/D;gBA6BAK;gBAAA,MAEAL;kBAAA;kBAAA;gBAAA;gBACAK;kBACAC;kBACAC;kBACAC;gBACA;gBAEAf;kBACAY;gBACA;gBAAA;gBAAA;cAAA;gBAAA,MAEA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAIAA;gBACAI;gBACAJ;kBACAC;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACrkCA;AAAA;AAAA;AAAA;AAAkuC,CAAgB,8sCAAG,EAAC,C;;;;;;;;;;;ACAtvC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages-sub/in/add.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages-sub/in/add.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./add.vue?vue&type=template&id=58f3a51d&scoped=true&\"\nvar renderjs\nimport script from \"./add.vue?vue&type=script&lang=js&\"\nexport * from \"./add.vue?vue&type=script&lang=js&\"\nimport style0 from \"./add.vue?vue&type=style&index=0&id=58f3a51d&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"58f3a51d\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages-sub/in/add.vue\"\nexport default component.exports","export * from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=template&id=58f3a51d&scoped=true&\"","var components\ntry {\n  components = {\n    signature: function () {\n      return import(\n        /* webpackChunkName: \"components/signature/index\" */ \"@/components/signature/index.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. æ’æŸ¥ç»„ä»¶åç§°æ‹¼å†™æ˜¯å¦æ­£ç¡®\")\n    console.error(\n      \"2. æ’æŸ¥ç»„ä»¶æ˜¯å¦ç¬¦åˆ easycom è§„èŒƒï¼Œæ–‡æ¡£ï¼šhttps://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. è‹¥ç»„ä»¶ä¸ç¬¦åˆ easycom è§„èŒƒï¼Œéœ€æ‰‹åŠ¨å¼•å…¥ï¼Œå¹¶åœ¨ components ä¸­æ³¨å†Œè¯¥ç»„ä»¶\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.showSearchResult && _vm.searchResults.length > 0\n  var g1 = _vm.drugList.length\n  var g2 = _vm.drugList.length\n  var l0 =\n    g2 > 0\n      ? _vm.__map(_vm.drugList, function (item, index) {\n          var $orig = _vm.__get_orig(item)\n          var m0 = item.amount > 0 ? _vm.formatAmount(item.amount) : null\n          return {\n            $orig: $orig,\n            m0: m0,\n          }\n        })\n      : null\n  var g3 =\n    _vm.drugList.length === 0 && !_vm.searchKeyword && !_vm.showSearchResult\n  var g4 = _vm.drugList.length\n  var g5 = g4 > 0 ? _vm.drugList.length : null\n  var m1 =\n    g4 > 0 && _vm.totalAmount > 0 ? _vm.formatAmount(_vm.totalAmount) : null\n  if (!_vm._isMounted) {\n    _vm.e0 = function (e, index) {\n      var args = [],\n        len = arguments.length - 2\n      while (len-- > 0) args[len] = arguments[len + 2]\n\n      var _temp = args[args.length - 1].currentTarget.dataset,\n        _temp2 = _temp.eventParams || _temp[\"event-params\"],\n        index = _temp2.index\n      var _temp, _temp2\n      return _vm.onDateChange(index, \"productionDate\", e.detail.value)\n    }\n    _vm.e1 = function (e, index) {\n      var args = [],\n        len = arguments.length - 2\n      while (len-- > 0) args[len] = arguments[len + 2]\n\n      var _temp3 = args[args.length - 1].currentTarget.dataset,\n        _temp4 = _temp3.eventParams || _temp3[\"event-params\"],\n        index = _temp4.index\n      var _temp3, _temp4\n      return _vm.onDateChange(index, \"expireDate\", e.detail.value)\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n        l0: l0,\n        g3: g3,\n        g4: g4,\n        g5: g5,\n        m1: m1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"page\">\n\t\t<!-- é¡µé¢å¤´éƒ¨ -->\n\t\t<view class=\"page-header\">\n\t\t\t<view class=\"header-content\">\n\t\t\t\t<text class=\"header-title\">è¯æå…¥åº“</text>\n\t\t\t\t<text class=\"header-subtitle\">å…¥åº“æ—¥æœŸï¼š{{ currentDate }}</text>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- åŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->\n\t\t<view class=\"info-card\">\n\t\t\t<view class=\"info-row\">\n\t\t\t\t<view class=\"info-item\">\n\t\t\t\t\t<text class=\"label\">å•å·ï¼š</text>\n\t\t\t\t\t<text class=\"value\">{{ recordNo }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"info-item\">\n\t\t\t\t\t<text class=\"label\">åŒ»ç”Ÿï¼š</text>\n\t\t\t\t\t<text class=\"value\">{{ operator }}</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t<view class=\"info-row\">\n\t\t\t<view class=\"info-item full\">\n\t\t\t\t\t<text class=\"label\">å¤‡æ³¨</text>\n\t\t\t\t\t<input \n\t\t\t\t\t\tclass=\"input-value\" \n\t\t\t\t\t\tv-model=\"remark\" \n\t\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯ï¼ˆé€‰å¡«ï¼‰\"\n\t\t\t\t\t\tplaceholder-class=\"placeholder\"\n\t\t\t\t\t/>\n\t\t\t</view>\n\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- æ™ºèƒ½è¾“å…¥æ¡† -->\n\t\t<view class=\"search-card\">\n\t\t\t<view class=\"search-wrapper\" :class=\"{ 'focused': searchFocused }\">\n\t\t\t\t<view class=\"search-icon-wrapper\">\n\t\t\t\t\t<text class=\"search-icon\">ğŸ”</text>\n\t\t\t\t</view>\n\t\t\t\t<input \n\t\t\t\t\tclass=\"search-input\"\n\t\t\t\t\tv-model=\"searchKeyword\"\n\t\t\t\t\tplaceholder=\"æ‰«ç /æœç´¢è¯æåç§°\"\n\t\t\t\t\tplaceholder-class=\"placeholder\"\n\t\t\t\t\t@focus=\"onSearchFocus\"\n\t\t\t\t\t@blur=\"onSearchBlur\"\n\t\t\t\t\t@input=\"onSearchInput\"\n\t\t\t\t\t@confirm=\"onSearchConfirm\"\n\t\t\t\t/>\n\t\t\t\t<view v-if=\"searchKeyword\" class=\"clear-icon\" @tap=\"clearSearch\">\n\t\t\t\t\t<text>âœ•</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"scan-btn\" @tap=\"scanBarcode\">\n\t\t\t\t\t<view class=\"scan-icon-frame\"></view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- æœç´¢ç»“æœä¸‹æ‹‰åˆ—è¡¨ï¼ˆä½¿ç”¨transitionï¼‰ -->\n\t\t\t<view \n\t\t\t\tclass=\"search-results\" \n\t\t\t\t:class=\"{ 'show': showSearchResult && searchResults.length > 0 }\"\n\t\t\t>\n\t\t\t\t<view \n\t\t\t\t\tv-for=\"(drug, index) in searchResults\" \n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\tclass=\"result-item\"\n\t\t\t\t\t@tap=\"selectDrug(drug)\"\n\t\t\t\t>\n\t\t\t\t\t<view class=\"drug-info\">\n\t\t\t\t\t\t<text class=\"drug-name\">{{ drug.name }}</text>\n\t\t\t\t\t\t<text class=\"drug-spec\">{{ drug.spec }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"select-icon\">â€º</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- æœç´¢ä¸­ -->\n\t\t\t<view v-if=\"isSearchingAPI\" class=\"api-searching\">\n\t\t\t\t<view class=\"loading-wrapper\">\n\t\t\t\t\t<text class=\"loading-icon\">â³</text>\n\t\t\t\t\t<text class=\"loading-text\">æ­£åœ¨æŸ¥è¯¢è¯ææ¡£æ¡ˆ...</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- åˆ›å»ºè¯æè¡¨å•ï¼ˆå†…è”ï¼‰ -->\n\t\t\t<view v-if=\"showCreateForm\" class=\"create-form-inline\">\n\t\t\t\t<!-- æç¤ºä¿¡æ¯ -->\n\t\t\t\t<view class=\"create-tip tip-warning\">\n\t\t\t\t\t<text class=\"tip-icon\">ğŸ’¡</text>\n\t\t\t\t\t<view class=\"tip-content\">\n\t\t\t\t\t\t<text class=\"tip-title\">æœªæ‰¾åˆ°ç›¸å…³è¯æ</text>\n\t\t\t\t\t\t<text class=\"tip-subtitle\">è¯·å®Œå–„ä»¥ä¸‹ä¿¡æ¯</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- åˆ›å»ºè¡¨å• -->\n\t\t\t\t<view class=\"inline-form\">\n\t\t\t\t\t<view class=\"inline-form-title\">ğŸ“ æ–°å»ºè¯ææ¡£æ¡ˆ</view>\n\t\t\t\t\t\n\t\t\t\t<!-- è¯æåç§° -->\n\t\t\t\t\t<view class=\"inline-form-item\">\n\t\t\t\t\t<text class=\"inline-label\">è¯æåç§° <text class=\"required\">*</text></text>\n\t\t\t\t\t<view class=\"input-with-voice\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\tclass=\"inline-input voice-input\" \n\t\t\t\t\t\t\tv-model=\"newDrug.name\" \n\t\t\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥è¯æåç§°\"\n\t\t\t\t\t\t\tplaceholder-class=\"placeholder\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<view class=\"voice-btn\" @tap=\"startVoiceInput('name')\">\n\t\t\t\t\t\t\t<text class=\"voice-icon\">ğŸ¤</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<!-- è§„æ ¼ -->\n\t\t\t\t\t<view class=\"inline-form-item\">\n\t\t\t\t\t\t<text class=\"inline-label\">è§„æ ¼ <text class=\"required\">*</text></text>\n\t\t\t\t\t\t<view class=\"input-with-voice\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\tclass=\"inline-input voice-input\" \n\t\t\t\t\t\t\tv-model=\"newDrug.spec\" \n\t\t\t\t\t\t\tplaceholder=\"å¦‚ï¼š0.25gÃ—24ç²’/ç›’\"\n\t\t\t\t\t\t\tplaceholder-class=\"placeholder\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<view class=\"voice-btn\" @tap=\"startVoiceInput('spec')\">\n\t\t\t\t\t\t\t\t<text class=\"voice-icon\">ğŸ¤</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<!-- å•ä½ -->\n\t\t\t\t\t<view class=\"inline-form-item\">\n\t\t\t\t\t\t<text class=\"inline-label\">å•ä½ <text class=\"required\">*</text></text>\n\t\t\t\t\t\t<picker \n\t\t\t\t\t\t\tmode=\"selector\"\n\t\t\t\t\t\t\t:range=\"unitOptions\"\n\t\t\t\t\t\t\t:value=\"unitIndex\"\n\t\t\t\t\t\t\t@change=\"onUnitChange\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<view class=\"inline-picker\">\n\t\t\t\t\t\t\t\t<text :class=\"['picker-text', !newDrug.unit && 'picker-placeholder']\">\n\t\t\t\t\t\t\t\t\t{{ newDrug.unit || 'è¯·é€‰æ‹©å•ä½' }}\n\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t\t<text class=\"picker-arrow\">â–¼</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</picker>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<!-- æ“ä½œæŒ‰é’® -->\n\t\t\t\t\t<view class=\"inline-form-actions\">\n\t\t\t\t\t\t<view class=\"inline-btn btn-cancel\" @tap=\"cancelCreate\">\n\t\t\t\t\t\t\t<text>å–æ¶ˆ</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"inline-btn btn-confirm\" @tap=\"confirmCreate\">\n\t\t\t\t\t\t\t<text>ç¡®è®¤åˆ›å»ºå¹¶æ·»åŠ </text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- è¯æåˆ—è¡¨ -->\n\t\t<view class=\"drug-list-section\">\n\t\t\t<view class=\"section-header\">\n\t\t\t\t<text class=\"section-title\">å…¥åº“æ˜ç»†</text>\n\t\t\t\t<text class=\"section-count\">{{ drugList.length }} ç§</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- è¯æå¡ç‰‡åˆ—è¡¨ -->\n\t\t\t<view v-if=\"drugList.length > 0\" class=\"drug-cards\">\n\t\t\t\t<view \n\t\t\t\t\tv-for=\"(item, index) in drugList\" \n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\tclass=\"drug-card\"\n\t\t\t\t\t:class=\"{ 'has-error': item.hasError }\"\n\t\t\t\t>\n\t\t\t\t\t<!-- è¯æå¤´éƒ¨ -->\n\t\t\t\t\t<view class=\"card-header\">\n\t\t\t\t\t\t<view class=\"drug-name-wrapper\">\n\t\t\t\t\t\t\t<text class=\"drug-name\">{{ item.drugName }}</text>\n\t\t\t\t\t\t\t<text class=\"drug-spec\">{{ item.specification }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"delete-btn\" @tap=\"deleteDrug(index)\">\n\t\t\t\t\t\t\t<text class=\"delete-icon\">âœ•</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<!-- è¯æä¿¡æ¯è¡¨å• -->\n\t\t\t\t\t<view class=\"card-form\">\n\t\t\t\t\t\t<!-- ç¬¬ä¸€è¡Œï¼šæ‰¹å·ã€ç”Ÿäº§æ—¥æœŸã€æœ‰æ•ˆæœŸ -->\n\t\t\t\t\t\t<view class=\"form-row\">\n\t\t\t\t\t\t\t<view class=\"form-item third\">\n\t\t\t\t\t\t\t<text class=\"form-label\">æ‰¹å· <text class=\"required\">*</text></text>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tclass=\"form-input\"\n\t\t\t\t\t\t\t\tv-model=\"item.batch\"\n\t\t\t\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥æ‰¹å·\"\n\t\t\t\t\t\t\t\tplaceholder-class=\"placeholder\"\n\t\t\t\t\t\t\t\t@blur=\"validateRow(index)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<view class=\"form-item third\">\n\t\t\t\t\t\t\t<text class=\"form-label\">ç”Ÿäº§æ—¥æœŸ <text class=\"required\">*</text></text>\n\t\t\t\t\t\t\t<picker \n\t\t\t\t\t\t\t\tmode=\"date\"\n\t\t\t\t\t\t\t\t:value=\"item.productionDate\"\n\t\t\t\t\t\t\t\t:start=\"minDate\"\n\t\t\t\t\t\t\t\t:end=\"maxDate\"\n\t\t\t\t\t\t\t\t@change=\"e => onDateChange(index, 'productionDate', e.detail.value)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<view class=\"picker-input\" :class=\"{ 'has-value': item.productionDate }\">\n\t\t\t\t\t\t\t\t\t{{ item.productionDate || 'è¯·é€‰æ‹©' }}\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</picker>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<view class=\"form-item third\">\n\t\t\t\t\t\t\t<text class=\"form-label\">æœ‰æ•ˆæœŸ <text class=\"required\">*</text></text>\n\t\t\t\t\t\t\t<picker \n\t\t\t\t\t\t\t\tmode=\"date\"\n\t\t\t\t\t\t\t\t:value=\"item.expireDate\"\n\t\t\t\t\t\t\t\t:start=\"minDate\"\n\t\t\t\t\t\t\t\t:end=\"maxExpDate\"\n\t\t\t\t\t\t\t\t@change=\"e => onDateChange(index, 'expireDate', e.detail.value)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<view class=\"picker-input\" :class=\"{ 'has-value': item.expireDate }\">\n\t\t\t\t\t\t\t\t\t{{ item.expireDate || 'è¯·é€‰æ‹©' }}\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</picker>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t<!-- è·æœ‰æ•ˆæœŸ -->\n\t\t\t\t\t\t\t<view v-if=\"item.daysToExpiry !== null\" class=\"expiry-badge-inline\" :class=\"[\n\t\t\t\t\t\titem.daysToExpiry < 0 ? 'expired' : '',\n\t\t\t\t\t\titem.daysToExpiry >= 0 && item.daysToExpiry < 30 ? 'danger' : '',\n\t\t\t\t\t\titem.daysToExpiry >= 30 && item.daysToExpiry < 90 ? 'warning' : '',\n\t\t\t\t\t\titem.daysToExpiry >= 90 ? 'safe' : ''\n\t\t\t\t\t]\">\n\t\t\t\t\t\t<text>{{ item.daysToExpiry }}å¤©</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<!-- ç¬¬äºŒè¡Œï¼šæ•°é‡å’Œå•ä»· -->\n\t\t\t\t\t\t<view class=\"form-row\">\n\t\t\t\t\t\t\t<view class=\"form-item half\">\n\t\t\t\t\t\t\t\t<text class=\"form-label\">æ•°é‡ <text class=\"required\">*</text></text>\n\t\t\t\t\t\t\t\t<view class=\"input-with-unit\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"form-input\"\n\t\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\t\tv-model=\"item.quantity\"\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"æ•°é‡\"\n\t\t\t\t\t\t\t\t\t\tplaceholder-class=\"placeholder\"\n\t\t\t\t\t\t\t\t\t\t@blur=\"validateRow(index)\"\n\t\t\t\t\t\t\t\t\t\t@input=\"calculateAmount(index)\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<text class=\"unit-text\">{{ item.unit }}</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<view class=\"form-item half\">\n\t\t\t\t\t\t\t\t<text class=\"form-label\">å•ä»·</text>\n\t\t\t\t\t\t\t\t<view class=\"input-with-unit\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"form-input\"\n\t\t\t\t\t\t\t\t\t\ttype=\"digit\"\n\t\t\t\t\t\t\t\t\t\tv-model=\"item.price\"\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"é€‰å¡«\"\n\t\t\t\t\t\t\t\t\t\tplaceholder-class=\"placeholder\"\n\t\t\t\t\t\t\t\t\t\t@input=\"calculateAmount(index)\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<text class=\"unit-text\">å…ƒ</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<!-- é‡‘é¢ -->\n\t\t\t\t\t\t<view v-if=\"item.amount > 0\" class=\"amount-display\">\n\t\t\t\t\t\t\t<text class=\"amount-label\">é‡‘é¢ï¼š</text>\n\t\t\t\t\t\t\t<text class=\"amount-value\">Â¥{{ formatAmount(item.amount) }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t<!-- ç©ºçŠ¶æ€ï¼ˆä»…åœ¨æ²¡æœ‰æœç´¢æ—¶æ˜¾ç¤ºï¼‰ -->\n\t\t<view v-if=\"drugList.length === 0 && !searchKeyword && !showSearchResult\" class=\"empty-state\">\n\t\t\t<text class=\"empty-icon\">ğŸ“¦</text>\n\t\t\t<text class=\"empty-text\">æš‚æ— è¯æ</text>\n\t\t\t<text class=\"empty-hint\">è¯·åœ¨ä¸Šæ–¹æœç´¢æ¡†æ‰«ç æˆ–æœç´¢æ·»åŠ è¯æ</text>\n\t\t</view>\n\t\t</view>\n\t\t\n\t<!-- ç­¾ååŒºåŸŸï¼ˆä»…åœ¨æœ‰è¯ææ—¶æ˜¾ç¤ºï¼‰ -->\n\t<view v-if=\"drugList.length > 0\" class=\"signature-section\">\n\t\t<!-- åˆè®¡ä¿¡æ¯ -->\n\t\t<view class=\"summary-card\">\n\t\t\t<view class=\"summary-item\">\n\t\t\t\t<text class=\"summary-label\">å“ç§</text>\n\t\t\t\t<text class=\"summary-value\">{{ drugList.length }} ç§</text>\n\t\t\t</view>\n\t\t\t<view class=\"summary-item\">\n\t\t\t\t<text class=\"summary-label\">æ€»æ•°é‡</text>\n\t\t\t\t<text class=\"summary-value\">{{ totalQuantity }}</text>\n\t\t\t</view>\n\t\t\t<view v-if=\"totalAmount > 0\" class=\"summary-item highlight\">\n\t\t\t\t<text class=\"summary-label\">æ€»é‡‘é¢</text>\n\t\t\t\t<text class=\"summary-value\">Â¥{{ formatAmount(totalAmount) }}</text>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t<!-- æ“ä½œå‘˜ç­¾å -->\n\t\t<view class=\"signature-card\">\n\t\t\t<view class=\"signature-header\">\n\t\t\t<text class=\"signature-title\">æ“ä½œå‘˜ç­¾å</text>\n\t\t\t\t<text class=\"required\">*</text>\n\t\t\t</view>\n\t\t<signature \n\t\t\tv-model=\"operatorSign\"\n\t\t\ttitle=\"æ“ä½œå‘˜ç­¾å\"\n\t\t></signature>\n\t</view>\n\t\t\n\t<!-- æäº¤æŒ‰é’® -->\n\t<view class=\"submit-btn-container\">\n\t\t<view class=\"submit-btn\" @tap=\"submit\">\n\t\t\t<view class=\"submit-icon\">âœ“</view>\n\t\t\t<text class=\"submit-text\">æäº¤å…¥åº“</text>\n\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t</view>\n</template>\n\n<script>\nimport Signature from '@/components/signature/index.vue'\nimport Common from '@/utils/common.js'\n\nexport default {\n\tcomponents: {\n\t\tsignature: Signature\n\t},\n\t\n\tdata() {\n\t\treturn {\n\t\t\t// åŸºæœ¬ä¿¡æ¯\n\t\t\trecordNo: '',\n\t\t\tcurrentDate: '',\n\t\t\toperator: '',\n\t\tremark: '',\n\t\t\tdrugList: [],\n\t\t\toperatorSign: '',\n\t\t\t\n\t\t// è¯ææœç´¢ç›¸å…³\n\t\t\tsearchKeyword: '',\n\t\t\tsearchFocused: false,\n\t\t\tshowSearchResult: false,\n\t\t\tsearchResults: [],\n\t\t\tsearchTimer: null,\n\t\t\tisSearchingAPI: false,\n\t\t\t\n\t\t\t// æ–°å»ºè¯æï¼ˆå†…è”è¡¨å•ï¼‰\n\t\t\tshowCreateForm: false,\n\t\t\tcreateFormSource: '',\n\t\t\tnewDrug: {\n\t\t\t\tname: '',\n\t\t\t\tspec: '',\n\t\t\t\tunit: '',\n\t\t\t\tbarcode: '',\n\t\t\t\tmanufacturer: '',\n\t\t\t\tapprovalNumber: ''\n\t\t\t},\n\t\t\tunitOptions: ['ç›’', 'ç“¶', 'è¢‹', 'æ”¯', 'æ¿', 'ç‰‡', 'ç²’', 'ä¸¸'],\n\t\t\tunitIndex: 0,\n\t\t\t\n\t\t\t// æ—¥æœŸèŒƒå›´\n\t\t\tminDate: '2020-01-01',\n\t\t\tmaxDate: '',\n\t\t\tmaxExpDate: '2035-12-31'\n\t\t}\n\t},\n\t\n\tcomputed: {\n\t\ttotalQuantity() {\n\t\t\treturn this.drugList.reduce((sum, item) => {\n\t\t\t\treturn sum + (Number(item.quantity) || 0)\n\t\t\t}, 0)\n\t\t},\n\t\t\n\t\ttotalAmount() {\n\t\t\treturn this.drugList.reduce((sum, item) => {\n\t\t\t\treturn sum + (Number(item.amount) || 0)\n\t\t\t}, 0)\n\t\t}\n\t},\n\t\n\tonLoad() {\n\t\tthis.initPage()\n\t},\n\t\n\tmethods: {\n\t\tinitPage() {\n\t\t\t// ç”Ÿæˆå…¥åº“å•å·\n\t\t\tthis.recordNo = Common.generateRecordNo('RK')\n\t\t\t\n\t\t\t// è·å–å½“å‰æ—¶é—´\n\t\t\tconst now = new Date()\n\t\t\tthis.currentDate = Common.formatDate(now)\n\t\t\tthis.maxDate = Common.formatDate(now)\n\t\t\t\n\t\t\t// è·å–å½“å‰ç”¨æˆ·\n\t\t\tconst userInfo = uni.getStorageSync('userInfo')\n\t\t\tthis.operator = userInfo?.name || 'æœªç™»å½•'\n\t\t},\n\t\t\n\t\t\n\t\t// ========== è¯ææœç´¢ç›¸å…³ ==========\n\t\tonSearchFocus() {\n\t\t\tthis.searchFocused = true\n\t\t\t// èšç„¦æœç´¢æ¡†æ—¶ï¼Œéšè—åˆ›å»ºè¡¨å•\n\t\t\tthis.showCreateForm = false\n\t\t\tif (this.searchKeyword) {\n\t\t\t\tthis.showSearchResult = true\n\t\t\t}\n\t\t},\n\t\t\n\t\tonSearchBlur() {\n\t\t\tthis.searchFocused = false\n\t\t\t// å»¶è¿Ÿéšè—ï¼Œä»¥ä¾¿ç‚¹å‡»æœç´¢ç»“æœ\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.showSearchResult = false\n\t\t\t}, 200)\n\t\t},\n\t\t\n\t\tonSearchInput(e) {\n\t\t\tconst keyword = e.detail.value.trim()\n\t\t\t\n\t\t\tif (!keyword) {\n\t\t\t\tthis.searchResults = []\n\t\t\t\tthis.showSearchResult = false\n\t\t\t\treturn\n\t\t\t}\n\t\t\t\n\t\t\t// é˜²æŠ–æœç´¢\n\t\t\tif (this.searchTimer) {\n\t\t\t\tclearTimeout(this.searchTimer)\n\t\t\t}\n\t\t\t\n\t\t\tthis.searchTimer = setTimeout(() => {\n\t\t\t\tthis.searchDrugs(keyword)\n\t\t\t}, 300)\n\t\t},\n\t\t\n\t\tonSearchConfirm() {\n\t\t\tif (this.searchKeyword.trim()) {\n\t\t\t\tthis.searchDrugs()\n\t\t\t}\n\t\t},\n\t\t\n\t\t// â­ æ™ºèƒ½æœç´¢ï¼šä»…æŸ¥è¯¢æœ¬åœ°è¯ææ¡£æ¡ˆ\n\tasync searchDrugs(inputKeyword) {\n\t\tconst keyword = (inputKeyword || this.searchKeyword).trim()\n\t\tif (!keyword) return\n\t\t\n\t\ttry {\n\t\t\t// æ˜¾ç¤ºæœç´¢ä¸­çŠ¶æ€\n\t\t\tthis.isSearchingAPI = true\n\t\t\tthis.showSearchResult = false\n\t\t\t\n\t\t\t// è°ƒç”¨äº‘å‡½æ•°æŸ¥è¯¢æœ¬åœ°è¯ææ¡£æ¡ˆ\n\t\t\tconst result = await wx.cloud.callFunction({\n\t\t\t\tname: 'drugSearch',\n\t\t\t\tdata: { drugName: keyword }\n\t\t\t})\n\t\t\t\n\t\t\tthis.isSearchingAPI = false\n\t\t\t\n\t\t\tif (result.result && result.result.success) {\n\t\t\t\t// æ‰¾åˆ°æœ¬åœ°è¯ææ¡£æ¡ˆ\n\t\t\t\tconst drugs = result.result.data\n\t\t\t\t\n\t\t\t\t// æ ¼å¼åŒ–ä¸ºç»Ÿä¸€ç»“æ„\n\t\t\t\tthis.searchResults = drugs.map(drug => ({\n\t\t\t\t\t_id: drug._id || 'temp_' + Date.now(),\n\t\t\t\t\tname: drug.name,\n\t\t\t\t\tspec: drug.specification || '',\n\t\t\t\t\tspecification: drug.specification || '',\n\t\t\t\t\tunit: drug.unit || 'ç›’',\n\t\t\t\t\tpackUnit: drug.unit || 'ç›’',\n\t\t\t\t\tmanufacturer: drug.manufacturer || '',\n\t\t\t\t\tbarcode: drug.barcode || '',\n\t\t\t\t\tapprovalNumber: drug.approvalNumber || ''\n\t\t\t\t}))\n\t\t\t\t\n\t\t\t\t// æ˜¾ç¤ºæœç´¢ç»“æœï¼Œéšè—åˆ›å»ºè¡¨å•\n\t\t\t\t\tthis.showSearchResult = true\n\t\t\t\t\tthis.showCreateForm = false\n\t\t\t\t\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: `æ‰¾åˆ° ${drugs.length} æ¡è¯æ`,\n\t\t\t\t\ticon: 'none',\n\t\t\t\t\tduration: 1500\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t// æœªæ‰¾åˆ°ï¼Œæç¤ºæ‰‹åŠ¨åˆ›å»º\n\t\t\t\tthis.showSearchResult = false\n\t\t\t\t\tthis.activateCreateFormManual(keyword)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('æœç´¢å¤±è´¥:', err)\n\t\t\t\tthis.isSearchingAPI = false\n\t\t\t\t// å‡ºé”™ä¹Ÿæ¿€æ´»æ‰‹åŠ¨åˆ›å»º\n\t\t\t\tthis.activateCreateFormManual(keyword)\n\t\t\t}\n\t\t},\n\t\t\n\t\t// æ¿€æ´»åˆ›å»ºè¡¨å•ï¼ˆæ‰‹åŠ¨ï¼‰â­\n\t\tactivateCreateFormManual(keyword) {\n\t\t\tthis.showCreateForm = true\n\t\t\tthis.createFormSource = 'manual'\n\t\t\tthis.showSearchResult = false\n\t\t\t\n\t\t\t// ä»…å¡«å……æœç´¢è¯\n\t\t\tthis.newDrug = {\n\t\t\t\tname: keyword,\n\t\t\t\tspec: '',\n\t\t\t\tunit: '',\n\t\t\t\tbarcode: '',\n\t\t\t\tmanufacturer: '',\n\t\t\t\tapprovalNumber: ''\n\t\t\t}\n\t\t\tthis.unitIndex = 0\n\t\t\t\n\t\t\tuni.showToast({\n\t\t\t\ttitle: 'ğŸ’¡ æœªæ‰¾åˆ°ï¼Œè¯·å®Œå–„ä¿¡æ¯',\n\t\t\t\ticon: 'none',\n\t\t\t\tduration: 2000\n\t\t\t})\n\t\t},\n\t\t\n\t\tclearSearch() {\n\t\t\tthis.searchKeyword = ''\n\t\t\tthis.searchResults = []\n\t\t\tthis.showSearchResult = false\n\t\t\tthis.showCreateForm = false\n\t\t\tthis.isSearchingAPI = false\n\t\t},\n\t\t\n\t\t// å–æ¶ˆåˆ›å»º\n\t\tcancelCreate() {\n\t\t\tthis.showCreateForm = false\n\t\t\tthis.newDrug = {\n\t\t\t\tname: '',\n\t\t\t\tspec: '',\n\t\t\t\tunit: '',\n\t\t\t\tbarcode: '',\n\t\t\t\tmanufacturer: '',\n\t\t\t\tapprovalNumber: ''\n\t\t\t}\n\t\t\tthis.unitIndex = 0\n\t\t},\n\t\t\n\t\t// ç¡®è®¤åˆ›å»ºå¹¶æ·»åŠ  â­â­â­\n\t\tasync confirmCreate() {\n\t\t\t// éªŒè¯å¿…å¡«é¡¹\n\t\t\tif (!this.newDrug.name || !this.newDrug.spec || !this.newDrug.unit) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: 'è¯·å¡«å†™å®Œæ•´ä¿¡æ¯',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t\treturn\n\t\t\t}\n\t\t\t\n\t\t\tuni.showLoading({ title: 'åˆ›å»ºä¸­...', mask: true })\n\t\t\t\n\t\t\ttry {\n\t\t\t\tconst db = wx.cloud.database()\n\t\t\t\t\n\t\t\t\t// 1. åˆ›å»ºè¯ææ¡£æ¡ˆ\n\t\t\t\tconst result = await db.collection('drugs').add({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tname: this.newDrug.name,\n\t\t\t\t\t\tspec: this.newDrug.spec,\n\t\t\t\t\t\tspecification: this.newDrug.spec,  // å…¼å®¹å­—æ®µ\n\t\t\t\t\t\tpackUnit: this.newDrug.unit,\n\t\t\t\t\t\tunit: this.newDrug.unit,  // å…¼å®¹å­—æ®µ\n\t\t\t\t\t\tbarcode: this.newDrug.barcode || '',\n\t\t\t\t\t\tmanufacturer: this.newDrug.manufacturer || '',\n\t\t\t\t\t\tapprovalNumber: this.newDrug.approvalNumber || '',\n\t\t\t\t\t\tcreateTime: new Date(),\n\t\t\t\t\t\tcreateSource: this.createFormSource  // è®°å½•æ¥æºï¼šapi æˆ– manual\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\t// 2. å¦‚æœæœ‰æ¡å½¢ç ï¼Œåˆ›å»ºæ¡å½¢ç æ˜ å°„\n\t\t\t\tif (this.newDrug.barcode) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait db.collection('barcode_mapping').add({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tbarcode: this.newDrug.barcode,\n\t\t\t\t\t\t\t\tdrugName: this.newDrug.name,\n\t\t\t\t\t\t\t\tspecification: this.newDrug.spec,\n\t\t\t\t\t\t\t\tunit: this.newDrug.unit,\n\t\t\t\t\t\t\t\tmanufacturer: this.newDrug.manufacturer || '',\n\t\t\t\t\t\t\t\tapprovalNumber: this.newDrug.approvalNumber || '',\n\t\t\t\t\t\t\t\tsource: 'manual',\n\t\t\t\t\t\t\t\tcreateTime: db.serverDate()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\tconsole.log('âœ… æ¡å½¢ç æ˜ å°„åˆ›å»ºæˆåŠŸ')\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\tconsole.error('åˆ›å»ºæ¡å½¢ç æ˜ å°„å¤±è´¥:', err)\n\t\t\t\t\t\t// ä¸å½±å“ä¸»æµç¨‹ï¼Œç»§ç»­æ‰§è¡Œ\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tuni.hideLoading()\n\t\t\t\t\n\t\t\t\tif (result._id) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'âœ… åˆ›å»ºæˆåŠŸ',\n\t\t\t\t\t\ticon: 'success',\n\t\t\t\t\t\tduration: 1500\n\t\t\t\t\t})\n\t\t\t\t\t\n\t\t\t\t\t// 3. è‡ªåŠ¨æ·»åŠ åˆ°å…¥åº“åˆ—è¡¨ â­â­â­\n\t\t\t\t\tconst newDrugItem = {\n\t\t\t\t\t\tdrugId: result._id,\n\t\t\t\t\t\tdrugName: this.newDrug.name,\n\t\t\t\t\t\tspecification: this.newDrug.spec,\n\t\t\t\t\t\tunit: this.newDrug.unit,\n\t\t\t\t\t\tmanufacturer: this.newDrug.manufacturer || '',\n\t\t\t\t\t\tbatch: '',\n\t\t\t\t\t\tproductionDate: '',\n\t\t\t\t\t\texpireDate: '',\n\t\t\t\t\t\tdaysToExpiry: null,\n\t\t\t\t\t\tquantity: '',\n\t\t\t\t\t\tprice: '',\n\t\t\t\t\t\tamount: '',\n\t\t\t\t\t\thasError: false\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// æ·»åŠ åˆ°åˆ—è¡¨æœ€å‰é¢ï¼ˆæ–°çš„åœ¨ä¸Šï¼‰\n\t\t\t\t\tthis.drugList.unshift(newDrugItem)\n\t\t\t\t\t\n\t\t\t\t\t// é‡ç½®è¡¨å•\n\t\t\t\t\tthis.cancelCreate()\n\t\t\t\t\tthis.searchKeyword = ''\n\t\t\t\t\t\n\t\t\t\t\t// å¦‚æœæ˜¯æ‰«ç åˆ›å»ºçš„ï¼Œæç¤ºä¸‹æ¬¡å¯ç›´æ¥è¯†åˆ«\n\t\t\t\t\tif (this.newDrug.barcode) {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: 'ä¸‹æ¬¡æ‰«ç å¯ç›´æ¥è¯†åˆ«',\n\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}, 1500)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('åˆ›å»ºå¤±è´¥:', error)\n\t\t\t\tuni.hideLoading()\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: 'åˆ›å»ºå¤±è´¥: ' + error.message,\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\t\n\t\tselectDrug(drug) {\n\t\t\t// æ£€æŸ¥æ˜¯å¦å·²æ·»åŠ \n\t\t\tconst exists = this.drugList.some(item => item.drugId === drug._id)\n\t\t\tif (exists) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: 'è¯¥è¯æå·²æ·»åŠ ',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t\treturn\n\t\t\t}\n\t\t\t\n\t\t\t// è®°å½•å½“å‰æ»šåŠ¨ä½ç½®\n\t\t\tuni.createSelectorQuery().selectViewport().scrollOffset((res) => {\n\t\t\t\tconst currentScrollTop = res.scrollTop || 0\n\t\t\t\t\n\t\t\t\t// ç«‹å³æ¸…ç©ºæœç´¢å’Œéšè—ç»“æœ\n\t\tthis.searchKeyword = ''\n\t\tthis.searchResults = []\n\t\tthis.showSearchResult = false\n\t\tthis.showCreateForm = false\n\t\tthis.isSearchingAPI = false\n\t\t\n\t\t\t\t// ä½¿ç”¨nextTickç¡®ä¿DOMæ›´æ–°åå†æ·»åŠ è¯æ\n\t\tthis.$nextTick(() => {\n\t\t\t\t\t// æ·»åŠ è¯æåˆ°åˆ—è¡¨é¡¶éƒ¨\n\t\t\tthis.drugList.unshift({\n\t\t\t\tdrugId: drug._id,\n\t\t\t\tdrugName: drug.name,\n\t\t\t\tspecification: drug.spec || drug.specification,\n\t\t\t\tunit: drug.packUnit || drug.unit || 'ç›’',\n\t\t\t\tmanufacturer: drug.manufacturer || '',\n\t\t\t\tbatch: '',\n\t\t\t\tproductionDate: '',\n\t\t\t\texpireDate: '',\n\t\t\t\tdaysToExpiry: null,\n\t\t\t\tquantity: '',\n\t\t\t\tprice: '',\n\t\t\t\tamount: 0,\n\t\t\t\thasError: false\n\t\t\t})\n\t\t\t\t\t\n\t\t\t\t\t// ç«‹å³è¡¥å¿æ»šåŠ¨ä½ç½®ï¼ˆæ–°å¢è¯æå¡ç‰‡é«˜åº¦çº¦450rpxï¼‰\n\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\tuni.pageScrollTo({\n\t\t\t\t\t\t\tscrollTop: currentScrollTop + uni.upx2px(450),\n\t\t\t\t\t\t\tduration: 0  // æ— åŠ¨ç”»ï¼Œç¬é—´å®Œæˆ\n\t\t\t\t\t\t})\n\t\t\t})\n\t\t\t\n\t\t\t// ç”¨æˆ·åé¦ˆ\n\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'å·²æ·»åŠ åˆ°åˆ—è¡¨',\n\t\t\t\ticon: 'success',\n\t\t\t\t\t\tduration: 1500\n\t\t\t})\n\t\t\t\n\t\t\t// æŒ¯åŠ¨åé¦ˆ\n\t\t\twx.vibrateShort({ type: 'light' })\n\t\t})\n\t\t\t}).exec()\n\t\t},\n\t\t\n\t\t// ========== æ‰«ç ç›¸å…³ ==========\n\t\tasync scanBarcode() {\n\t\t\ttry {\n\t\t\t\t// è°ƒç”¨å¾®ä¿¡å®˜æ–¹æ‰«ç API\n\t\t\t\tconst scanRes = await uni.scanCode({\n\t\t\t\t\t// æ”¯æŒçš„ç ç±»å‹\n\t\t\t\t\tscanType: [\n\t\t\t\t\t\t'barCode',    // æ¡å½¢ç ï¼ˆä¸€ç»´ç ï¼‰\n\t\t\t\t\t\t'qrCode',     // äºŒç»´ç \n\t\t\t\t\t\t'datamatrix', // Data Matrixç \n\t\t\t\t\t\t'pdf417'      // PDF417ç \n\t\t\t\t\t],\n\t\t\t\t\t// æ˜¯å¦åªèƒ½ä»ç›¸æœºæ‰«ç ï¼Œé»˜è®¤falseï¼ˆå¯ä»¥ä»ç›¸å†Œé€‰æ‹©ï¼‰\n\t\t\t\t\tonlyFromCamera: false,\n\t\t\t\t\t// æ˜¯å¦è‡ªåŠ¨è§£ç \n\t\t\t\t\tautoDecrypt: true\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tconsole.log('ğŸ“· æ‰«ç ç»“æœ:', scanRes)\n\t\t\t\tconsole.log('ğŸ“· æ¡å½¢ç :', scanRes.result)\n\t\t\t\tconsole.log('ğŸ“· æ¡å½¢ç ç±»å‹:', scanRes.scanType)\n\t\t\t\t\n\t\t\t\t// æ£€æŸ¥æ‰«ç ç»“æœ\n\t\t\t\tif (!scanRes || !scanRes.result) {\n\t\t\t\t\tconsole.error('âŒ æ‰«ç ç»“æœä¸ºç©º')\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'æ‰«ç å¤±è´¥ï¼Œè¯·é‡è¯•',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// æ¸…æ´—æ¡å½¢ç ï¼šå»é™¤ç©ºæ ¼ã€ç‰¹æ®Šå­—ç¬¦\n\t\t\t\tconst cleanBarcode = scanRes.result.trim().replace(/\\s/g, '')\n\t\t\t\tconsole.log('ğŸ“· æ¸…æ´—åæ¡å½¢ç :', cleanBarcode)\n\t\t\t\t\n\t\t\t\t// éªŒè¯æ¡å½¢ç æ ¼å¼\n\t\t\t\tif (!cleanBarcode || cleanBarcode.length < 8) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'æ¡å½¢ç æ ¼å¼é”™è¯¯',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tawait this.queryDrugByBarcode(cleanBarcode)\n\t\t\t\t\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('æ‰«ç é”™è¯¯:', err)\n\t\t\t\tif (err.errMsg && !err.errMsg.includes('cancel')) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'æ‰«ç å¤±è´¥',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\n\t\tasync queryDrugByBarcode(barcode) {\n\t\t\tconsole.log('========================================')\n\t\t\tconsole.log('ğŸ” å¼€å§‹æŸ¥è¯¢æ¡å½¢ç :', barcode)\n\t\t\tconsole.log('========================================')\n\t\t\t\n\t\t\tuni.showLoading({ title: 'è¯†åˆ«ä¸­...', mask: true })\n\t\t\t\n\t\t\ttry {\n\t\t\t\t// è°ƒç”¨äº‘å‡½æ•°æŸ¥è¯¢ï¼ˆä¼˜å…ˆæœ¬åœ°æ¡£æ¡ˆ â†’ APIæ¬¡æ•°æ£€æŸ¥ â†’ ç¬¬ä¸‰æ–¹APIï¼‰\n\t\t\t\tconsole.log('ğŸ“¡ è°ƒç”¨äº‘å‡½æ•°...')\n\t\t\t\tconst res = await wx.cloud.callFunction({\n\t\t\t\t\tname: 'drugBarcodeQuery',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\taction: 'queryByBarcode',\n\t\t\t\t\t\tbarcode: barcode\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tconsole.log('ğŸ“¡ äº‘å‡½æ•°è¿”å›:', res)\n\t\t\t\tconsole.log('result.success:', res.result?.success)\n\t\t\t\tconsole.log('result.data:', res.result?.data)\n\t\t\t\t\n\t\t\t\tuni.hideLoading()\n\t\t\t\t\n\t\t\t\tif (res.result && res.result.success) {\n\t\t\t\t\tconsole.log('âœ… æ‰¾åˆ°è¯æï¼')\n\t\t\t\t\t// æ‰¾åˆ°è¯æ\n\t\t\t\t\tconst drugInfo = res.result.data\n\t\t\t\t\t\n\t\t\t\t\t// æ£€æŸ¥æ˜¯å¦å·²æ·»åŠ \n\t\t\t\t\tconst exists = this.drugList.some(item => \n\t\t\t\t\t\titem.drugName === drugInfo.name && \n\t\t\t\t\t\titem.specification === drugInfo.specification\n\t\t\t\t\t)\n\t\t\t\t\t\n\t\t\t\t\tif (exists) {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: 'è¯¥è¯æå·²æ·»åŠ ',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t})\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// æ·»åŠ åˆ°åˆ—è¡¨æœ€å‰é¢(æ–°çš„åœ¨ä¸Š)\n\t\t\t\t\tthis.drugList.unshift({\n\t\t\t\t\t\tdrugId: drugInfo._id || 'temp_' + Date.now(),\n\t\t\t\t\t\tdrugName: drugInfo.name,\n\t\t\t\t\t\tspecification: drugInfo.specification,\n\t\t\t\t\t\tunit: drugInfo.unit || 'ç›’',\n\t\t\t\t\t\tmanufacturer: drugInfo.manufacturer || '',\n\t\t\t\t\t\tbatch: '',\n\t\t\t\t\t\tproductionDate: '',\n\t\t\t\t\t\texpireDate: '',\n\t\t\t\t\t\tdaysToExpiry: null,\n\t\t\t\t\t\tquantity: '',\n\t\t\t\t\t\tprice: '',\n\t\t\t\t\t\tamount: 0,\n\t\t\t\t\t\thasError: false\n\t\t\t\t\t})\n\t\t\t\t\t\n\t\t\t\t\t// æ˜¾ç¤ºæ•°æ®æ¥æº\n\t\t\t\t\tconst sourceText = {\n\t\t\t\t\t\t'local': 'æœ¬åœ°æ¡£æ¡ˆ',\n\t\t\t\t\t\t'cache': 'ç¼“å­˜æ•°æ®',\n\t\t\t\t\t\t'mapping': 'æ˜ å°„è¡¨'\n\t\t\t\t\t}[res.result.source] || 'æ•°æ®åº“'\n\t\t\t\t\t\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: `âœ… å·²æ·»åŠ  (${sourceText})`,\n\t\t\t\t\t\ticon: 'success',\n\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t})\n\t\t\t\t\t\n\t\t\t\t\t// æŒ¯åŠ¨åé¦ˆ\n\t\t\t\t\twx.vibrateShort({ type: 'light' })\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\t// æœªæ‰¾åˆ°è¯æ - æç¤ºç”¨æˆ·æ‰‹åŠ¨åˆ›å»º\n\t\t\t\t\tconsole.log('âŒ æœªæ‰¾åˆ°è¯æï¼Œäº‘å‡½æ•°è¿”å›:', res.result)\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: 'é¦–æ¬¡è¯†åˆ«æ­¤æ¡å½¢ç ',\n\t\t\t\t\t\tcontent: 'ç³»ç»Ÿä¸­æš‚æ— æ­¤è¯æä¿¡æ¯\\n\\nè¯·é€‰æ‹©æ“ä½œæ–¹å¼ï¼š',\n\t\t\t\t\t\tconfirmText: 'æ‰‹åŠ¨æ–°å»º',\n\t\t\t\t\t\tcancelText: 'å–æ¶ˆ',\n\t\t\t\t\t\tsuccess: (modalRes) => {\n\t\t\t\t\t\t\tif (modalRes.confirm) {\n\t\t\t\t\t\t\t\t// æ¿€æ´»åˆ›å»ºè¡¨å•\n\t\t\t\t\t\t\t\tthis.newDrug.barcode = barcode\n\t\t\t\t\t\t\t\tthis.showCreateForm = true\n\t\t\t\t\t\t\t\tthis.createFormSource = 'manual'\n\t\t\t\t\t\t\t\tthis.searchKeyword = ''\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} catch (err) {\n\t\t\t\tuni.hideLoading()\n\t\t\t\tconsole.error('æŸ¥è¯¢å¤±è´¥:', err)\n\t\t\t\t\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\ttitle: 'æŸ¥è¯¢å¤±è´¥',\n\t\t\t\t\tcontent: 'æ¡å½¢ç æŸ¥è¯¢å¤±è´¥ï¼Œæ˜¯å¦æ‰‹åŠ¨æ–°å»ºè¯æï¼Ÿ',\n\t\t\t\t\t\tconfirmText: 'æ–°å»º',\n\t\t\t\t\t\tcancelText: 'å–æ¶ˆ',\n\t\t\t\t\t\tsuccess: (modalRes) => {\n\t\t\t\t\t\t\tif (modalRes.confirm) {\n\t\t\t\t\t\t\t\tthis.newDrug.barcode = barcode\n\t\t\t\t\t\t\t\tthis.showCreateDrug = true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\t\n\t\t// ========== æ–°å»ºè¯æ ==========\n\t\tonUnitChange(e) {\n\t\t\tthis.unitIndex = e.detail.value\n\t\t\tthis.newDrug.unit = this.unitOptions[e.detail.value]\n\t\t},\n\t\t\n\t\t// è¯­éŸ³è¾“å…¥æç¤ºï¼ˆä½¿ç”¨è¾“å…¥æ³•è¯­éŸ³åŠŸèƒ½ï¼‰\n\t\tstartVoiceInput(field) {\n\t\t\t// æ ¹æ®å­—æ®µæ˜¾ç¤ºä¸åŒæç¤º\n\t\t\tconst fieldNames = {\n\t\t\t\t'name': 'è¯æåç§°',\n\t\t\t\t'spec': 'è§„æ ¼'\n\t\t\t}\n\t\t\t\n\t\t\tuni.showModal({\n\t\t\t\ttitle: 'ğŸ’¡ è¯­éŸ³è¾“å…¥æç¤º',\n\t\t\t\tcontent: `è¯·ä½¿ç”¨è¾“å…¥æ³•çš„è¯­éŸ³åŠŸèƒ½ï¼š\\n\\n1. ç‚¹å‡»${fieldNames[field]}è¾“å…¥æ¡†\\n2. ç‚¹å‡»é”®ç›˜ä¸Šçš„ğŸ¤å›¾æ ‡\\n3. è¯´å‡º${fieldNames[field]}\\n4. ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«å¹¶å¡«å…¥\\n\\nå¾®ä¿¡ã€æœç‹—ç­‰è¾“å…¥æ³•éƒ½æ”¯æŒè¯­éŸ³è¾“å…¥`,\n\t\t\t\tshowCancel: false,\n\t\t\t\tconfirmText: 'çŸ¥é“äº†'\n\t\t\t})\n\t\t},\n\t\t\n\t\t// ========== è¡¨å•æ“ä½œ ==========\n\t\tonDateChange(index, field, value) {\n\t\t\tthis.drugList[index][field] = value\n\t\t\t\n\t\t\t// è®¡ç®—è·æœ‰æ•ˆæœŸå¤©æ•°\n\t\t\tif (this.drugList[index].expireDate) {\n\t\t\t\tconst expDate = new Date(this.drugList[index].expireDate)\n\t\t\t\tconst today = new Date()\n\t\t\t\tconst days = Math.floor((expDate - today) / (1000 * 60 * 60 * 24))\n\t\t\t\tthis.drugList[index].daysToExpiry = days\n\t\t\t}\n\t\t\t\n\t\t\tthis.validateRow(index)\n\t\t},\n\t\t\n\t\tcalculateAmount(index) {\n\t\t\tconst item = this.drugList[index]\n\t\t\tconst qty = Number(item.quantity) || 0\n\t\t\tconst price = Number(item.price) || 0\n\t\t\titem.amount = qty * price\n\t\t},\n\t\t\n\t\tvalidateRow(index) {\n\t\t\tconst item = this.drugList[index]\n\t\t\tlet hasError = false\n\t\t\t\n\t\t\tif (!item.batch || !item.productionDate || !item.expireDate || !item.quantity || item.quantity <= 0) {\n\t\t\t\thasError = true\n\t\t\t}\n\t\t\t\n\t\t\titem.hasError = hasError\n\t\t},\n\t\t\n\t\tformatAmount(amount) {\n\t\t\tif (!amount) return '0.00'\n\t\t\treturn Number(amount).toFixed(2)\n\t\t},\n\t\t\n\t\tdeleteDrug(index) {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: 'ç¡®è®¤åˆ é™¤',\n\t\t\t\tcontent: 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè¯æå—ï¼Ÿ',\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\tthis.drugList.splice(index, 1)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t\n\t\t// ========== æäº¤ ==========\n\t\tvalidateForm() {\n\t\t\tif (this.drugList.length === 0) {\n\t\t\t\tuni.showToast({ title: 'è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªè¯æ', icon: 'none' })\n\t\t\t\treturn false\n\t\t\t}\n\t\t\t\n\t\t\tfor (let i = 0; i < this.drugList.length; i++) {\n\t\t\t\tconst item = this.drugList[i]\n\t\t\t\tconst rowNum = i + 1\n\t\t\t\t\n\t\t\t\tif (!item.batch) {\n\t\t\t\t\tuni.showToast({ title: `ç¬¬${rowNum}è¡Œï¼šæ‰¹å·ä¸èƒ½ä¸ºç©º`, icon: 'none' })\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tif (!item.productionDate) {\n\t\t\t\t\tuni.showToast({ title: `ç¬¬${rowNum}è¡Œï¼šç”Ÿäº§æ—¥æœŸä¸èƒ½ä¸ºç©º`, icon: 'none' })\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tif (!item.expireDate) {\n\t\t\t\t\tuni.showToast({ title: `ç¬¬${rowNum}è¡Œï¼šæœ‰æ•ˆæœŸä¸èƒ½ä¸ºç©º`, icon: 'none' })\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tif (item.daysToExpiry !== null && item.daysToExpiry < 0) {\n\t\t\t\t\tuni.showToast({ title: `ç¬¬${rowNum}è¡Œï¼šè¯æå·²è¿‡æœŸï¼Œä¸èƒ½å…¥åº“`, icon: 'none' })\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tif (!item.quantity || item.quantity <= 0) {\n\t\t\t\t\tuni.showToast({ title: `ç¬¬${rowNum}è¡Œï¼šæ•°é‡å¿…é¡»å¤§äº0`, icon: 'none' })\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif (!this.operatorSign) {\n\t\t\t\tuni.showToast({ title: 'è¯·å…ˆç­¾å', icon: 'none' })\n\t\t\t\treturn false\n\t\t\t}\n\t\t\t\n\t\t\treturn true\n\t\t},\n\t\t\n\t\tasync submit() {\n\t\t\tif (!this.validateForm()) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\t\n\t\t\tuni.showLoading({ title: 'æäº¤ä¸­...', mask: true })\n\t\t\t\n\t\t\ttry {\n\t\t\t\tconst userInfo = uni.getStorageSync('userInfo')\n\t\t\t\t\n\t\t\t\tconst result = await wx.cloud.callFunction({\n\t\t\t\t\tname: 'inRecords',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\taction: 'create',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\trecordNo: this.recordNo,\n\t\t\t\t\t\tremark: this.remark,\n\t\t\t\t\t\t\titems: this.drugList.map(item => ({\n\t\t\t\t\t\t\t\tdrugId: item.drugId,\n\t\t\t\t\t\t\t\tdrugName: item.drugName,\n\t\t\t\t\t\t\t\tspecification: item.specification,\n\t\t\t\t\t\t\t\tspec: item.specification,\n\t\t\t\t\t\t\t\tunit: item.unit,\n\t\t\t\t\t\t\t\tmanufacturer: item.manufacturer,\n\t\t\t\t\t\t\t\tbatch: item.batch,\n\t\t\t\t\t\t\t\tproductionDate: item.productionDate,\n\t\t\t\t\t\t\t\texpireDate: item.expireDate,\n\t\t\t\t\t\t\t\tquantity: Number(item.quantity),\n\t\t\t\t\t\t\t\tprice: Number(item.price) || 0\n\t\t\t\t\t\t\t})),\n\t\t\t\t\t\toperator: this.operator,\n\t\t\t\t\t\toperatorId: userInfo?._id || '',\n\t\t\t\t\t\toperatorSign: this.operatorSign,\n\t\t\t\t\t\toperatorSignTime: new Date().toISOString(),\n\t\t\t\t\t\tstatus: 'pending_review'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tuni.hideLoading()\n\t\t\t\t\n\t\t\t\tif (result.result && result.result.success) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'æäº¤æˆåŠŸï¼Œç­‰å¾…å¤æ ¸',\n\t\t\t\t\t\ticon: 'success',\n\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t})\n\t\t\t\t\t\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tuni.navigateBack()\n\t\t\t\t\t}, 2000)\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(result.result?.message || 'æäº¤å¤±è´¥')\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} catch (err) {\n\t\t\t\tuni.hideLoading()\n\t\t\t\tconsole.error('æäº¤å¤±è´¥:', err)\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: err.message || 'æäº¤å¤±è´¥',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.page {\n\tmin-height: 100vh;\n\t/* ä½¿ç”¨ä¸é¦–é¡µ/é—¨è¯Š/è¯æå·¥ä½œå°ä¸€è‡´çš„è“è‰²æ¸å˜èƒŒæ™¯ */\n\tbackground: linear-gradient(180deg, #00c9ff 0%, #00a0ff 35%, #e5e7eb 100%);\n\tpadding: 24rpx 24rpx 40rpx;\n}\n\n// é¡µé¢å¤´éƒ¨\n.page-header {\n\t/* é¡¶éƒ¨æ ‡é¢˜åŒºåŸŸï¼šè±¡ç‰™ç™½åœ†è§’å¡ç‰‡ï¼Œå®½åº¦ä¸å…¶å®ƒå·¥ä½œå° header-card å¯¹é½ */\n\tmax-width: 702rpx;\n\tmargin: 10rpx auto 8rpx;\n\tpadding: 30rpx 26rpx 26rpx;\n\tbackground: #FFFFF0;\n\tborder-radius: 22rpx;\n\tbox-shadow:\n\t\t0 1rpx 0 rgba(255, 255, 255, 0.9) inset,\n\t\t0 -1rpx 0 rgba(15, 23, 42, 0.06) inset,\n\t\t0 18rpx 40rpx rgba(15, 23, 42, 0.14);\n\t\n\t.header-content {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tgap: 8rpx;\n\t\t\n\t\t.header-title {\n\t\t\tfont-size: 40rpx;\n\t\t\tfont-weight: bold;\n\t\t\tcolor: #111827;\n\t\t}\n\t\t\n\t\t.header-subtitle {\n\t\t\tfont-size: 24rpx;\n\t\t\tcolor: #4b5563;\n\t\t}\n\t}\n}\n\n// ä¿¡æ¯å¡ç‰‡\n.info-card {\n\tmax-width: 702rpx;\n\tmargin: 0 auto 8rpx;\n\tpadding: 26rpx 26rpx 24rpx;\n\tbackground: #FFFFF0;\n\tborder-radius: 22rpx;\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\n\t\n\t.info-row {\n\t\tdisplay: flex;\n\t\tgap: 20rpx;\n\t\tmargin-bottom: 20rpx;\n\t\t\n\t\t&:last-child {\n\t\t\tmargin-bottom: 0;\n\t\t}\n\t\t\n\t\t.info-item {\n\t\t\tflex: 1;\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tgap: 12rpx;\n\t\t\t\n\t\t\t&.full {\n\t\t\t\tflex: 1 1 100%;\n\t\t\t}\n\t\t\t\n\t\t\t.label {\n\t\t\t\tfont-size: 24rpx;\n\t\t\t\tcolor: #646566;\n\t\t\t}\n\t\t\t\n\t\t\t.value {\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #323233;\n\t\t\t\tfont-weight: 500;\n\t\t\t}\n\t\t\t\n\t\t\t.input-value {\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #323233;\n\t\t\t\tborder-bottom: 1rpx solid #ebedf0;\n\t\t\t\tpadding: 8rpx 0;\n\t\t\t}\n\t\t}\n\t}\n}\n\n// æ™ºèƒ½æœç´¢æ¡†\n.search-card {\n\tmax-width: 702rpx;\n\tmargin: 0 auto 4rpx;\n\tposition: relative;\n\tpadding-bottom: 8rpx;\n}\n\n.search-wrapper {\n\tdisplay: flex;\n\talign-items: center;\n\tbackground: #ffffff;\n\tborder-radius: 50rpx;\n\tpadding: 0 24rpx;\n\tbox-shadow: 0 2rpx 12rpx rgba(15, 23, 42, 0.06);\n\ttransition: all 0.3s;\n\t\n\t&.focused {\n\t\tbox-shadow: 0 4rpx 20rpx rgba(7, 193, 96, 0.15);\n\t\tborder: 2rpx solid #07C160;\n\t}\n\t\n\t.search-icon-wrapper {\n\t\tmargin-right: 16rpx;\n\t\t\n\t\t.search-icon {\n\t\t\tfont-size: 32rpx;\n\t\t}\n\t}\n\t\n\t.search-input {\n\t\tflex: 1;\n\t\theight: 88rpx;\n\t\tfont-size: 28rpx;\n\t\tcolor: #323233;\n\t}\n\t\n\t.clear-icon {\n\t\twidth: 40rpx;\n\t\theight: 40rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tmargin-right: 16rpx;\n\t\t\n\t\ttext {\n\t\t\tfont-size: 28rpx;\n\t\t\tcolor: #969799;\n\t\t}\n\t}\n\t\n\t.scan-btn {\n\t\twidth: 56rpx;\n\t\theight: 56rpx;\n\t\tbackground: linear-gradient(135deg, #00c9ff 0%, #00a0ff 100%);\n\t\tborder-radius: 50%;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\ttransition: all 0.3s ease;\n\t\tbox-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.04);\n\t\t\n\t\t&:active {\n\t\t\ttransform: scale(0.95);\n\t\t\tbox-shadow: 0 1rpx 4rpx rgba(0, 0, 0, 0.2);\n\t\t}\n\t\t\n\t\t.scan-icon-frame {\n\t\t\twidth: 24rpx;\n\t\t\theight: 24rpx;\n\t\t\tposition: relative;\n\t\t\tbackground: \n\t\t\t\tlinear-gradient(#fff, #fff) 0 0 / 3rpx 10rpx,\n\t\t\t\tlinear-gradient(#fff, #fff) 0 0 / 10rpx 3rpx,\n\t\t\t\tlinear-gradient(#fff, #fff) 100% 0 / 3rpx 10rpx,\n\t\t\t\tlinear-gradient(#fff, #fff) 100% 0 / 10rpx 3rpx,\n\t\t\t\tlinear-gradient(#fff, #fff) 0 100% / 3rpx 10rpx,\n\t\t\t\tlinear-gradient(#fff, #fff) 0 100% / 10rpx 3rpx,\n\t\t\t\tlinear-gradient(#fff, #fff) 100% 100% / 3rpx 10rpx,\n\t\t\t\tlinear-gradient(#fff, #fff) 100% 100% / 10rpx 3rpx;\n\t\t\tbackground-repeat: no-repeat;\n\t\t}\n\t}\n}\n\n// æœç´¢ç»“æœ\n.search-results {\n\tposition: absolute;\n\ttop: 100%;\n\tleft: 0;\n\tright: 0;\n\tbackground: white;\n\tborder-radius: 16rpx;\n\tmargin-top: 12rpx;\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\n\tmax-height: 0;\n\toverflow: hidden;\n\tz-index: 100;\n\topacity: 0;\n\ttransition: max-height 0.25s cubic-bezier(0.4, 0, 0.2, 1), \n\t            opacity 0.2s ease-out,\n\t            transform 0.25s cubic-bezier(0.4, 0, 0.2, 1);\n\ttransform: translateY(-10rpx);\n\t\n\t&.show {\n\tmax-height: 600rpx;\n\t\topacity: 1;\n\toverflow-y: auto;\n\t\ttransform: translateY(0);\n\t}\n\t\n\t.result-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding: 24rpx 30rpx;\n\t\tborder-bottom: 1rpx solid #ebedf0;\n\t\t\n\t\t&:last-child {\n\t\t\tborder-bottom: none;\n\t\t}\n\t\t\n\t\t&:active {\n\t\t\tbackground: #f7f8fa;\n\t\t}\n\t\t\n\t\t.drug-info {\n\t\t\tflex: 1;\n\t\t\t\n\t\t\t.drug-name {\n\t\t\t\tdisplay: block;\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #323233;\n\t\t\t\tfont-weight: 500;\n\t\t\t\tmargin-bottom: 8rpx;\n\t\t\t}\n\t\t\t\n\t\t\t.drug-spec {\n\t\t\t\tdisplay: block;\n\t\t\t\tfont-size: 24rpx;\n\t\t\t\tcolor: #969799;\n\t\t\t}\n\t\t}\n\t\t\n\t\t.select-icon {\n\t\t\tfont-size: 40rpx;\n\t\t\tcolor: #c8c9cc;\n\t\t}\n\t}\n}\n\n// APIæœç´¢ä¸­\n.api-searching {\n\tposition: absolute;\n\ttop: 100%;\n\tleft: 0;\n\tright: 0;\n\tbackground: white;\n\tborder-radius: 16rpx;\n\tmargin-top: 12rpx;\n\tpadding: 40rpx 30rpx;\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\n\ttext-align: center;\n\tz-index: 100;\n\t\n\t.loading-wrapper {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tgap: 16rpx;\n\t\t\n\t\t.loading-icon {\n\t\t\tfont-size: 48rpx;\n\t\t\tanimation: rotate 2s linear infinite;\n\t\t}\n\t\t\n\t\t.loading-text {\n\t\t\tfont-size: 26rpx;\n\t\t\tcolor: #969799;\n\t\t}\n\t}\n}\n\n@keyframes rotate {\n\tfrom { transform: rotate(0deg); }\n\tto { transform: rotate(360deg); }\n}\n\n// å†…è”åˆ›å»ºè¡¨å•\n.create-form-inline {\n\tposition: absolute;\n\ttop: 100%;\n\tleft: 0;\n\tright: 0;\n\tbackground: white;\n\tborder-radius: 16rpx;\n\tmargin-top: 12rpx;\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\n\tz-index: 100;\n\tanimation: slideDown 0.3s ease;\n\t\n\t.create-tip {\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tgap: 16rpx;\n\t\tpadding: 30rpx;\n\t\tborder-radius: 16rpx 16rpx 0 0;\n\t\t\n\t\t&.tip-success {\n\t\t\tbackground: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);\n\t\t}\n\t\t\n\t\t&.tip-warning {\n\t\t\tbackground: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);\n\t\t}\n\t\t\n\t\t.tip-icon {\n\t\t\tfont-size: 40rpx;\n\t\t}\n\t\t\n\t\t.tip-content {\n\t\t\tflex: 1;\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tgap: 8rpx;\n\t\t\t\n\t\t\t.tip-title {\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tfont-weight: 500;\n\t\t\t\tcolor: #323233;\n\t\t\t}\n\t\t\t\n\t\t\t.tip-subtitle {\n\t\t\t\tfont-size: 24rpx;\n\t\t\t\tcolor: #969799;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t.inline-form {\n\t\tpadding: 30rpx;\n\t\t\n\t\t.inline-form-title {\n\t\t\tfont-size: 30rpx;\n\t\t\tfont-weight: bold;\n\t\t\tcolor: #323233;\n\t\t\tmargin-bottom: 24rpx;\n\t\t}\n\t\t\n\t\t.inline-form-item {\n\t\t\tmargin-bottom: 24rpx;\n\t\t\t\n\t\t\t.inline-label {\n\t\t\t\tdisplay: block;\n\t\t\t\tfont-size: 26rpx;\n\t\t\t\tcolor: #646566;\n\t\t\t\tmargin-bottom: 12rpx;\n\t\t\t\t\n\t\t\t\t.required {\n\t\t\t\t\tcolor: #ee0a24;\n\t\t\t\t\tmargin-left: 4rpx;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t.inline-input {\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 80rpx;\n\t\t\t\tpadding: 0 20rpx;\n\t\t\t\tbackground: #f7f8fa;\n\t\t\t\tborder-radius: 12rpx;\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #323233;\n\t\t\t\tborder: 2rpx solid transparent;\n\t\t\t\ttransition: all 0.3s;\n\t\t\t\t\n\t\t\t\t&:focus {\n\t\t\t\t\tbackground: white;\n\t\t\t\t\tborder-color: #07C160;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// è¯­éŸ³è¾“å…¥å®¹å™¨\n\t\t\t.input-with-voice {\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tgap: 16rpx;\n\t\t\t\t\n\t\t\t\t.voice-input {\n\t\t\t\t\tflex: 1;\n\t\t\t\t\twidth: auto;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.voice-btn {\n\t\t\t\t\tflex-shrink: 0;\n\t\t\t\t\twidth: 80rpx;\n\t\t\t\t\theight: 80rpx;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n\t\t\t\t\tborder-radius: 12rpx;\n\t\t\t\t\tbox-shadow: 0 4rpx 12rpx rgba(102, 126, 234, 0.3);\n\t\t\t\t\ttransition: all 0.3s;\n\t\t\t\t\t\n\t\t\t\t\t&:active {\n\t\t\t\t\t\ttransform: scale(0.95);\n\t\t\t\t\t\tbox-shadow: 0 2rpx 8rpx rgba(102, 126, 234, 0.4);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t.voice-icon {\n\t\t\t\t\t\tfont-size: 36rpx;\n\t\t\t\t\t\tfilter: brightness(0) invert(1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t.inline-picker {\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: space-between;\n\t\t\t\theight: 80rpx;\n\t\t\t\tpadding: 0 20rpx;\n\t\t\t\tbackground: #f7f8fa;\n\t\t\t\tborder-radius: 12rpx;\n\t\t\t\t\n\t\t\t\t.picker-text {\n\t\t\t\t\tfont-size: 28rpx;\n\t\t\t\t\tcolor: #323233;\n\t\t\t\t\t\n\t\t\t\t\t&.picker-placeholder {\n\t\t\t\t\t\tcolor: #c8c9cc;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.picker-arrow {\n\t\t\t\t\tfont-size: 20rpx;\n\t\t\t\t\tcolor: #969799;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t.inline-form-actions {\n\t\t\tdisplay: flex;\n\t\t\tgap: 20rpx;\n\t\t\tmargin-top: 32rpx;\n\t\t\t\n\t\t\t.inline-btn {\n\t\t\t\tflex: 1;\n\t\t\t\theight: 88rpx;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: center;\n\t\t\t\tborder-radius: 44rpx;\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tfont-weight: 500;\n\t\t\t\t\n\t\t\t\t&.btn-cancel {\n\t\t\t\t\tbackground: #f7f8fa;\n\t\t\t\t\tcolor: #646566;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t&.btn-confirm {\n\t\t\t\t\tbackground: linear-gradient(135deg, #07C160 0%, #05a550 100%);\n\t\t\t\t\tcolor: white;\n\t\t\t\t\tbox-shadow: 0 4rpx 12rpx rgba(7, 193, 96, 0.3);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n@keyframes slideDown {\n\tfrom {\n\t\topacity: 0;\n\t\ttransform: translateY(-20rpx);\n\t}\n\tto {\n\t\topacity: 1;\n\t\ttransform: translateY(0);\n\t}\n}\n\n// è¯æåˆ—è¡¨\n.drug-list-section {\n\tmax-width: 702rpx;\n\tmargin: 0 auto;\n\ttransition: all 0.3s ease;\n}\n\n.section-header {\n\tmax-width: 702rpx;\n\tmargin: 0 auto 8rpx;\n\tpadding: 18rpx 22rpx;\n\tbackground: #FFFFF0;\n\tborder-radius: 22rpx;\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\t\n\t.section-title {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #111827;\n\t}\n\t\n\t.section-count {\n\t\tfont-size: 24rpx;\n\t\tcolor: #4b5563;\n\t\tpadding: 6rpx 16rpx;\n\t\tbackground: #ffffff;\n\t\tborder-radius: 999rpx;\n\t}\n}\n\n.drug-cards {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 0;\n}\n\n.drug-card {\n\tmax-width: 702rpx;\n\tmargin: 0 auto 8rpx;\n\tpadding: 24rpx;\n\tbackground: #FFFFF0;\n\tborder-radius: 22rpx;\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\n\t\n\t// æ·»åŠ å¹³æ»‘çš„å…¥åœºåŠ¨ç”»\n\tanimation: slideInFromTop 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n\t\n\t&.has-error {\n\t\tborder-left: 4rpx solid #ee0a24;\n\t}\n}\n\n// ä»é¡¶éƒ¨æ»‘å…¥çš„åŠ¨ç”»\n@keyframes slideInFromTop {\n\t0% {\n\t\topacity: 0;\n\t\ttransform: translateY(-20rpx);\n\t}\n\t100% {\n\t\topacity: 1;\n\t\ttransform: translateY(0);\n\t}\n}\n\n.card-header {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: flex-start;\n\tmargin-bottom: 20rpx;\n\tpadding-bottom: 20rpx;\n\tborder-bottom: 1rpx solid #ebedf0;\n\t\n\t.drug-name-wrapper {\n\t\tflex: 1;\n\t\t\n\t\t.drug-name {\n\t\t\tdisplay: block;\n\t\t\tfont-size: 30rpx;\n\t\t\tfont-weight: bold;\n\t\t\tcolor: #323233;\n\t\t\tmargin-bottom: 8rpx;\n\t\t}\n\t\t\n\t\t.drug-spec {\n\t\t\tdisplay: block;\n\t\t\tfont-size: 24rpx;\n\t\t\tcolor: #646566;\n\t\t}\n\t}\n\t\n\t.delete-btn {\n\t\twidth: 48rpx;\n\t\theight: 48rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tbackground: #f7f8fa;\n\t\tborder-radius: 50%;\n\t\t\n\t\t.delete-icon {\n\t\t\tfont-size: 32rpx;\n\t\t\tcolor: #ee0a24;\n\t\t}\n\t}\n}\n\n.card-form {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 20rpx;\n}\n\n.form-item {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 12rpx;\n\t\n\t&.half {\n\t\tflex: 1;\n\t}\n\t\n\t&.third {\n\t\tflex: 1;\n\t\tmin-width: 0; // é˜²æ­¢å†…å®¹æº¢å‡º\n\t}\n\t\n\t.form-label {\n\t\tfont-size: 24rpx;\n\t\tcolor: #646566;\n\t\t\n\t\t.required {\n\t\t\tcolor: #ee0a24;\n\t\t}\n\t}\n\t\n\t.form-input {\n\t\theight: 72rpx;\n\t\tpadding: 0 24rpx;\n\t\tbackground: #f7f8fa;\n\t\tborder-radius: 12rpx;\n\t\tfont-size: 28rpx;\n\t\tcolor: #323233;\n\t\tborder: 2rpx solid transparent;\n\t\t\n\t\t&:focus {\n\t\t\tbackground: white;\n\t\t\tborder-color: #07C160;\n\t\t}\n\t}\n\t\n\t.picker-input {\n\t\theight: 72rpx;\n\t\tpadding: 0 24rpx;\n\t\tbackground: #f7f8fa;\n\t\tborder-radius: 12rpx;\n\t\tfont-size: 28rpx;\n\t\tcolor: #c8c9cc;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\t\n\t\t&.has-value {\n\t\t\tcolor: #323233;\n\t\t}\n\t}\n\t\n\t.input-with-unit {\n\t\tposition: relative;\n\t\t\n\t\t.form-input {\n\t\t\tpadding-right: 80rpx;\n\t\t}\n\t\t\n\t\t.unit-text {\n\t\t\tposition: absolute;\n\t\t\tright: 24rpx;\n\t\t\ttop: 50%;\n\t\t\ttransform: translateY(-50%);\n\t\t\tfont-size: 24rpx;\n\t\t\tcolor: #969799;\n\t\t}\n\t}\n}\n\n.form-row {\n\tdisplay: flex;\n\tgap: 20rpx;\n\talign-items: flex-end; // è®©è·æœ‰æ•ˆæœŸæ ‡ç­¾åº•éƒ¨å¯¹é½\n\tflex-wrap: wrap; // å°å±å¹•æ—¶å…è®¸æ¢è¡Œ\n}\n\n.expiry-badge {\n\tdisplay: inline-flex;\n\talign-items: center;\n\tpadding: 8rpx 16rpx;\n\tborder-radius: 8rpx;\n\tfont-size: 22rpx;\n\tfont-weight: 500;\n\t\n\t&.safe {\n\t\tbackground: #d1fae5;\n\t\tcolor: #065f46;\n\t}\n\t\n\t&.warning {\n\t\tbackground: #fef3c7;\n\t\tcolor: #92400e;\n\t}\n\t\n\t&.danger {\n\t\tbackground: #fee2e2;\n\t\tcolor: #991b1b;\n\t}\n\t\n\t&.expired {\n\t\tbackground: #fee2e2;\n\t\tcolor: #991b1b;\n\t}\n}\n\n// è¡Œå†…æ˜¾ç¤ºçš„è·æœ‰æ•ˆæœŸæ ‡ç­¾\n.expiry-badge-inline {\n\tdisplay: inline-flex;\n\talign-items: center;\n\tpadding: 8rpx 16rpx;\n\tborder-radius: 8rpx;\n\tfont-size: 22rpx;\n\tfont-weight: 500;\n\tmargin-bottom: 12rpx; // ä¸è¾“å…¥æ¡†åº•éƒ¨å¯¹é½\n\twhite-space: nowrap; // ä¸æ¢è¡Œ\n\t\n\t&.safe {\n\t\tbackground: #d1fae5;\n\t\tcolor: #065f46;\n\t}\n\t\n\t&.warning {\n\t\tbackground: #fef3c7;\n\t\tcolor: #92400e;\n\t}\n\t\n\t&.danger {\n\t\tbackground: #fee2e2;\n\t\tcolor: #991b1b;\n\t}\n\t\n\t&.expired {\n\t\tbackground: #fee2e2;\n\t\tcolor: #991b1b;\n\t}\n}\n\n.amount-display {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 8rpx;\n\tpadding: 16rpx 24rpx;\n\tbackground: #f7f8fa;\n\tborder-radius: 12rpx;\n\t\n\t.amount-label {\n\t\tfont-size: 24rpx;\n\t\tcolor: #646566;\n\t}\n\t\n\t.amount-value {\n\t\tfont-size: 28rpx;\n\t\tcolor: #ee0a24;\n\t\tfont-weight: bold;\n\t}\n}\n\n// ç©ºçŠ¶æ€\n.empty-state {\n\ttext-align: center;\n\tpadding: 100rpx 0;\n\t\n\t.empty-icon {\n\t\tfont-size: 100rpx;\n\t\tdisplay: block;\n\t\tmargin-bottom: 20rpx;\n\t}\n\t\n\t.empty-text {\n\t\tfont-size: 28rpx;\n\t\tcolor: #969799;\n\t\tdisplay: block;\n\t\tmargin-bottom: 10rpx;\n\t}\n\t\n\t.empty-hint {\n\t\tfont-size: 24rpx;\n\t\tcolor: #c8c9cc;\n\t\tdisplay: block;\n\t}\n}\n\n// ç­¾ååŒºåŸŸï¼ˆåŒ…å«åˆè®¡å’Œç­¾åï¼‰\n.signature-section {\n\tmax-width: 702rpx;\n\tmargin: 0 auto 8rpx;\n\tpadding-bottom: 0;\n}\n\n// åˆè®¡å¡ç‰‡\n.summary-card {\n\tmax-width: 702rpx;\n\tmargin: 0 auto 8rpx;\n\tpadding: 24rpx 26rpx;\n\tbackground: #FFFFF0;\n\tborder-radius: 22rpx;\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\n\tdisplay: flex;\n\tjustify-content: space-around;\n\t\n\t.summary-item {\n\t\ttext-align: center;\n\t\t\n\t\t.summary-label {\n\t\t\tdisplay: block;\n\t\t\tfont-size: 24rpx;\n\t\t\tcolor: #6b7280;\n\t\t\tmargin-bottom: 12rpx;\n\t\t}\n\t\t\n\t\t.summary-value {\n\t\t\tdisplay: block;\n\t\t\tfont-size: 32rpx;\n\t\t\tfont-weight: bold;\n\t\t\tcolor: #111827;\n\t\t}\n\t\t\n\t\t&.highlight .summary-value {\n\t\t\tfont-size: 36rpx;\n\t\t}\n\t}\n}\n\n// ç­¾åå¡ç‰‡\n.signature-card {\n\tmax-width: 702rpx;\n\tmargin: 0 auto 8rpx;\n\tpadding: 30rpx;\n\tbackground: white;\n\tborder-radius: 22rpx;\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\n\tborder: 2rpx solid #ebedf0;\n\t\n\t.signature-header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8rpx;\n\t\tmargin-bottom: 20rpx;\n\t\t\n\t\t.signature-title {\n\t\t\tfont-size: 28rpx;\n\t\t\tfont-weight: bold;\n\t\t\tcolor: #323233;\n\t\t}\n\t\t\n\t\t.required {\n\t\t\tcolor: #ee0a24;\n\t\t}\n\t\t}\n\t}\n\t\n// æäº¤æŒ‰é’®å®¹å™¨\n.submit-btn-container {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\tpadding: 0 30rpx 20rpx;\n\t\t\n\t.submit-btn {\n\t\t\twidth: 100%;\n\t\theight: 88rpx;\n\t\tbackground: linear-gradient(135deg, #07C160 0%, #05a550 100%);\n\t\tborder-radius: 50rpx;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\tgap: 12rpx;\n\t\tbox-shadow: 0 4rpx 16rpx rgba(7, 193, 96, 0.25);\n\t\tposition: relative;\n\t\toverflow: hidden;\n\t\t\n\t\t// å¾®ä¿¡é£æ ¼çš„å…‰æ³½æ•ˆæœ\n\t\t&::before {\n\t\t\tcontent: '';\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\t\t\theight: 50%;\n\t\t\tbackground: linear-gradient(180deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0) 100%);\n\t\t\tborder-radius: 50rpx 50rpx 0 0;\n}\n\n\t\t.submit-icon {\n\t\t\twidth: 48rpx;\n\t\t\theight: 48rpx;\n\t\t\tbackground: rgba(255, 255, 255, 0.2);\n\t\t\tborder-radius: 50%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\t\t\tfont-size: 32rpx;\n\t\t\tcolor: white;\n\t\t\tfont-weight: bold;\n\t\t\tz-index: 1;\n\t\t}\n\t\t\n\t\t.submit-text {\n\t\t\tcolor: white;\n\t\t\tfont-size: 32rpx;\n\t\t\tfont-weight: 500;\n\t\t\tz-index: 1;\n\t}\n\t\n\t&:active {\n\t\ttransform: scale(0.98);\n\t\t\tbox-shadow: 0 2rpx 8rpx rgba(7, 193, 96, 0.3);\n\t\t}\n\t}\n}\n\n// å ä½ç¬¦æ ·å¼\n.placeholder {\n\tcolor: #c8c9cc;\n}\n</style>\n","import mod from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=style&index=0&id=58f3a51d&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=style&index=0&id=58f3a51d&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1767329757567\n      var cssReload = require(\"D:/HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}