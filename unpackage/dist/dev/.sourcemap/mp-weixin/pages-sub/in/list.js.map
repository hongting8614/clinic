{"version":3,"sources":["uni-app:///main.js","webpack:///D:/AK-PMS/pages-sub/in/list.vue?4319","webpack:///D:/AK-PMS/pages-sub/in/list.vue?1d54","webpack:///D:/AK-PMS/pages-sub/in/list.vue?57cb","webpack:///D:/AK-PMS/pages-sub/in/list.vue?a370","uni-app:///pages-sub/in/list.vue","webpack:///D:/AK-PMS/pages-sub/in/list.vue?4987","webpack:///D:/AK-PMS/pages-sub/in/list.vue?5772"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","FilterPanel","data","currentTime","recordList","page","pageSize","hasMore","currentUserId","statusFilter","statusList","label","value","statusCounts","all","draft","pending_review","completed","rejected","statsData","today","thisWeek","thisMonth","pending","statusSummary","searchKeyword","searchTimer","startDate","endDate","selectedQuickFilter","quickFilters","onLoad","computed","statusLabel","totalDrugs","record","drugSet","dateFilterText","onShow","onPullDownRefresh","setTimeout","uni","methods","initPage","console","hasUserInfo","userRole","updateCurrentTime","loadRecords","isFirstLoad","action","status","keyword","result","newData","filterByKeyword","drug","loadCounts","loadStats","fallbackStats","countsResult","resetFilters","generateList","changeStatusFilter","type","refreshList","silentRefresh","loadMore","getStatusText","canReview","itemStatus","operatorId","isSameUser","hasPermission","goDetail","url","goReview","goReport","goAdd","onKeywordUpdate","onStartDateUpdate","onEndDateUpdate","onDateRangeChange","end","selectQuickFilter","weekStart","formatDate","getMockData","_id","recordNo","operator","createTime","items","drugName","spec","quantity","reviewer","reviewerId","completeTime","rejectReason"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,aAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6H;AAC7H;AACwD;AACL;AACsC;;;AAGzF;AAC0K;AAC1K,gBAAgB,uLAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,2FAAM;AACR,EAAE,oGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,+FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,2LAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC3DA;AAAA;AAAA;AAAA;AAAooB,CAAgB,gqBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;eC6HxpB;EACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC,aACA;QAAAC;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,EACA;MAEA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;QACAV;QACAC;QACAC;QACAC;QACAC;MACA;MACA;MACAO;MACAC;MACA;MACAC;MACAC;MACAC;MACAC,eACA;QAAAnB;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA;IAEA;EACA;EAEAmB;IACA;IACA;MACA;IACA;IACA;EACA;EAEAC;IACA;IACAC;MAAA;MACA;QAAA;MAAA;MACA;IACA;IACA;IACAC;MACA;MACA;QACA;UACAC;YACAC;UACA;QACA;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;MACA;QACA;MACA;MACA;QACA;MACA;MACA;QACA;MACA;MACA;QACA;MACA;MACA;QACA;MACA;MACA;QACA;MACA;MACA;IACA;EACA;EAEAC;IACA;IACA;IACA;MACA;IACA;EACA;EAEA;EACAC;IACA;IACAC;MACAC;IACA;EACA;EAEAC;IACAC;MACA;MACA;MACA;MAEAC;QACAC;QACArC;QACAsC;MACA;;MAEA;MACA;MAEA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;MACA;IACA;IAEAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBACAC;gBAAA;gBAAA;gBAAA,OAIA;kBACAC;kBACAhD;oBACAiD;oBACA9C;oBACAC;oBACA8C;oBACAzB;oBACAC;kBACA;gBACA;cAAA;gBAVAyB;gBAUA;;gBAEA;gBACA;kBACAC,6BAEA;kBACA;oBACAA;kBACA;kBACA;kBACA;oBACAA;sBAAA;oBAAA;kBACA;kBAEA;kBACA;gBACA;kBACA;kBACAA;kBACA;oBACAA;kBACA;kBACA;oBACAA;sBAAA;oBAAA;kBACA;kBACA;kBACA;gBACA;kBACA;kBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAV;gBACA;gBACA;gBACA;kBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAW;MACA;MACA;MACA;QACA;QACA;UACA;QACA;QACA;QACA;UACA;YAAA,OACAC;UAAA,EACA;QACA;QACA;MACA;IACA;IAEAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEA;kBACAP;kBACAhD;gBACA;cAAA;gBAHAmD;gBAGA;;gBAEA;kBACA;kBACA;oBACAvC;oBACAC;oBACAC;oBACAC;oBACAC;kBACA;kBACA;kBACA;gBACA;kBACA;oBACAJ;oBACAC;oBACAC;oBACAC;oBACAC;kBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEA0B;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAc;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAGA;kBACAR;kBACAhD;gBACA;cAAA;gBAHAmD;gBAGA;;gBAEA;kBACA;oBACAjC;oBACAC;oBACAC;oBACAC;kBACA;gBACA;kBACA;kBACA;oBACAH;oBACAC;oBACAC;oBACAC;kBACA;gBACA;kBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAqB;gBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAe;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEA;kBACAT;kBACAhD;gBACA;cAAA;gBAHA0D;gBAGA;;gBAEA;kBACA;kBACA;kBACA;kBACA;kBACA;gBACA;kBACA;kBACA;kBACA;kBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAhB;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAiB;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;MACA;MACA;;MAEA;MACAtB;QAAAuB;MAAA;IACA;IAEAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;IACA;IAEAC;MACA;QACArD;QACAC;QACAC;QACAC;MACA;MACA;IACA;IAEAmD;MACA;MACAzB;QACA0B;QACAC;QACA/D;QACAgE;MACA;MAEA;QACA5B;QACA;MACA;;MAEA;MACA;MACA;MACA;MAEAA;QACAE;QACA2B;MACA;MAEA;IACA;IAEAC;MACA;MACA;QACA;MACA;QACAjC;UACAkC;QACA;MACA;IACA;IAEAC;MACAnC;QACAkC;MACA;IACA;IAEAE;MACApC;QACAkC;MACA;IACA;IAEAG;MACArC;QACAkC;MACA;IACA;IAEA;IACAI;MAAA;MACA;MACA;MACA;QAAA;MAAA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MAAA;QAAAC;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MAEA;QACA;UACA;UACA;UACA;QACA;UACA;UACA;UACA;QACA;UACA;UACAC;UACA;UACA;UACA;QACA;UACA;UACA;UACA;UACA;QACA;UACA;UACA;MAAA;MAEA;QACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;IACA;IAEA;IACAC;MAAA;MACA;MACA,gBACA;QACAC;QACAC;QACAtC;QACAuC;QACAnB;QACAoB;QACAC,QACA;UAAAC;UAAAC;UAAAC;QAAA,GACA;UAAAF;UAAAC;UAAAC;QAAA;MAEA,GACA;QACAP;QACAC;QACAtC;QACAuC;QACAnB;QACAyB;QACAC;QACAN;QACAO;QACAN,QACA;UAAAC;UAAAC;UAAAC;QAAA;MAEA,GACA;QACAP;QACAC;QACAtC;QACAuC;QACAnB;QACAoB;QACAC,QACA;UAAAC;UAAAC;UAAAC;QAAA;MAEA,GACA;QACAP;QACAC;QACAtC;QACAuC;QACAnB;QACAyB;QACAC;QACAN;QACAQ;QACAP,QACA;UAAAC;UAAAC;UAAAC;QAAA;MAEA,EACA;;MAEA;MACA;QACA;MACA;MACA;QAAA;MAAA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC3rBA;AAAA;AAAA;AAAA;AAAmuC,CAAgB,+sCAAG,EAAC,C;;;;;;;;;;;ACAvvC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages-sub/in/list.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages-sub/in/list.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./list.vue?vue&type=template&id=61ff7e52&scoped=true&\"\nvar renderjs\nimport script from \"./list.vue?vue&type=script&lang=js&\"\nexport * from \"./list.vue?vue&type=script&lang=js&\"\nimport style0 from \"./list.vue?vue&type=style&index=0&id=61ff7e52&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"61ff7e52\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages-sub/in/list.vue\"\nexport default component.exports","export * from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./list.vue?vue&type=template&id=61ff7e52&scoped=true&\"","var components\ntry {\n  components = {\n    filterPanel: function () {\n      return import(\n        /* webpackChunkName: \"components/filter-panel/index\" */ \"@/components/filter-panel/index.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. ÊéíÊü•ÁªÑ‰ª∂ÂêçÁß∞ÊãºÂÜôÊòØÂê¶Ê≠£Á°Æ\")\n    console.error(\n      \"2. ÊéíÊü•ÁªÑ‰ª∂ÊòØÂê¶Á¨¶Âêà easycom ËßÑËåÉÔºåÊñáÊ°£Ôºöhttps://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. Ëã•ÁªÑ‰ª∂‰∏çÁ¨¶Âêà easycom ËßÑËåÉÔºåÈúÄÊâãÂä®ÂºïÂÖ•ÔºåÂπ∂Âú® components ‰∏≠Ê≥®ÂÜåËØ•ÁªÑ‰ª∂\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.recordList.length\n  var l0 = _vm.__map(_vm.recordList, function (item, __i1__) {\n    var $orig = _vm.__get_orig(item)\n    var m0 = _vm.getStatusText(item.status)\n    var g1 = item.items.length\n    var m1 = item.status === \"pending_review\" && _vm.canReview(item)\n    return {\n      $orig: $orig,\n      m0: m0,\n      g1: g1,\n      m1: m1,\n    }\n  })\n  var g2 = _vm.recordList.length\n  var g3 = !_vm.hasMore ? _vm.recordList.length : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        l0: l0,\n        g2: g2,\n        g3: g3,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./list.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./list.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"container\">\n\t\t<!-- È°µÈù¢Â§¥ÈÉ® -->\n\t\t<view class=\"page-header\">\n\t\t<view class=\"page-header-title\">\n\t\t\t\t<text class=\"page-title\">ÂÖ•Â∫ìÁÆ°ÁêÜ</text>\n\t\t\t</view>\n\t\t\t<view class=\"page-actions\">\n\t\t\t\t<view class=\"header-btn primary\" @tap=\"goAdd\">Êñ∞Âª∫ÂÖ•Â∫ìÂçï</view>\n\t\t\t<view class=\"header-btn ghost\" @tap=\"resetFilters\">ÈáçÁΩÆ</view>\n\t\t\t<view class=\"header-btn ghost\" @tap=\"generateList\">Êü•ËØ¢</view>\n\t\t</view>\n\t</view>\n\t\n\t<!-- Áä∂ÊÄÅÁ≠õÈÄâTabÊ†èÔºàÊñ∞ËÆæËÆ°Ôºâ-->\n\t<view class=\"status-tabs\">\n\t\t<view \n\t\t\tv-for=\"status in statusList\" \n\t\t\t:key=\"status.value\"\n\t\t\tclass=\"status-tab\"\n\t\t\t:class=\"{ active: statusFilter === status.value }\"\n\t\t\t@tap=\"changeStatusFilter(status.value)\"\n\t\t>\n\t\t\t<text class=\"status-name\">{{ status.label }}</text>\n\t\t\t<text class=\"count\" v-if=\"statusCounts[status.value] !== undefined\">\n\t\t\t\t{{ statusCounts[status.value] }}\n\t\t\t</text>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<filter-panel\n\t\t\tclass=\"panel-wrapper\"\n\t\t\t:keyword=\"searchKeyword\"\n\t\tkeyword-placeholder=\"ÊêúÁ¥¢ÂçïÂè∑/ËçØÊùêÂêçÁß∞\"\n\t\t\t:show-date=\"true\"\n\t\t\t:start-date=\"startDate\"\n\t\t\t:end-date=\"endDate\"\n\t\t\t:quick-filters=\"quickFilters\"\n\t\t\t:active-quick-filter=\"selectedQuickFilter\"\n\t\t\t:show-search-button=\"false\"\n\t\t\t@update:keyword=\"onKeywordUpdate\"\n\t\t\t@update:startDate=\"onStartDateUpdate\"\n\t\t\t@update:endDate=\"onEndDateUpdate\"\n\t\t\t@quick-filter=\"selectQuickFilter\"\n\t\t\t@date-change=\"onDateRangeChange\"\n\t\t\t@search=\"generateList\"\n\t\t>\n\t\t</filter-panel>\n\t\t\n\t\t<view class=\"result-meta\">\n\t\t<text class=\"meta-item\">Â∑≤ÈÄâÊã© {{ recordList.length }} Á¨î</text>\n\t\t\t<text class=\"meta-dot\">‚Ä¢</text>\n\t\t<text class=\"meta-item\">ÂÖ±ËÆ° {{ totalDrugs }} ÁßçËçØÊùê</text>\n\t\t</view>\n\t\t\n\t\t<!-- ÂàóË°® -->\n\t\t<view class=\"list-container\">\n\t\t\t<view \n\t\t\t\tv-for=\"item in recordList\" \n\t\t\t\t:key=\"item._id\"\n\t\t\t\tclass=\"record-card\"\n\t\t\t\t@click=\"goDetail(item._id, item)\"\n\t\t\t>\n\t\t\t\t<!-- ÂçïÂè∑ÂíåÁä∂ÊÄÅ -->\n\t\t\t\t<view class=\"record-header\">\n\t\t\t\t\t<view class=\"record-no\">{{ item.recordNo }}</view>\n\t\t\t\t\t<view :class=\"['record-status', `status-${item.status}`]\">\n\t\t\t\t\t\t{{ getStatusText(item.status) }}\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- Âü∫Êú¨‰ø°ÊÅØ -->\n\t\t\t\t<view class=\"record-info\">\n\t\t\t\t\t<view class=\"info-item\">\n\t\t\t\t\t\t<text class=\"info-label\">Êìç‰Ωú‰∫∫Ôºö</text>\n\t\t\t\t\t\t<text class=\"info-value\">{{ item.operator }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"info-item\">\n\t\t\t\t\t\t<text class=\"info-label\">ÂàõÂª∫Êó∂Èó¥Ôºö</text>\n\t\t\t\t\t\t<text class=\"info-value\">{{ item.createTime }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"info-item\">\n\t\t\t\t\t<text class=\"info-label\">ËçØÊùêÁßçÁ±ªÔºö</text>\n\t\t\t\t\t\t<text class=\"info-value\">{{ item.items.length }} Áßç</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- ÂæÖÂ§çÊ†∏Êó∂ÊòæÁ§∫Êìç‰ΩúÊåâÈíÆ -->\n\t\t\t\t<view v-if=\"item.status === 'pending_review' && canReview(item)\" class=\"record-actions\">\n\t\t\t\t\t<u-button \n\t\t\t\t\t\ttext=\"ÂéªÂ§çÊ†∏\" \n\t\t\t\t\t\ttype=\"primary\" \n\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t@click.stop=\"goReview(item._id)\"\n\t\t\t\t\t></u-button>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- Â∑≤È©≥ÂõûÊó∂ÊòæÁ§∫È©≥ÂõûÂéüÂõ† -->\n\t\t\t\t<view v-if=\"item.status === 'rejected'\" class=\"record-actions\">\n\t\t\t\t\t<view class=\"reject-reason\">È©≥ÂõûÂéüÂõ†Ôºö{{ item.rejectReason }}</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- Á©∫Áä∂ÊÄÅ -->\n\t\t\t<view v-if=\"recordList.length === 0\" class=\"empty-state\">\n\t\t\t\t<text class=\"empty-icon\">üìã</text>\n\t\t\t\t<text class=\"empty-text\">\n\t\t\t\t\tÊöÇÊó†{{ statusLabel === 'ÂÖ®ÈÉ®' ? '' : statusLabel }}ÂÖ•Â∫ìÂçï\n\t\t\t\t</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- Âä†ËΩΩÊõ¥Â§ö -->\n\t\t\t<view v-if=\"hasMore\" class=\"load-more\" @click=\"loadMore\">\n\t\t\t\t<text>Âä†ËΩΩÊõ¥Â§ö</text>\n\t\t\t</view>\n\t\t\t<view v-else-if=\"recordList.length > 0\" class=\"no-more\">\n\t\t\t\t<text>Ê≤°ÊúâÊõ¥Â§ö‰∫Ü</text>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nimport FilterPanel from '@/components/filter-panel/index.vue'\n\nexport default {\n\tcomponents: {\n\t\tFilterPanel\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tcurrentTime: '',\n\t\t\trecordList: [],\n\t\t\tpage: 1,\n\t\t\tpageSize: 10,\n\t\t\thasMore: true,\n\t\t\tcurrentUserId: '',\n\t\t\tstatusFilter: 'all',\n\t\t\t\n\t\t\t// Áä∂ÊÄÅÂàóË°®ÈÖçÁΩÆÔºàÊñ∞ËÆæËÆ°Ôºâ\n\t\t\tstatusList: [\n\t\t\t\t{ label: 'ÂÖ®ÈÉ®', value: 'all' },\n\t\t\t\t{ label: 'ËçâÁ®ø', value: 'draft' },\n\t\t\t\t{ label: 'ÂæÖÂ§çÊ†∏', value: 'pending_review' },\n\t\t\t\t{ label: 'Â∑≤È©≥Âõû', value: 'rejected' }\n\t\t\t],\n\t\t\t\n\t\t\t// ÂêÑÁä∂ÊÄÅÊï∞ÈáèÁªüËÆ°\n\t\t\tstatusCounts: {\n\t\t\t\tall: 0,\n\t\t\t\tdraft: 0,\n\t\t\t\tpending_review: 0,\n\t\t\t\tcompleted: 0,\n\t\t\t\trejected: 0\n\t\t\t},\n\t\t\tstatsData: {\n\t\t\t\ttoday: 0,\n\t\t\t\tthisWeek: 0,\n\t\t\t\tthisMonth: 0,\n\t\t\t\tpending: 0\n\t\t\t},\n\t\t\tstatusSummary: {\n\t\t\t\tall: 0,\n\t\t\t\tdraft: 0,\n\t\t\t\tpending_review: 0,\n\t\t\t\tcompleted: 0,\n\t\t\t\trejected: 0\n\t\t\t},\n\t\t\t// ÊêúÁ¥¢Áõ∏ÂÖ≥\n\t\t\tsearchKeyword: '',\n\t\t\tsearchTimer: null,\n\t\t\t// Êó•ÊúüÁ≠õÈÄâÁõ∏ÂÖ≥\n\t\t\tstartDate: '',\n\t\t\tendDate: '',\n\t\t\tselectedQuickFilter: 'month',\n\t\t\tquickFilters: [\n\t\t\t\t{ label: 'ÂÖ®ÈÉ®', value: 'all' },\n\t\t\t\t{ label: '‰ªäÂ§©', value: 'today' },\n\t\t\t\t{ label: 'Êú¨Âë®', value: 'week' },\n\t\t\t\t{ label: 'Êú¨Êúà', value: 'month' },\n\t\t\t\t{ label: 'Ëá™ÂÆö‰πâ', value: 'custom' }\n\t\t\t]\n\t\t}\n\t},\n\t\n\tonLoad(options) {\n\t\t// Â¶ÇÊûú‰ªéËçØÊùêÁÆ°ÁêÜÈ°µÈù¢Â∏¶‰∫ÜÁä∂ÊÄÅÂèÇÊï∞Ôºà‰æãÂ¶Ç status=pending_reviewÔºâÔºå‰ºòÂÖà‰ΩøÁî®ËØ•Áä∂ÊÄÅ\n\t\tif (options && options.status) {\n\t\t\tthis.statusFilter = options.status\n\t\t}\n\t\tthis.initPage()\n\t},\n\t\n\tcomputed: {\n\t// ÂΩìÂâçÁä∂ÊÄÅÊ†áÁ≠æ\n\t\tstatusLabel() {\n\t\tconst found = this.statusList.find(item => item.value === this.statusFilter)\n\t\t\treturn found ? found.label : 'ÂÖ®ÈÉ®'\n\t\t},\n\t// ËÆ°ÁÆóÊÄªËçØÊùêÁßçÁ±ªÊï∞\n\ttotalDrugs() {\n\t\tconst drugSet = new Set()\n\t\tthis.recordList.forEach(record => {\n\t\t\tif (record.items && Array.isArray(record.items)) {\n\t\t\t\trecord.items.forEach(item => {\n\t\t\t\t\tdrugSet.add(item.drugName + item.specification)\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t\treturn drugSet.size\n\t\t},\n\t\tdateFilterText() {\n\t\t\tif (!this.startDate && !this.endDate) {\n\t\t\t\treturn 'ÂÖ®ÈÉ®Êó∂Èó¥'\n\t\t\t}\n\t\t\tif (this.selectedQuickFilter === 'today') {\n\t\t\t\treturn '‰ªäÂ§©'\n\t\t\t}\n\t\t\tif (this.selectedQuickFilter === 'week') {\n\t\t\t\treturn 'Êú¨Âë®'\n\t\t\t}\n\t\t\tif (this.selectedQuickFilter === 'month') {\n\t\t\t\treturn 'Êú¨Êúà'\n\t\t\t}\n\t\t\tif (this.startDate && this.endDate) {\n\t\t\t\treturn `${this.startDate} ~ ${this.endDate}`\n\t\t\t}\n\t\t\tif (this.startDate) {\n\t\t\t\treturn `${this.startDate} Ëµ∑`\n\t\t\t}\n\t\t\tif (this.endDate) {\n\t\t\t\treturn `Ëá≥ ${this.endDate}`\n\t\t\t}\n\t\t\treturn 'ÂÖ®ÈÉ®Êó∂Èó¥'\n\t\t}\n\t},\n\t\n\tonShow() {\n\t\t// Âè™Âú®‰ªéÂÖ∂‰ªñÈ°µÈù¢ËøîÂõûÊó∂Âà∑Êñ∞ÔºåÈÅøÂÖçÈáçÂ§çÂä†ËΩΩ\n\t\t// Â¶ÇÊûúÂàóË°®‰∏∫Á©∫ÔºåËØ¥ÊòéÂèØËÉΩÊòØÈ¶ñÊ¨°Âä†ËΩΩÔºåÊ≠§Êó∂‰∏çÈúÄË¶ÅÂà∑Êñ∞\n\t\tif (this.recordList.length > 0) {\n\t\t\tthis.refreshList()\n\t\t}\n\t},\n\t\n\t// ‰∏ãÊãâÂà∑Êñ∞\n\tonPullDownRefresh() {\n\t\tthis.refreshList()\n\t\tsetTimeout(() => {\n\t\t\tuni.stopPullDownRefresh()\n\t\t}, 1000)\n\t},\n\t\n\tmethods: {\n\tinitPage() {\n\t\t// Ëé∑ÂèñÂΩìÂâçÁî®Êà∑IDÔºàÂÖºÂÆπ userId Âíå _idÔºâ\n\t\tconst userInfo = uni.getStorageSync('userInfo')\n\t\tthis.currentUserId = userInfo?.userId || userInfo?._id || ''\n\t\t\n\t\tconsole.log('üìã ÂÖ•Â∫ìÂàóË°®È°µÂàùÂßãÂåñ:', {\n\t\t\thasUserInfo: !!userInfo,\n\t\t\tcurrentUserId: this.currentUserId,\n\t\t\tuserRole: userInfo?.role\n\t\t})\n\t\t\n\t\t// ËÆæÁΩÆÂΩìÂâçÊó∂Èó¥\n\t\tthis.updateCurrentTime()\n\t\t\n\t\tthis.selectQuickFilter('month')\n\t\tthis.loadStats()\n\t},\n\t\t\n\t\tupdateCurrentTime() {\n\t\t\tconst now = new Date()\n\t\t\tconst year = now.getFullYear()\n\t\t\tconst month = String(now.getMonth() + 1).padStart(2, '0')\n\t\t\tconst day = String(now.getDate()).padStart(2, '0')\n\t\t\tthis.currentTime = `${year}Âπ¥${month}Êúà${day}Êó•`\n\t\t},\n\t\t\n\tasync loadRecords() {\n\t\t// È¶ñÊ¨°Âä†ËΩΩÊòæÁ§∫ loadingÔºåÂà∑Êñ∞Êó∂‰∏çÊòæÁ§∫\n\t\tconst isFirstLoad = this.page === 1 && this.recordList.length === 0\n\t\t\n\t\ttry {\n\t\t\t// ‰ΩøÁî® callFunction ÁöÑÁ¨¨‰∏â‰∏™ÂèÇÊï∞ÊéßÂà∂ÊòØÂê¶ÊòæÁ§∫ loading\n\t\t\tconst result = await this.$api.callFunction('inRecords', {\n\t\t\t\taction: 'getList',\n\t\t\t\tdata: {\n\t\t\t\t\tstatus: this.statusFilter,\n\t\t\t\t\tpage: this.page,\n\t\t\t\t\tpageSize: this.pageSize,\n\t\t\t\t\tkeyword: this.searchKeyword,\n\t\t\t\t\tstartDate: this.startDate,\n\t\t\t\t\tendDate: this.endDate\n\t\t\t\t}\n\t\t\t}, isFirstLoad)  // Âè™Âú®È¶ñÊ¨°Âä†ËΩΩÊó∂ÊòæÁ§∫ loading\n\t\t\t\n\t\t\t// result Â∑≤ÁªèÊòØÂ§ÑÁêÜÂêéÁöÑÊï∞ÊçÆ‰∫ÜÔºàrequest.js Â∑≤Â§ÑÁêÜÔºâ\n\t\t\tif (result && result.success) {\n\t\t\t\tlet newData = result.data || []\n\t\t\t\t\n\t\t\t\t// Â¶ÇÊûúÊúâÊêúÁ¥¢ÂÖ≥ÈîÆËØçÔºåÂú®ÂâçÁ´ØÂÜçËøáÊª§‰∏ÄÊ¨°Ôºà‰ª•Èò≤‰∫ëÂáΩÊï∞‰∏çÊîØÊåÅÔºâ\n\t\t\t\tif (this.searchKeyword) {\n\t\t\t\t\tnewData = this.filterByKeyword(newData)\n\t\t\t\t}\n\t\t\t\t// ÂÜçÊåâÂΩìÂâçÁä∂ÊÄÅÂÅö‰∏ÄÊ¨°ÂâçÁ´ØËøáÊª§ÔºåÁ°Æ‰øù‚ÄúÂæÖÂ§çÊ†∏‚ÄùÁ≠âÊ†áÁ≠æÂè™ÊòæÁ§∫ÂØπÂ∫îÁä∂ÊÄÅ\n\t\t\t\tif (this.statusFilter && this.statusFilter !== 'all') {\n\t\t\t\t\tnewData = newData.filter(item => item.status === this.statusFilter)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.recordList = this.page === 1 ? newData : [...this.recordList, ...newData]\n\t\t\t\tthis.hasMore = newData.length >= this.pageSize\n\t\t\t} else if (Array.isArray(result)) {\n\t\t\t\t// ÂÖºÂÆπÁõ¥Êé•ËøîÂõûÊï∞ÁªÑÁöÑÊÉÖÂÜµ\n\t\t\t\tlet newData = result\n\t\t\t\tif (this.searchKeyword) {\n\t\t\t\t\tnewData = this.filterByKeyword(newData)\n\t\t\t\t}\n\t\t\t\tif (this.statusFilter && this.statusFilter !== 'all') {\n\t\t\t\t\tnewData = newData.filter(item => item.status === this.statusFilter)\n\t\t\t\t}\n\t\t\t\tthis.recordList = this.page === 1 ? newData : [...this.recordList, ...newData]\n\t\t\t\tthis.hasMore = newData.length >= this.pageSize\n\t\t\t} else {\n\t\t\t\t// Â¶ÇÊûúÊ≤°ÊúâÊï∞ÊçÆÔºåËÆæÁΩÆ‰∏∫Á©∫Êï∞ÁªÑ\n\t\t\t\tthis.recordList = this.page === 1 ? [] : this.recordList\n\t\t\t\tthis.hasMore = false\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.error('Âä†ËΩΩÂ§±Ë¥•:', err)\n\t\t\t// request.js Â∑≤ÁªèÂ§ÑÁêÜ‰∫ÜÈîôËØØÊèêÁ§∫ÔºåËøôÈáåÂè™ËÆ∞ÂΩïÊó•Âøó\n\t\t\t// È¶ñÊ¨°Âä†ËΩΩÂ§±Ë¥•Êó∂ËÆæÁΩÆÁ©∫Êï∞ÊçÆ\n\t\t\tif (isFirstLoad) {\n\t\t\t\tthis.recordList = []\n\t\t\t\tthis.hasMore = false\n\t\t\t}\n\t\t}\n\t},\n\t\n\t// ÂâçÁ´ØÂÖ≥ÈîÆËØçËøáÊª§\n\tfilterByKeyword(list) {\n\t\tif (!this.searchKeyword) return list\n\t\tconst keyword = this.searchKeyword.toLowerCase()\n\t\treturn list.filter(item => {\n\t\t\t// ÊêúÁ¥¢ÂçïÂè∑\n\t\t\tif (item.recordNo && item.recordNo.toLowerCase().includes(keyword)) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t\t// ÊêúÁ¥¢ËçØÊùêÂêçÁß∞\n\t\t\tif (item.items && Array.isArray(item.items)) {\n\t\t\t\treturn item.items.some(drug => \n\t\t\t\t\tdrug.drugName && drug.drugName.toLowerCase().includes(keyword)\n\t\t\t\t)\n\t\t\t}\n\t\t\treturn false\n\t\t})\n\t},\n\t\n\tasync loadCounts() {\n\t\ttry {\n\t\t\tconst result = await this.$api.callFunction('inRecords', {\n\t\t\t\taction: 'getCounts',\n\t\t\t\tdata: {}\n\t\t\t}, false)  // ‰∏çÊòæÁ§∫ loading\n\t\t\t\n\t\t\tif (result && result.success) {\n\t\t\t// Êõ¥Êñ∞Áä∂ÊÄÅÁªüËÆ°Êï∞ÈáèÔºàÊñ∞ËÆæËÆ°Ôºâ\n\t\t\tthis.statusCounts = {\n\t\t\t\t\tall: result.all || 0,\n\t\t\t\t\tdraft: result.draft || 0,\n\t\t\t\t\tpending_review: result.pending_review || 0,\n\t\t\t\t\tcompleted: result.completed || 0,\n\t\t\t\t\trejected: result.rejected || 0\n\t\t\t\t}\n\t\t\t// ‰øùÊåÅÂéüÊúâÁöÑstatusSummaryÂÖºÂÆπÊÄß\n\t\t\tthis.statusSummary = this.statusCounts\n\t\t\t} else if (result) {\n\t\t\tthis.statusCounts = {\n\t\t\t\t\tall: result.all || 0,\n\t\t\t\t\tdraft: result.draft || 0,\n\t\t\t\t\tpending_review: result.pending_review || 0,\n\t\t\t\t\tcompleted: result.completed || 0,\n\t\t\t\t\trejected: result.rejected || 0\n\t\t\t\t}\n\t\t\tthis.statusSummary = this.statusCounts\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.error('Âä†ËΩΩÊï∞ÈáèÂ§±Ë¥•:', err)\n\t\t\t// request.js Â∑≤Â§ÑÁêÜÈîôËØØÊèêÁ§∫\n\t\t}\n\t},\n\t\n\tasync loadStats() {\n\t\t// ‰∏ç‰ΩøÁî® loadingÔºåÈÅøÂÖçÂΩ±ÂìçÁî®Êà∑‰ΩìÈ™å\n\t\ttry {\n\t\t\tconst result = await this.$api.callFunction('inRecords', {\n\t\t\t\taction: 'getStats',\n\t\t\t\tdata: {}\n\t\t\t}, false)  // ‰∏çÊòæÁ§∫ loading\n\t\t\t\n\t\t\tif (result && result.success) {\n\t\t\t\tthis.statsData = {\n\t\t\t\t\ttoday: result.today || 0,\n\t\t\t\t\tthisWeek: result.thisWeek || 0,\n\t\t\t\t\tthisMonth: result.thisMonth || 0,\n\t\t\t\t\tpending: result.pending || 0\n\t\t\t\t}\n\t\t\t} else if (result) {\n\t\t\t\t// ÂÖºÂÆπÁõ¥Êé•ËøîÂõûÊï∞ÊçÆÁöÑÊÉÖÂÜµ\n\t\t\t\tthis.statsData = {\n\t\t\t\t\ttoday: result.today || 0,\n\t\t\t\t\tthisWeek: result.thisWeek || 0,\n\t\t\t\t\tthisMonth: result.thisMonth || 0,\n\t\t\t\t\tpending: result.pending || 0\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Â¶ÇÊûú getStats Â§±Ë¥•Ôºå‰ΩøÁî® getCounts ‰Ωú‰∏∫Â§áÁî®\n\t\t\t\tthis.fallbackStats()\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.error('Âä†ËΩΩÁªüËÆ°Â§±Ë¥•:', err)\n\t\t\t// ‰ΩøÁî® getCounts ÁöÑÊï∞ÊçÆ‰Ωú‰∏∫Â§áÁî®\n\t\t\tthis.fallbackStats()\n\t\t}\n\t},\n\t\n\tasync fallbackStats() {\n\t\ttry {\n\t\t\tconst countsResult = await this.$api.callFunction('inRecords', {\n\t\t\t\taction: 'getCounts',\n\t\t\t\tdata: {}\n\t\t\t}, false)  // ‰∏çÊòæÁ§∫ loading\n\t\t\t\n\t\t\tif (countsResult && countsResult.success) {\n\t\t\t\tthis.statsData.today = countsResult.today || 0\n\t\t\t\tthis.statsData.pending = countsResult.pending_review || 0\n\t\t\t\t// Êú¨Âë®ÂíåÊú¨Êúà‰ΩøÁî®‰ªäÊó•Êï∞ÊçÆ‰Ωú‰∏∫Âç†‰Ωç\n\t\t\t\tthis.statsData.thisWeek = countsResult.today || 0\n\t\t\t\tthis.statsData.thisMonth = countsResult.completed || 0\n\t\t\t} else if (countsResult) {\n\t\t\t\t// ÂÖºÂÆπÁõ¥Êé•ËøîÂõûÊï∞ÊçÆÁöÑÊÉÖÂÜµ\n\t\t\t\tthis.statsData.today = countsResult.today || 0\n\t\t\t\tthis.statsData.pending = countsResult.pending_review || 0\n\t\t\t\tthis.statsData.thisWeek = countsResult.today || 0\n\t\t\t\tthis.statsData.thisMonth = countsResult.completed || 0\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.error('Â§áÁî®ÁªüËÆ°Âä†ËΩΩÂ§±Ë¥•:', err)\n\t\t\t// ‰øùÊåÅÈªòËÆ§ÂÄº 0\n\t\t}\n\t},\n\t\t\n\t\tresetFilters() {\n\t\t\tthis.searchKeyword = ''\n\t\t\tthis.startDate = ''\n\t\t\tthis.endDate = ''\n\t\t\tthis.selectedQuickFilter = 'month'\n\t\t\tthis.statusFilter = 'all'\n\t\t\tthis.tempStatus = 'all'\n\t\t\tthis.page = 1\n\t\t\tthis.recordList = []\n\t\t\tthis.hasMore = true\n\t\t\tthis.selectQuickFilter('month')\n\t\t\tthis.generateList()\n\t\t},\n\t\t\n\t\tgenerateList() {\n\t\t\tthis.page = 1\n\t\t\tthis.recordList = []\n\t\t\tthis.hasMore = true\n\t\t\tthis.loadRecords()\n\t\t\tthis.loadCounts()\n\t\t},\n\t\t\n\t// ÂàáÊç¢Áä∂ÊÄÅÁ≠õÈÄâÔºàÊñ∞ÊñπÊ≥ïÔºâ\n\tchangeStatusFilter(status) {\n\t\tthis.statusFilter = status\n\t\tthis.page = 1\n\t\tthis.recordList = []\n\t\tthis.hasMore = true\n\t\tthis.loadRecords()\n\t\t\n\t\t// ÊåØÂä®ÂèçÈ¶à\n\t\tuni.vibrateShort({ type: 'light' })\n\t\t},\n\t\t\n\t\trefreshList() {\n\t\t\tthis.page = 1\n\t\t\tthis.recordList = []\n\t\t\tthis.hasMore = true\n\t\t\tthis.updateCurrentTime()\n\t\t\t// Âà∑Êñ∞Êó∂ÈáçÊñ∞Âä†ËΩΩÊï∞ÊçÆ\n\t\t\tthis.loadRecords()\n\t\t\tthis.loadCounts()\n\t\t\tthis.loadStats()\n\t\t},\n\t\t\n\t\t// ÈùôÈªòÂà∑Êñ∞Ôºà‰∏çÊòæÁ§∫ loadingÔºâ\n\t\tsilentRefresh() {\n\t\t\tthis.loadRecords()\n\t\t\tthis.loadCounts()\n\t\t\tthis.loadStats()\n\t\t},\n\t\t\n\t\tloadMore() {\n\t\t\tif (!this.hasMore) return\n\t\t\tthis.page++\n\t\t\tthis.loadRecords()\n\t\t},\n\t\t\n\t\tgetStatusText(status) {\n\t\t\tconst statusMap = {\n\t\t\t\tdraft: 'ËçâÁ®ø',\n\t\t\t\tpending_review: 'ÂæÖÂ§çÊ†∏',\n\t\t\t\tcompleted: 'Â∑≤ÂÆåÊàê',\n\t\t\t\trejected: 'Â∑≤È©≥Âõû'\n\t\t\t}\n\t\t\treturn statusMap[status] || status\n\t\t},\n\t\t\n\tcanReview(item) {\n\t\t// ÂæÖÂ§çÊ†∏ÁöÑÂçïÊçÆÔºå‰∏î‰∏çÊòØËá™Â∑±ÂàõÂª∫ÁöÑÔºå‰∏îÂΩìÂâçÁî®Êà∑ÊúâÂ§çÊ†∏ÊùÉÈôê\n\t\tconsole.log('üîç Â§çÊ†∏ÊùÉÈôêÊ£ÄÊü•:', {\n\t\t\titemStatus: item.status,\n\t\t\toperatorId: item.operatorId,\n\t\t\tcurrentUserId: this.currentUserId,\n\t\t\tisSameUser: item.operatorId === this.currentUserId\n\t\t})\n\t\t\n\t\tif (item.status !== 'pending_review' || item.operatorId === this.currentUserId) {\n\t\t\tconsole.log('‚ùå ‰∏çËÉΩÂ§çÊ†∏: Áä∂ÊÄÅ‰∏çÂØπÊàñÊòØËá™Â∑±ÂàõÂª∫ÁöÑ')\n\t\t\treturn false\n\t\t}\n\t\t\n\t\t// Ê£ÄÊü•Áî®Êà∑ËßíËâ≤ÊòØÂê¶ÊúâÂ§çÊ†∏ÊùÉÈôêÔºàÁÆ°ÁêÜÂëòÊàñÈ°πÁõÆÁªèÁêÜÔºâ\n\t\tconst userInfo = uni.getStorageSync('userInfo')\n\t\tconst userRole = userInfo?.role || ''\n\t\tconst hasPermission = userRole === 'admin' || userRole === 'project_manager'\n\t\t\n\t\tconsole.log('‚úÖ Â§çÊ†∏ÊùÉÈôêÁªìÊûú:', {\n\t\t\tuserRole,\n\t\t\thasPermission\n\t\t})\n\t\t\n\t\treturn hasPermission\n\t},\n\t\t\n\t\tgoDetail(id, item) {\n\t\t\t// Â¶ÇÊûúÊòØÂæÖÂ§çÊ†∏Áä∂ÊÄÅ‰∏îÂèØ‰ª•Â§çÊ†∏ÔºåË∑≥ËΩ¨Âà∞Â§çÊ†∏È°µÈù¢\n\t\t\tif (item && item.status === 'pending_review' && this.canReview(item)) {\n\t\t\t\tthis.goReview(id)\n\t\t\t} else {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: `/pages-sub/in/detail?id=${id}`\n\t\t\t})\n\t\t\t}\n\t\t},\n\t\t\n\tgoReview(id) {\n\t\tuni.navigateTo({\n\t\t\turl: `/pages-sub/in/review?id=${id}`\n\t\t})\n\t},\n\t\t\n\t\tgoReport() {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: '/pages-sub/report/inbound'\n\t\t})\n\t},\n\t\n\tgoAdd() {\n\t\tuni.navigateTo({\n\t\t\turl: '/pages-sub/in/add'\n\t\t})\n\t},\n\t\n\t// ========== ÊêúÁ¥¢Áõ∏ÂÖ≥ ==========\n\tonKeywordUpdate(val) {\n\t\tthis.searchKeyword = val\n\t\tif (this.searchTimer) clearTimeout(this.searchTimer)\n\t\tthis.searchTimer = setTimeout(() => this.generateList(), 400)\n\t},\n\tonStartDateUpdate(val) {\n\t\tthis.startDate = val\n\t},\n\tonEndDateUpdate(val) {\n\t\tthis.endDate = val\n\t},\n\tonDateRangeChange({ start, end }) {\n\t\tthis.startDate = start || ''\n\t\tthis.endDate = end || ''\n\t\tthis.generateList()\n\t},\n\n\tselectQuickFilter(value) {\n\t\tthis.selectedQuickFilter = value\n\t\tconst today = new Date()\n\t\t\n\t\tswitch(value) {\n\t\t\tcase 'all':\n\t\t\t\tthis.startDate = ''\n\t\t\t\tthis.endDate = ''\n\t\t\t\tbreak\n\t\t\tcase 'today':\n\t\t\t\tthis.startDate = this.formatDate(today)\n\t\t\t\tthis.endDate = this.formatDate(today)\n\t\t\t\tbreak\n\t\t\tcase 'week':\n\t\t\t\tconst weekStart = new Date(today)\n\t\t\t\tweekStart.setDate(today.getDate() - today.getDay())\n\t\t\t\tthis.startDate = this.formatDate(weekStart)\n\t\t\t\tthis.endDate = this.formatDate(today)\n\t\t\t\tbreak\n\t\t\tcase 'month':\n\t\t\t\tconst monthStart = new Date(today.getFullYear(), today.getMonth(), 1)\n\t\t\t\tthis.startDate = this.formatDate(monthStart)\n\t\t\t\tthis.endDate = this.formatDate(today)\n\t\t\t\tbreak\n\t\t\tcase 'custom':\n\t\t\t\t// Ëá™ÂÆö‰πâÁî±Êó•ÊúüÈÄâÊã©Âô®ÂõûË∞ÉÊéßÂà∂\n\t\t\t\tbreak\n\t\t}\n\t\tif (value !== 'custom') {\n\t\t\tthis.generateList()\n\t\t}\n\t},\n\t\n\tformatDate(date) {\n\t\tconst year = date.getFullYear()\n\t\tconst month = String(date.getMonth() + 1).padStart(2, '0')\n\t\tconst day = String(date.getDate()).padStart(2, '0')\n\t\treturn `${year}-${month}-${day}`\n\t},\n\t\n\t// Ê®°ÊãüÊï∞ÊçÆ\n\t\tgetMockData() {\n\t\t\tconst now = new Date()\n\t\t\tconst mockList = [\n\t\t\t\t{\n\t\t\t\t\t_id: 'in_001',\n\t\t\t\t\trecordNo: 'RK20251028001',\n\t\t\t\t\tstatus: 'pending_review',\n\t\t\t\t\toperator: 'Âº†‰∏â',\n\t\t\t\t\toperatorId: 'user_001',\n\t\t\t\t\tcreateTime: '2025-10-28 09:30:00',\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{ drugName: 'ÈòøËé´Ë•øÊûóËÉ∂Âõä', spec: '0.25g*24Á≤í', quantity: 100 },\n\t\t\t\t\t\t{ drugName: 'Â∏ÉÊ¥õËä¨ÁºìÈáäËÉ∂Âõä', spec: '0.3g*20Á≤í', quantity: 50 }\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t_id: 'in_002',\n\t\t\t\t\trecordNo: 'RK20251028002',\n\t\t\t\t\tstatus: 'completed',\n\t\t\t\t\toperator: 'ÊùéÂõõ',\n\t\t\t\t\toperatorId: 'user_002',\n\t\t\t\t\treviewer: 'Áéã‰∫î',\n\t\t\t\t\treviewerId: 'user_003',\n\t\t\t\t\tcreateTime: '2025-10-27 14:20:00',\n\t\t\t\t\tcompleteTime: '2025-10-27 15:00:00',\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{ drugName: 'ÊÑüÂÜíÁÅµÈ¢óÁ≤í', spec: '10g*10Ë¢ã', quantity: 200 }\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t_id: 'in_003',\n\t\t\t\t\trecordNo: 'RK20251027001',\n\t\t\t\t\tstatus: 'draft',\n\t\t\t\t\toperator: 'Âº†‰∏â',\n\t\t\t\t\toperatorId: 'user_001',\n\t\t\t\t\tcreateTime: '2025-10-27 10:00:00',\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{ drugName: 'Áª¥ÁîüÁ¥†CÁâá', spec: '0.1g*100Áâá', quantity: 50 }\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t_id: 'in_004',\n\t\t\t\t\trecordNo: 'RK20251026001',\n\t\t\t\t\tstatus: 'rejected',\n\t\t\t\t\toperator: 'ÊùéÂõõ',\n\t\t\t\t\toperatorId: 'user_002',\n\t\t\t\t\treviewer: 'Âº†‰∏â',\n\t\t\t\t\treviewerId: 'user_001',\n\t\t\t\t\tcreateTime: '2025-10-26 16:00:00',\n\t\t\t\t\trejectReason: 'ÊâπÂè∑Â°´ÂÜô‰∏çËßÑËåÉ',\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{ drugName: 'ÈòøÂè∏ÂåπÊûóËÇ†Ê∫∂Áâá', spec: '25mg*100Áâá', quantity: 100 }\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t\t\n\t\t\t// Ê†πÊçÆÁä∂ÊÄÅÁ≠õÈÄâ\n\t\t\tif (this.statusFilter === 'all') {\n\t\t\t\treturn mockList\n\t\t\t}\n\t\t\treturn mockList.filter(item => item.status === this.statusFilter)\n\t\t}\n\t}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import '@/common/ui.scss';\n\n.container {\n\tmin-height: 100vh;\n\t/* ‰ΩøÁî®‰∏éÈ¶ñÈ°µ/Èó®ËØä/ËçØÊùêÂ∑•‰ΩúÂè∞‰∏ÄËá¥ÁöÑËìùËâ≤Ê∏êÂèòËÉåÊôØ */\n\tbackground: linear-gradient(180deg, #00c9ff 0%, #00a0ff 35%, #e5e7eb 100%);\n\tpadding: 24rpx 24rpx 60rpx;\n}\n\n.page-header {\n\t/* È°∂ÈÉ®Ê†áÈ¢òÂç°ÁâáÔºöË±°ÁâôÁôΩÂúÜËßíÂç°ÁâáÔºåÂÆΩÂ∫¶‰∏éÂÖ∂ÂÆÉÂ∑•‰ΩúÂè∞ header-card ÂØπÈΩê */\n\tmax-width: 702rpx;\n\tmargin: 10rpx auto 8rpx;\n\tpadding: 24rpx 24rpx 18rpx;\n\tbackground: #FFFFF0;\n\tborder-radius: 22rpx;\n\tbox-shadow:\n\t\t0 1rpx 0 rgba(255, 255, 255, 0.9) inset,\n\t\t0 -1rpx 0 rgba(15, 23, 42, 0.06) inset,\n\t\t0 18rpx 40rpx rgba(15, 23, 42, 0.14);\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: flex-start;\n}\n\n.page-header-title {\n\twidth: 100%;\n\tdisplay: flex;\n\tjustify-content: center;\n}\n\n.page-title {\n\tdisplay: block;\n\tfont-size: 36rpx;\n\tfont-weight: 700;\n\tcolor: #111827;\n}\n\n.page-subtitle {\n\tfont-size: 24rpx;\n\tcolor: #94a3b8;\n\tmargin-top: 6rpx;\n}\n\n.page-actions {\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n\tgap: 16rpx;\n\tmargin-top: 18rpx;\n\twidth: 100%;\n}\n\n.header-btn {\n\tmin-width: 150rpx;\n\tpadding: 18rpx 30rpx;\n\tborder-radius: 999rpx;\n\tfont-size: 26rpx;\n\tfont-weight: 600;\n\ttext-align: center;\n}\n\n.header-btn.ghost {\n\tbackground: linear-gradient(135deg, #00c9ff 0%, #00a0ff 100%);\n\tcolor: #ffffff;\n\tborder: none;\n\tbox-shadow: 0 6rpx 16rpx rgba(0, 160, 255, 0.25);\n}\n\n.header-btn.primary {\n\tbackground: linear-gradient(135deg, #00c9ff 0%, #00a0ff 100%);\n\tcolor: #ffffff;\n\tbox-shadow: 0 6rpx 16rpx rgba(0, 160, 255, 0.25);\n}\n\n// Áä∂ÊÄÅÁ≠õÈÄâTabÊ†èÔºàÊñ∞ËÆæËÆ°Ôºâ\n.status-tabs {\n\tmax-width: 702rpx;\n\tmargin: 0 auto 8rpx;\n\tpadding: 12rpx 20rpx;\n\tbackground: #FFFFF0;\n\tborder-radius: 22rpx;\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tgap: 10rpx;\n\tjustify-content: space-between;\n}\n\n.status-tab {\n\tdisplay: inline-flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 8rpx 10rpx;\n\tbackground: white;\n\tborder-radius: 40rpx;\n\tfont-size: 16rpx;\n\tcolor: #646566;\n\tbox-shadow: 0 3rpx 10rpx rgba(15, 23, 42, 0.06);\n\ttransition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n\tflex: 1 0 18%;\n\tmin-width: 0;\n\tborder: 2rpx solid transparent;\n\t\n\t&.active {\n\t\tbackground: linear-gradient(135deg, #07C160 0%, #05a550 100%);\n\t\tcolor: white;\n\t\tfont-weight: bold;\n\t\tbox-shadow: 0 6rpx 20rpx rgba(7, 193, 96, 0.35);\n\t\ttransform: scale(1.02);\n\t\tborder-color: #07C160;\n\t}\n\t\n\t.status-name {\n\t\tmargin-right: 4rpx;\n\t\twhite-space: nowrap;\n\t}\n\t\n\t.count {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tmin-width: 28rpx;\n\t\theight: 28rpx;\n\t\tpadding: 0 6rpx;\n\t\tbackground: rgba(0, 0, 0, 0.08);\n\t\tborder-radius: 14rpx;\n\t\tfont-size: 18rpx;\n\t\tline-height: 1;\n\t\tfont-weight: bold;\n\t}\n\t\n\t&.active .count {\n\t\tbackground: rgba(255, 255, 255, 0.3);\n\t\tcolor: white;\n\t}\n}\n\n.panel-wrapper {\n\tmax-width: 702rpx;\n\tmargin: 0 auto 8rpx;\n}\n\n.filter-extra {\n\tmargin-top: 12rpx;\n\tdisplay: flex;\n\tgap: 12rpx;\n}\n\n.extra-item {\n\tflex: 1;\n\tbackground: #f8fafc;\n\tborder-radius: 12rpx;\n\tpadding: 16rpx 20rpx;\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 4rpx;\n}\n\n.extra-item.selectable {\n\tborder: 1rpx solid #e2e8f0;\n}\n\n.extra-label {\n\tfont-size: 24rpx;\n\tcolor: #94a3b8;\n}\n\n.extra-value {\n\tfont-size: 28rpx;\n\tcolor: #1f2937;\n}\n\n.filter-action-bar {\n\tmax-width: 702rpx;\n\tmargin: 8rpx auto 8rpx;\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tgap: 16rpx;\n\tpadding: 0 24rpx;\n}\n\n.action-btn {\n\tmin-width: 150rpx;\n\theight: 82rpx;\n\tborder-radius: 999rpx;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tfont-size: 28rpx;\n\tfont-weight: 600;\n}\n\n.action-btn.ghost {\n\tbackground: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);\n\tcolor: #ffffff;\n\tborder: none;\n\tbox-shadow: 0 6rpx 16rpx rgba(37, 99, 235, 0.3);\n}\n\n.action-btn.primary {\n\tbackground: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);\n\tcolor: #ffffff;\n\tbox-shadow: 0 6rpx 16rpx rgba(37, 99, 235, 0.3);\n}\n\n.result-meta {\n\tmax-width: 702rpx;\n\tmargin: 0 auto 8rpx;\n\tpadding: 16rpx 20rpx;\n\tbackground: #FFFFF0;\n\tborder-radius: 16rpx;\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tgap: 8rpx;\n\tfont-size: 26rpx;\n\tcolor: #475569;\n}\n\n.meta-item {\n\tcolor: #1f2937;\n}\n\n.meta-dot {\n\tcolor: #cbd5e1;\n}\n\n.list-container {\n\tmax-width: 702rpx;\n\tmargin: 0 auto 8rpx;\n\tpadding: 0;\n}\n\n.record-card {\n\tbackground-color: #FFFFF0;\n\tpadding: 30rpx;\n\tborder-radius: $card-radius-lg;\n\tmargin-bottom: 8rpx;\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\n}\n\n.record-header {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tmargin-bottom: 20rpx;\n\tpadding-bottom: 20rpx;\n\tborder-bottom: 1px solid #F0F0F0;\n}\n\n.record-no {\n\tfont-size: 30rpx;\n\tfont-weight: bold;\n\tcolor: #333333;\n}\n\n.record-status {\n\tfont-size: 24rpx;\n\tpadding: 8rpx 20rpx;\n\tborder-radius: 20rpx;\n\tcolor: #FFFFFF;\n}\n\n.status-draft {\n\tbackground-color: #999999;\n}\n\n.status-pending_review {\n\tbackground-color: #FF9800;\n}\n\n.status-completed {\n\tbackground-color: #4CAF50;\n}\n\n.status-rejected {\n\tbackground-color: #FF6B6B;\n}\n\n.record-info {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 12rpx;\n}\n\n.info-item {\n\tdisplay: flex;\n\tfont-size: 26rpx;\n}\n\n.info-label {\n\tcolor: #999999;\n\tmin-width: 140rpx;\n}\n\n.info-value {\n\tcolor: #333333;\n\tflex: 1;\n}\n\n.record-actions {\n\tmargin-top: 20rpx;\n\tpadding-top: 20rpx;\n\tborder-top: 1px solid #F0F0F0;\n\tdisplay: flex;\n\tjustify-content: flex-end;\n}\n\n.reject-reason {\n\tflex: 1;\n\tfont-size: 24rpx;\n\tcolor: #FF6B6B;\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.empty-state {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 100rpx 0;\n}\n\n.empty-icon {\n\tfont-size: 100rpx;\n\tmargin-bottom: 20rpx;\n}\n\n.empty-text {\n\tfont-size: 28rpx;\n\tcolor: #999999;\n}\n\n.load-more, .no-more {\n\ttext-align: center;\n\tpadding: 30rpx 0;\n\tfont-size: 26rpx;\n\tcolor: #999999;\n}\n\n</style>\n\n","import mod from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./list.vue?vue&type=style&index=0&id=61ff7e52&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./list.vue?vue&type=style&index=0&id=61ff7e52&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1766820927558\n      var cssReload = require(\"D:/HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}