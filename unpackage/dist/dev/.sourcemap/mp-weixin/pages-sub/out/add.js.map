{"version":3,"sources":["uni-app:///main.js",null,"webpack:///D:/AK-PMS/pages-sub/out/add.vue?1fdb","webpack:///D:/AK-PMS/pages-sub/out/add.vue?584b","webpack:///D:/AK-PMS/pages-sub/out/add.vue?b312","uni-app:///pages-sub/out/add.vue","webpack:///D:/AK-PMS/pages-sub/out/add.vue?a576","webpack:///D:/AK-PMS/pages-sub/out/add.vue?f76b"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","Signature","BatchSelector","data","recordNo","currentTime","currentDate","dispenser","remark","locationIndex","locations","label","value","currentLocation","requestAreaIndex","requestAreas","currentRequestArea","drugList","dispenserSign","onLoad","uni","onShow","console","selectedDrugs","drugId","drugCode","drugName","specification","spec","unit","manufacturer","isHighValue","isEmergency","batch","batchId","expireDate","productionDate","stockQuantity","price","quantity","conversionRate","minUnit","isNearExpiry","methods","initPage","onLocationChange","onRequestAreaChange","goSelectDrug","url","buildSpecification","deleteDrug","onBatchSelect","item","validateQuantity","title","icon","autoAllocateBatch","name","action","requiredQuantity","location","result","content","success","duration","saveDraft","userInfo","locationName","fromLocation","fromLocationName","toLocation","toLocationName","requestLocation","requestLocationName","dispenserId","dispenserSignTime","items","status","setTimeout","submitReview"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,YAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA4H;AAC5H;AACuD;AACL;AACsC;;;AAGxF;AAC4M;AAC5M,gBAAgB,gNAAU;AAC1B,EAAE,yEAAM;AACR,EAAE,0FAAM;AACR,EAAE,mGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,8FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,iMAEN;AACP,KAAK;AACL;AACA,aAAa,kLAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACvFA;AAAA;AAAA;AAAA;AAAgyB,CAAgB,4xBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;ACkNpzB;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eAEA;EACAC;IACAC;IACAC;EACA;EAEAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC,YACA;QAAAC;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,EACA;MACA;MACAC;QAAAF;QAAAC;MAAA;MACAE;MACAC,eACA;QAAAJ;QAAAC;MAAA;MACA;MACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,EACA;MACAI;QAAAL;QAAAC;MAAA;MACAK;MACAC;IACA;EACA;EAEAC;IACA;IACA;IACA;IACAC;IACA;IACA;EACA;EAEAC;IAAA;IACA;IACA;IAEA;MACAC;MACAA;;MAEA;MACAC;QACAD;QACAA;QACAA;QACAA;QAEA;UAAA;QAAA;QACA;UACA;UACA;UACAA;UAEA;YACAE;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACA;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACA;YACAC;YACAC;YACAC;UACA;QACA;MACA;MAEApB;;MAEA;MACAF;IACA;EACA;EAEAuB;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA3B;QAAA4B;MAAA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;IACA;IAEA;IACAC;MACA;MACA;MACAC;MACAA;MACAA;MACAA;MACAA;MACAA;IACA;IAEA;IACAC;MACA;MACA;MACA;MACA;MACA;QACAD;QACA;MACA;MACA;QACAA;QACAhC;UACAkC;UACAC;QACA;MACA;IACA;IAEA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAJ;gBAAA,IAEAA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAAA,MAGA;kBAAA;kBAAA;gBAAA;gBACA;gBACA;gBACA;gBAAA;cAAA;gBAAA,IAKAA;kBAAA;kBAAA;gBAAA;gBACAhC;kBACAkC;kBACAC;gBACA;gBAAA;cAAA;gBAIAnC;kBAAAkC;gBAAA;gBAAA;gBAAA;gBAAA,OAGA3D;kBACA8D;kBACAtD;oBACAuD;oBACAvD;sBACAqB;sBACAmC;sBACAC;oBACA;kBACA;gBACA;cAAA;gBAVAC;gBAYAvC;gBAAA,KAEAuC;kBAAA;kBAAA;gBAAA;gBAAA,sBACAA,iKAEA;gBACA;gBACA;gBACA;;gBAEA;gBACA;kBACAzC;oBACAkC;oBACAQ;oBACAC;sBACA;wBACAX;wBACA;wBACA;wBACA;sBACA;oBACA;kBACA;gBACA;kBACAhC;oBACAkC;oBACAC;oBACAS;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA,MAEA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGA1C;gBACAF;kBACAkC;kBACAC;kBACAS;gBACA;gBACA;cAAA;gBAAA;gBAEA5C;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACA6C;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBACA7C;kBACAkC;kBACAC;gBACA;gBAAA;cAAA;gBAIAnC;kBAAAkC;gBAAA;gBAAA;gBAEAY;gBAAA;gBAAA,OACA;kBACAR;kBACAvD;oBACAC;oBACA;oBACAwD;oBACAO;oBACAC;oBACAC;oBACA;oBACAC;oBACAC;oBACAC;oBACAC;oBACAlE;oBACAmE;oBACAxD;oBACAyD;oBACAnE;oBACAoE;sBAAA;wBACApD;wBACAC;wBACAC;wBACAC;wBACAE;wBACAC;wBACAG;wBACAC;wBACAC;wBACAI;wBACAD;wBACAP;wBACAC;sBACA;oBAAA;oBACA6C;kBACA;gBACA;cAAA;gBApCAhB;gBAqCAzC;gBAAA,KACAyC;kBAAA;kBAAA;gBAAA;gBACAzC;kBAAAkC;kBAAAC;gBAAA;gBACAuB;kBAAA1D;gBAAA;gBAAA;gBAAA;cAAA;gBAAA,MAEA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAE;gBACAF;gBACAA;kBAAAkC;kBAAAC;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAwB;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBACA3D;kBAAAkC;kBAAAC;gBAAA;gBAAA;cAAA;gBAAA,MAGA;kBAAA;kBAAA;gBAAA;gBACAnC;kBAAAkC;kBAAAC;gBAAA;gBAAA;cAAA;gBAIAnC;kBAAAkC;gBAAA;gBAAA;gBAEAY;gBAAA;gBAAA,OACA;kBACAR;kBACAvD;oBACAC;oBACA;oBACAwD;oBACAO;oBACAC;oBACAC;oBACA;oBACAC;oBACAC;oBACAC;oBACAC;oBACAlE;oBACAmE;oBACAxD;oBACAyD;oBACAnE;oBACAoE;sBAAA;wBACApD;wBACAC;wBACAC;wBACAC;wBACAE;wBACAC;wBACAG;wBACAC;wBACAC;wBACAI;wBACAD;wBACAP;wBACAC;sBACA;oBAAA;oBACA6C;kBACA;gBACA;cAAA;gBApCAhB;gBAqCAzC;gBAAA,KACAyC;kBAAA;kBAAA;gBAAA;gBACAzC;kBAAAkC;kBAAAC;gBAAA;gBACAuB;kBAAA1D;gBAAA;gBAAA;gBAAA;cAAA;gBAAA,MAEA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAE;gBACAF;gBACAA;kBAAAkC;kBAAAC;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACnlBA;AAAA;AAAA;AAAA;AAA+/C,CAAgB,+6CAAG,EAAC,C;;;;;;;;;;;ACAnhD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages-sub/out/add.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages-sub/out/add.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./add.vue?vue&type=template&id=017bfd6a&scoped=true&\"\nvar renderjs\nimport script from \"./add.vue?vue&type=script&lang=js&\"\nexport * from \"./add.vue?vue&type=script&lang=js&\"\nimport style0 from \"./add.vue?vue&type=style&index=0&id=017bfd6a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"017bfd6a\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages-sub/out/add.vue\"\nexport default component.exports","export * from \"-!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add.vue?vue&type=template&id=017bfd6a&scoped=true&\"","var components\ntry {\n  components = {\n    batchSelector: function () {\n      return import(\n        /* webpackChunkName: \"components/batch-selector/index\" */ \"@/components/batch-selector/index.vue\"\n      )\n    },\n    signature: function () {\n      return import(\n        /* webpackChunkName: \"components/signature/index\" */ \"@/components/signature/index.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. æ’æŸ¥ç»„ä»¶åç§°æ‹¼å†™æ˜¯å¦æ­£ç¡®\")\n    console.error(\n      \"2. æ’æŸ¥ç»„ä»¶æ˜¯å¦ç¬¦åˆ easycom è§„èŒƒï¼Œæ–‡æ¡£ï¼šhttps://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. è‹¥ç»„ä»¶ä¸ç¬¦åˆ easycom è§„èŒƒï¼Œéœ€æ‰‹åŠ¨å¼•å…¥ï¼Œå¹¶åœ¨ components ä¸­æ³¨å†Œè¯¥ç»„ä»¶\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.drugList.length\n  var l0 = _vm.__map(_vm.drugList, function (item, index) {\n    var $orig = _vm.__get_orig(item)\n    var a0 = !item.batch\n      ? {\n          name: item.drugName,\n          specification: item.specification || item.spec,\n          unit: item.unit,\n        }\n      : null\n    var g1 =\n      item.quantity && item.conversionRate && item.conversionRate > 1\n        ? (item.quantity * item.conversionRate).toFixed(2)\n        : null\n    var g2 =\n      item.isHighValue && item.quantity && item.price\n        ? (item.quantity * item.price).toFixed(2)\n        : null\n    return {\n      $orig: $orig,\n      a0: a0,\n      g1: g1,\n      g2: g2,\n    }\n  })\n  var g3 = _vm.drugList.length\n  if (!_vm._isMounted) {\n    _vm.e0 = function (batch, index) {\n      var args = [],\n        len = arguments.length - 2\n      while (len-- > 0) args[len] = arguments[len + 2]\n\n      var _temp = args[args.length - 1].currentTarget.dataset,\n        _temp2 = _temp.eventParams || _temp[\"event-params\"],\n        index = _temp2.index\n      var _temp, _temp2\n      return _vm.onBatchSelect(index, batch)\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        l0: l0,\n        g3: g3,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"page\">\r\n\t\t<!-- é¡µé¢å¤´éƒ¨ï¼šä¸å…¥åº“å•ä¿æŒä¸€è‡´é£æ ¼ -->\r\n\t\t<view class=\"page-header\">\r\n\t\t\t<view class=\"header-content\">\r\n\t\t\t\t<text class=\"header-title\">è¯æå‡ºåº“</text>\r\n\t\t\t\t<text class=\"header-subtitle\">å‡ºåº“æ—¥æœŸï¼š{{ currentDate }}</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- åŸºæœ¬ä¿¡æ¯å¡ç‰‡ï¼šå¯¹é½å…¥åº“å•å¸ƒå±€ -->\r\n\t\t<view class=\"info-card\">\r\n\t\t\t<view class=\"info-row\">\r\n\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t<text class=\"label\">å•å·ï¼š</text>\r\n\t\t\t\t\t<text class=\"value\">{{ recordNo || 'è‡ªåŠ¨ç”Ÿæˆ' }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t<text class=\"label\">å‘æ”¾äººï¼š</text>\r\n\t\t\t\t\t<text class=\"value\">{{ dispenser }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"info-row\">\r\n\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t<text class=\"label\">å‡ºåº“åˆ°å›­åŒºï¼š<text class=\"required\">*</text></text>\r\n\t\t\t\t\t<picker \r\n\t\t\t\t\t\t:range=\"locations\" \r\n\t\t\t\t\t\trange-key=\"label\"\r\n\t\t\t\t\t\t:value=\"locationIndex\"\r\n\t\t\t\t\t\t@change=\"onLocationChange\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<view class=\"picker-input\">\r\n\t\t\t\t\t\t\t<text class=\"value\">{{ currentLocation.label }}</text>\r\n\t\t\t\t\t\t\t<text class=\"picker-arrow\">â€º</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</picker>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t<text class=\"label\">å›­åŒºè¯·é¢†ï¼š</text>\r\n\t\t\t\t\t<picker \r\n\t\t\t\t\t\t:range=\"requestAreas\" \r\n\t\t\t\t\t\trange-key=\"label\"\r\n\t\t\t\t\t\t:value=\"requestAreaIndex\"\r\n\t\t\t\t\t\t@change=\"onRequestAreaChange\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<view class=\"picker-input\">\r\n\t\t\t\t\t\t\t<text class=\"value\">{{ currentRequestArea.label }}</text>\r\n\t\t\t\t\t\t\t<text class=\"picker-arrow\">â€º</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</picker>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"info-row\">\r\n\t\t\t\t<view class=\"info-item full\">\r\n\t\t\t\t\t<text class=\"label\">å¤‡æ³¨</text>\r\n\t\t\t\t\t<input \r\n\t\t\t\t\t\tclass=\"input-value\" \r\n\t\t\t\t\t\tv-model=\"remark\" \r\n\t\t\t\t\t\tplaceholder=\"è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯ï¼ˆé€‰å¡«ï¼‰\"\r\n\t\t\t\t\t\tplaceholder-class=\"placeholder\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- è¯ææ˜ç»† -->\r\n\t\t<view class=\"form-section\">\r\n\t\t\t<view class=\"section-title\">\r\n\t\t\t\tè¯ææ˜ç»†\r\n\t\t\t\t<text class=\"section-count\">({{ drugList.length }}ç§)</text>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- æ·»åŠ è¯ææŒ‰é’® -->\r\n\t\t\t<view class=\"action-buttons\">\r\n\t\t\t\t<view class=\"add-drug-btn\" @click=\"goSelectDrug\">\r\n\t\t\t\t\t<text class=\"btn-icon\">â•</text>\r\n\t\t\t\t\t<text class=\"btn-text\">æ·»åŠ è¯æ</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- è¯æåˆ—è¡¨ -->\r\n\t\t\t<view class=\"drug-list\">\r\n\t\t\t\t<view \r\n\t\t\t\t\tv-for=\"(item, index) in drugList\" \r\n\t\t\t\t\t:key=\"index\" \r\n\t\t\t\t\tclass=\"drug-item\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<!-- è¯æå¤´éƒ¨ -->\r\n\t\t\t\t\t<view class=\"drug-header\">\r\n\t\t\t\t\t\t<view class=\"drug-title-row\">\r\n\t\t\t\t\t\t\t<view class=\"drug-badges\">\r\n\t\t\t\t\t\t\t\t<text v-if=\"item.isHighValue\" class=\"badge high-value\">é«˜å€¼</text>\r\n\t\t\t\t\t\t\t\t<text v-if=\"item.isEmergency\" class=\"badge emergency\">æ€¥æ•‘</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<text class=\"drug-name\">{{ item.drugName }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"drug-delete\" @click=\"deleteDrug(index)\">åˆ é™¤</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- è§„æ ¼å•ä½åˆå¹¶ä¸€è¡Œ -->\r\n\t\t\t\t\t<view class=\"drug-spec-row\">\r\n\t\t\t\t\t\t<text class=\"spec-icon\">ğŸ“¦</text>\r\n\t\t\t\t\t\t<text class=\"spec-text\">{{ item.specification || item.spec }}</text>\r\n\t\t\t\t\t\t<text class=\"spec-divider\">Â·</text>\r\n\t\t\t\t\t\t<text class=\"unit-text\">å•ä½: {{ item.unit }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- è¯æä»£ç ï¼ˆå¦‚æœ‰ï¼‰ -->\r\n\t\t\t\t\t<view v-if=\"item.drugCode\" class=\"drug-code-row\">\r\n\t\t\t\t\t\t<text class=\"code-icon\">ğŸ·ï¸</text>\r\n\t\t\t\t\t\t<text class=\"code-text\">ä»£ç : {{ item.drugCode }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- è°ƒè¯•ä¿¡æ¯ï¼šæ˜¾ç¤ºdrugId -->\r\n\t\t\t\t\t<view class=\"drug-debug-row\" style=\"font-size: 20rpx; color: #999; padding: 5rpx 0;\">\r\n\t\t\t\t\t\t<text>ğŸ” drugId: {{ item.drugId || 'âŒ æ— ' }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"drug-input-section\">\r\n\t\t\t\t\t<!-- æ‰¹æ¬¡ä¿¡æ¯ï¼ˆå·²é€‰ä¸­ï¼‰ -->\r\n\t\t\t\t\t<view v-if=\"item.batch\" class=\"batch-info-selected\">\r\n\t\t\t\t\t\t<view class=\"batch-info-row\">\r\n\t\t\t\t\t\t\t<text class=\"batch-label\">æ‰¹å·ï¼š</text>\r\n\t\t\t\t\t\t\t<text class=\"batch-value\">{{ item.batch }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"batch-info-row\">\r\n\t\t\t\t\t\t\t<text class=\"batch-label\">â° æœ‰æ•ˆæœŸï¼š</text>\r\n\t\t\t\t\t\t\t<text class=\"batch-value\">{{ item.expireDate }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"batch-info-row\">\r\n\t\t\t\t\t\t\t<text class=\"batch-label\">ğŸ“Š åº“å­˜ï¼š</text>\r\n\t\t\t\t\t\t\t<text class=\"batch-value\">{{ item.stockQuantity }} {{ item.unit }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- æ‰¹æ¬¡é€‰æ‹©æŒ‰é’®ï¼ˆæœªé€‰ä¸­æ—¶æ˜¾ç¤ºï¼‰ -->\r\n\t\t\t\t\t<view v-else class=\"batch-select-row\">\r\n\t\t\t\t\t\t<batch-selector\r\n\t\t\t\t\t\t\tbutton-text=\"ğŸ” é€‰æ‹©æ‰¹æ¬¡\"\r\n\t\t\t\t\t\t\tbutton-type=\"info\"\r\n\t\t\t\t\t\t\tbutton-size=\"small\"\r\n\t\t\t\t\t\t\t:drug-id=\"item.drugId\"\r\n\t\t\t\t\t\t\t:drug-info=\"{ name: item.drugName, specification: item.specification || item.spec, unit: item.unit }\"\r\n\t\t\t\t\t\t\t:show-location-filter=\"false\"\r\n\t\t\t\t\t\t\t:default-location=\"'drug_storage'\"\r\n\t\t\t\t\t\t\t:enable-f-i-f-o=\"true\"\r\n\t\t\t\t\t\t\t@select=\"(batch) => onBatchSelect(index, batch)\"\r\n\t\t\t\t\t\t></batch-selector>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<!-- å‡ºåº“æ•°é‡ -->\r\n\t\t\t\t\t\t<view class=\"input-row\">\r\n\t\t\t\t\t\t\t<text class=\"input-label\">å‡ºåº“æ•°é‡ *</text>\r\n\t\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\t\tclass=\"input-field\" \r\n\t\t\t\t\t\t\t\tv-model.number=\"item.quantity\" \r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t:placeholder=\"`æœ€å¤š${item.stockQuantity || 0}`\"\r\n\t\t\t\t\t\t\t\t@blur=\"validateQuantity(index)\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<text class=\"input-unit\">{{ item.unit }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- å•ä½è½¬æ¢æç¤º -->\r\n\t\t\t\t\t<view v-if=\"item.quantity && item.conversionRate && item.conversionRate > 1\" class=\"convert-hint\">\r\n\t\t\t\t\t\t<text class=\"hint-icon\">ğŸ”„</text>\r\n\t\t\t\t\t\t<text class=\"hint-text\">\r\n\t\t\t\t\t\t\tå°†è½¬æ¢ä¸º {{ (item.quantity * item.conversionRate).toFixed(2) }} {{ item.minUnit }} å­˜å…¥{{ currentLocation.label }}\r\n\t\t\t\t\t\t</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<!-- é«˜å€¼è¯æé‡‘é¢æç¤º -->\r\n\t\t\t\t\t\t<view v-if=\"item.isHighValue && item.quantity && item.price\" class=\"amount-hint\">\r\n\t\t\t\t\t\t\t<text class=\"amount-label\">é‡‘é¢ï¼š</text>\r\n\t\t\t\t\t\t\t<text class=\"amount-value\">Â¥{{ (item.quantity * item.price).toFixed(2) }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<!-- ç©ºçŠ¶æ€ -->\r\n\t\t\t\t<view v-if=\"drugList.length === 0\" class=\"empty-hint\">\r\n\t\t\t<text>ğŸ’Š æš‚æ— è¯æï¼Œè¯·ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ </text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- ç­¾ååŒºåŸŸ -->\r\n\t\t<view class=\"form-section\">\r\n\t\t\t<view class=\"section-title\">å‘æ”¾äººç­¾å *</view>\r\n\t\t\t<signature \r\n\t\t\t\tv-model=\"dispenserSign\"\r\n\t\t\t\ttitle=\"å‘æ”¾äººç­¾å\"\r\n\t\t\t></signature>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- åº•éƒ¨æŒ‰é’® -->\r\n\t\t<view class=\"bottom-actions\">\r\n\t\t\t<view class=\"bottom-btn btn-secondary\" @click=\"saveDraft\">\r\n\t\t\t\t<text>ä¿å­˜è‰ç¨¿</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"bottom-btn btn-primary\" @click=\"submitReview\">\r\n\t\t\t\t<text>æäº¤å¤æ ¸</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport Signature from '@/components/signature/index.vue'\r\nimport BatchSelector from '@/components/batch-selector/index.vue'\r\nimport Common from '@/utils/common.js'\r\n\r\nexport default {\r\n\tcomponents: {\r\n\t\tSignature,\r\n\t\tBatchSelector\r\n\t},\r\n\t\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\trecordNo: '',\r\n\t\t\tcurrentTime: '',\r\n\t\t\tcurrentDate: '',\r\n\t\t\tdispenser: '',\r\n\t\t\tremark: '',\r\n\t\t\tlocationIndex: 0,\r\n\t\t\tlocations: [\r\n\t\t\t\t{ label: 'é™†å›­', value: 'land_park' },\r\n\t\t\t\t{ label: 'æ°´å›­', value: 'water_park' }\r\n\t\t\t],\r\n\t\t\t// å½“å‰é€‰æ‹©çš„å‘å¾€å›­åŒºï¼ˆç›®çš„åœ°ï¼‰ï¼Œæ€»åº“å›ºå®šä¸º drug_storage\r\n\t\t\tcurrentLocation: { label: 'é™†å›­', value: 'land_park' },\r\n\t\t\trequestAreaIndex: 0,\r\n\t\t\trequestAreas: [\r\n\t\t\t\t{ label: 'ä¸é€‰æ‹©', value: '' },\r\n\t\t\t\t// ä»¥ä¸‹ç¤ºä¾‹è¡¨ç¤ºé¡¹ç›®/éƒ¨é—¨ç­‰éåŒ»åŠ¡å•ä½ï¼Œè¯·æ ¹æ®å®é™…éœ€è¦è°ƒæ•´\r\n\t\t\t\t{ label: 'é™†å›­é¡¹ç›®ç»„', value: 'land_project' },\r\n\t\t\t\t{ label: 'æ°´å›­é¡¹ç›®ç»„', value: 'water_project' }\r\n\t\t\t],\r\n\t\t\tcurrentRequestArea: { label: 'ä¸é€‰æ‹©', value: '' },\r\n\t\t\tdrugList: [],\r\n\t\t\tdispenserSign: ''\r\n\t\t}\r\n\t},\r\n\t\r\n\tonLoad(options) {\r\n\t\t// æ¸…ç©ºä¸Šæ¬¡çš„è¯ææ˜ç»†\r\n\t\tthis.drugList = []\r\n\t\t// æ¸…ç©ºå¯èƒ½æ®‹ç•™çš„ç¼“å­˜\r\n\t\tuni.removeStorageSync('selectedDrugsForOut')\r\n\t\t// åˆå§‹åŒ–é¡µé¢\r\n\t\tthis.initPage()\r\n\t},\r\n\t\r\n\tonShow() {\r\n\t\t// ä»é€‰æ‹©è¯æé¡µé¢è¿”å›æ—¶ï¼Œæ¥æ”¶é€‰ä¸­çš„è¯ææ•°æ®\r\n\t\tconst selectedDrugs = uni.getStorageSync('selectedDrugsForOut')\r\n\t\t\r\n\t\tif (selectedDrugs && selectedDrugs.length > 0) {\r\n\t\t\tconsole.log('=== å‡ºåº“é¡µé¢ onShow ===')\r\n\t\t\tconsole.log('ä»ç¼“å­˜è¯»å–çš„è¯ææ•°é‡:', selectedDrugs.length)\r\n\t\t\t\r\n\t\t\t// åˆå¹¶æ–°é€‰æ‹©çš„è¯æï¼Œé¿å…é‡å¤\r\n\t\t\tselectedDrugs.forEach((drug, index) => {\r\n\t\t\t\tconsole.log(`è¯æ${index + 1}:`, drug.name || drug.drugName)\r\n\t\t\t\tconsole.log(`  - drug._id: ${drug._id}`)\r\n\t\t\t\tconsole.log(`  - drug.drugId: ${drug.drugId || 'æ— '}`)\r\n\t\t\t\tconsole.log(`  - å®Œæ•´æ•°æ®:`, drug)\r\n\t\t\t\r\n\t\t\tconst exists = this.drugList.find(item => item.drugId === drug.drugId)\r\n\t\t\tif (!exists) {\r\n\t\t\t\t// åˆå§‹åŒ–è¯ææ•°æ®ç»“æ„\r\n\t\t\t\tconst finalDrugId = drug._id || drug.drugId\r\n\t\t\t\tconsole.log(`  - æœ€ç»ˆä½¿ç”¨çš„ drugId: ${finalDrugId}`)\r\n\t\t\t\t\r\n\t\t\t\tthis.drugList.push({\r\n\t\t\t\t\tdrugId: finalDrugId,\r\n\t\t\t\t\tdrugCode: drug.drugCode || '',\r\n\t\t\t\t\tdrugName: drug.name || drug.drugName,\r\n\t\t\t\t\tspecification: drug.specification || drug.spec || '',\r\n\t\t\t\t\tspec: drug.specification || drug.spec || '',\r\n\t\t\t\t\tunit: drug.unit || '',\r\n\t\t\t\t\tmanufacturer: drug.manufacturer || '',\r\n\t\t\t\t\tisHighValue: drug.isHighValue || false,\r\n\t\t\t\t\tisEmergency: drug.isEmergency || false,\r\n\t\t\t\t\t// æ‰¹æ¬¡ç›¸å…³ä¿¡æ¯ï¼ˆä½¿ç”¨ä»é€‰æ‹©è¯æé¡µé¢ä¼ æ¥çš„æ•°æ®ï¼‰\r\n\t\t\t\t\tbatch: drug.batch || '',\r\n\t\t\t\t\tbatchId: drug.batchId || '',\r\n\t\t\t\t\texpireDate: drug.expireDate || '',\r\n\t\t\t\t\tproductionDate: drug.productionDate || '',\r\n\t\t\t\t\tstockQuantity: drug.stockQuantity || 0,\r\n\t\t\t\t\tprice: drug.price || 0,\r\n\t\t\t\t\tquantity: '',\r\n\t\t\t\t\t// å•ä½è½¬æ¢ä¿¡æ¯\r\n\t\t\t\t\tconversionRate: drug.conversionRate || 1,\r\n\t\t\t\t\tminUnit: drug.minUnit || drug.unit || '',\r\n\t\t\t\t\tisNearExpiry: drug.isNearExpiry || false\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t\t\r\n\t\tconsole.log('å½“å‰è¯æåˆ—è¡¨:', this.drugList)\r\n\t\t\r\n\t\t// æ¸…é™¤ç¼“å­˜\r\n\t\tuni.removeStorageSync('selectedDrugsForOut')\r\n\t}\r\n},\r\n\t\r\n\tmethods: {\r\n\t\tinitPage() {\r\n\t\t\t// ç”Ÿæˆå‡ºåº“å•å·\r\n\t\t\tthis.recordNo = Common.generateRecordNo('CK')\r\n\t\t\t// å½“å‰æ—¶é—´ä¸æ—¥æœŸ\r\n\t\t\tconst now = new Date()\r\n\t\t\tthis.currentTime = Common.formatDate(now, 'YYYY-MM-DD HH:mm')\r\n\t\t\tthis.currentDate = Common.formatDate(now, 'YYYY-MM-DD')\r\n\t\t\t// è·å–å½“å‰ç”¨æˆ·\r\n\t\t\tconst userInfo = uni.getStorageSync('userInfo')\r\n\t\t\tthis.dispenser = userInfo?.name || 'æœªç™»å½•'\r\n\t\t},\r\n\t\t\r\n\t\tonLocationChange(e) {\r\n\t\t\tthis.locationIndex = e.detail.value\r\n\t\t\tthis.currentLocation = this.locations[this.locationIndex]\r\n\t\t},\r\n\t\t\r\n\t\tonRequestAreaChange(e) {\r\n\t\t\tthis.requestAreaIndex = e.detail.value\r\n\t\t\tthis.currentRequestArea = this.requestAreas[this.requestAreaIndex]\r\n\t\t},\r\n\t\t\r\n\t\t// é€‰æ‹©è¯æï¼ˆä¿æŒåŸæœ‰é€»è¾‘å ä½ï¼‰\r\n\t\tgoSelectDrug() {\r\n\t\t\t// è¿™é‡Œå¤ç”¨åŸæ¥è·³è½¬é€‰æ‹©è¯æé¡µé¢çš„é€»è¾‘\r\n\t\t\tuni.navigateTo({ url: '/pages-sub/out/select-drug' })\r\n\t\t},\r\n\t\t// æ„å»ºå¸¦åŒ…è£…å•ä½çš„å®Œæ•´è§„æ ¼ï¼Œä¾›äº‘å‡½æ•°è§£æã€‚å¦‚ï¼š10mlÃ—9æ”¯/ç›’\r\n\t\tbuildSpecification(drug) {\r\n\t\t\tconst base = drug.specification || drug.spec || ''\r\n\t\t\tif (!base) return ''\r\n\t\t\tif (base.includes('/') || base.includes('ï¼')) return base\r\n\t\t\tif (drug.unit) return `${base}/${drug.unit}`\r\n\t\t\treturn base\r\n\t\t},\r\n\t\t\r\n\t\t// åˆ é™¤ä¸€è¡Œè¯æ\r\n\t\tdeleteDrug(index) {\r\n\t\t\tthis.drugList.splice(index, 1)\r\n\t\t},\r\n\t\t\r\n\t\t// æ‰¹æ¬¡é€‰æ‹©å›è°ƒ\r\n\t\tonBatchSelect(index, batch) {\r\n\t\t\tconst item = this.drugList[index]\r\n\t\t\tif (!item) return\r\n\t\t\titem.batch = batch.batch\r\n\t\t\titem.batchId = batch._id\r\n\t\t\titem.expireDate = batch.expireDate\r\n\t\t\titem.stockQuantity = batch.quantity\r\n\t\t\titem.price = batch.price || item.price || 0\r\n\t\t\titem.isNearExpiry = batch.isNearExpiry || false\r\n\t\t},\r\n\t\t\r\n\t\t// æ ¡éªŒæ•°é‡ä¸èƒ½è¶…è¿‡åº“å­˜\r\n\t\tvalidateQuantity(index) {\r\n\t\t\tconst item = this.drugList[index]\r\n\t\t\tif (!item) return\r\n\t\t\tconst max = Number(item.stockQuantity || 0)\r\n\t\t\tconst val = Number(item.quantity || 0)\r\n\t\t\tif (val <= 0 || !Number.isFinite(val)) {\r\n\t\t\t\titem.quantity = ''\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (val > max) {\r\n\t\t\t\titem.quantity = max\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'æ•°é‡ä¸èƒ½è¶…è¿‡åº“å­˜',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// FIFOè‡ªåŠ¨åˆ†é…æ‰¹æ¬¡ â­ æ–°å¢\r\n\t\tasync autoAllocateBatch(index) {\r\n\t\t\tconst item = this.drugList[index]\r\n\t\t\t\r\n\t\t\tif (!item) return\r\n\t\t\t\r\n\t\t\t// å¦‚æœæ•°é‡ä¸ºç©ºæˆ–æ— æ•ˆï¼Œæ¸…ç©ºåˆ†é…ç»“æœ\r\n\t\t\tif (!item.quantity || item.quantity <= 0) {\r\n\t\t\t\tthis.$set(item, 'batchAllocation', [])\r\n\t\t\t\tthis.$set(item, 'batchCount', 0)\r\n\t\t\t\tthis.$set(item, 'hasNearExpiry', false)\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// æ£€æŸ¥drugId\r\n\t\t\tif (!item.drugId) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'è¯æIDç¼ºå¤±ï¼Œæ— æ³•åˆ†é…æ‰¹æ¬¡',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tuni.showLoading({ title: 'åˆ†é…æ‰¹æ¬¡ä¸­...' })\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await wx.cloud.callFunction({\r\n\t\t\t\t\tname: 'stockManage',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'allocateBatchesFIFO',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tdrugId: item.drugId,\r\n\t\t\t\t\t\t\trequiredQuantity: item.quantity,\r\n\t\t\t\t\t\t\tlocation: 'drug_storage'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('FIFOåˆ†é…ç»“æœ:', result.result)\r\n\t\t\t\t\r\n\t\t\t\tif (result.result.success) {\r\n\t\t\t\t\tconst { allocation, batchCount, hasNearExpiry } = result.result.data\r\n\t\t\t\t\t\r\n\t\t\t\t\t// ä¿å­˜åˆ†é…ç»“æœ\r\n\t\t\t\t\tthis.$set(item, 'batchAllocation', allocation)\r\n\t\t\t\t\tthis.$set(item, 'batchCount', batchCount)\r\n\t\t\t\t\tthis.$set(item, 'hasNearExpiry', hasNearExpiry)\r\n\t\t\t\t\t\r\n\t\t\t\t\t// è¿‘æ•ˆæœŸæç¤º\r\n\t\t\t\t\tif (hasNearExpiry) {\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\ttitle: 'è¿‘æ•ˆæœŸæç¤º',\r\n\t\t\t\t\t\t\tcontent: `${item.drugName} åŒ…å«è¿‘æ•ˆæœŸæ‰¹æ¬¡ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ`,\r\n\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\tif (!res.confirm) {\r\n\t\t\t\t\t\t\t\t\titem.quantity = ''\r\n\t\t\t\t\t\t\t\t\tthis.$set(item, 'batchAllocation', [])\r\n\t\t\t\t\t\t\t\t\tthis.$set(item, 'batchCount', 0)\r\n\t\t\t\t\t\t\t\t\tthis.$set(item, 'hasNearExpiry', false)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: `å·²åˆ†é… ${batchCount} ä¸ªæ‰¹æ¬¡`,\r\n\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(result.result.message)\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('æ‰¹æ¬¡åˆ†é…å¤±è´¥:', err)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: err.message || 'åˆ†é…å¤±è´¥',\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 2000\r\n\t\t\t\t})\r\n\t\t\t\tthis.$set(item, 'batchAllocation', [])\r\n\t\t\t} finally {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// ä¿å­˜è‰ç¨¿\r\n\t\tasync saveDraft() {\r\n\t\t\tif (this.drugList.length === 0) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'è¯·å…ˆæ·»åŠ è¯æ',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tuni.showLoading({ title: 'ä¿å­˜ä¸­...' })\r\n\t\t\ttry {\r\n\t\t\t\tconst userInfo = uni.getStorageSync('userInfo')\r\n\t\t\t\tconst result = await this.$api.callFunction('outRecords', {\r\n\t\t\t\t\taction: 'create',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\trecordNo: this.recordNo,\r\n\t\t\t\t\t\t// æ€»åº“ä½ç½®å›ºå®šä¸º drug_storage\r\n\t\t\t\t\t\tlocation: 'drug_storage',\r\n\t\t\t\t\t\tlocationName: 'æ€»åº“',\r\n\t\t\t\t\t\tfromLocation: 'drug_storage',\r\n\t\t\t\t\t\tfromLocationName: 'æ€»åº“',\r\n\t\t\t\t\t\t// å‡ºåº“åˆ°çš„å›­åŒº/åº“ä½\r\n\t\t\t\t\t\ttoLocation: this.currentLocation.value,\r\n\t\t\t\t\t\ttoLocationName: this.currentLocation.label,\r\n\t\t\t\t\t\trequestLocation: this.currentRequestArea.value,\r\n\t\t\t\t\t\trequestLocationName: this.currentRequestArea.label,\r\n\t\t\t\t\t\tdispenser: this.dispenser,\r\n\t\t\t\t\t\tdispenserId: userInfo?._id || '',\r\n\t\t\t\t\t\tdispenserSign: '',\r\n\t\t\t\t\t\tdispenserSignTime: '',\r\n\t\t\t\t\t\tremark: this.remark,\r\n\t\t\t\t\t\titems: this.drugList.map(drug => ({\r\n\t\t\t\t\t\t\tdrugId: drug.drugId,\r\n\t\t\t\t\t\t\tdrugCode: drug.drugCode || '',\r\n\t\t\t\t\t\t\tdrugName: drug.drugName,\r\n\t\t\t\t\t\t\tspecification: this.buildSpecification(drug),\r\n\t\t\t\t\t\t\tunit: drug.unit,\r\n\t\t\t\t\t\t\tmanufacturer: drug.manufacturer,\r\n\t\t\t\t\t\t\tbatch: drug.batch,\r\n\t\t\t\t\t\t\tbatchId: drug.batchId,\r\n\t\t\t\t\t\t\texpireDate: drug.expireDate,\r\n\t\t\t\t\t\t\tquantity: drug.quantity,\r\n\t\t\t\t\t\t\tprice: drug.price || 0,\r\n\t\t\t\t\t\t\tisHighValue: drug.isHighValue || false,\r\n\t\t\t\t\t\t\tisEmergency: drug.isEmergency || false\r\n\t\t\t\t\t\t})),\r\n\t\t\t\t\t\tstatus: 'draft'\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tif (result.success) {\r\n\t\t\t\t\tuni.showToast({ title: 'ä¿å­˜æˆåŠŸ', icon: 'success' })\r\n\t\t\t\t\tsetTimeout(() => { uni.navigateBack() }, 1500)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(result.message || 'ä¿å­˜å¤±è´¥')\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('ä¿å­˜å¤±è´¥:', err)\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tuni.showToast({ title: err.message || 'ä¿å­˜å¤±è´¥', icon: 'none' })\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// æäº¤å¤æ ¸\r\n\t\tasync submitReview() {\r\n\t\t\tif (!this.dispenserSign) {\r\n\t\t\t\tuni.showToast({ title: 'è¯·å…ˆå®Œæˆå‘æ”¾äººç­¾å', icon: 'none' })\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (this.drugList.length === 0) {\r\n\t\t\t\tuni.showToast({ title: 'è¯·å…ˆæ·»åŠ è¯æ', icon: 'none' })\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tuni.showLoading({ title: 'æäº¤ä¸­...' })\r\n\t\t\ttry {\r\n\t\t\t\tconst userInfo = uni.getStorageSync('userInfo')\r\n\t\t\t\tconst result = await this.$api.callFunction('outRecords', {\r\n\t\t\t\t\taction: 'create',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\trecordNo: this.recordNo,\r\n\t\t\t\t\t\t// æ€»åº“ä½ç½®å›ºå®šä¸º drug_storage\r\n\t\t\t\t\t\tlocation: 'drug_storage',\r\n\t\t\t\t\t\tlocationName: 'æ€»åº“',\r\n\t\t\t\t\t\tfromLocation: 'drug_storage',\r\n\t\t\t\t\t\tfromLocationName: 'æ€»åº“',\r\n\t\t\t\t\t\t// å‡ºåº“åˆ°çš„å›­åŒº/åº“ä½\r\n\t\t\t\t\t\ttoLocation: this.currentLocation.value,\r\n\t\t\t\t\t\ttoLocationName: this.currentLocation.label,\r\n\t\t\t\t\t\trequestLocation: this.currentRequestArea.value,\r\n\t\t\t\t\t\trequestLocationName: this.currentRequestArea.label,\r\n\t\t\t\t\t\tdispenser: this.dispenser,\r\n\t\t\t\t\t\tdispenserId: userInfo?._id || '',\r\n\t\t\t\t\t\tdispenserSign: this.dispenserSign,\r\n\t\t\t\t\t\tdispenserSignTime: new Date(),\r\n\t\t\t\t\t\tremark: this.remark,\r\n\t\t\t\t\t\titems: this.drugList.map(drug => ({\r\n\t\t\t\t\t\t\tdrugId: drug.drugId,\r\n\t\t\t\t\t\t\tdrugCode: drug.drugCode || '',\r\n\t\t\t\t\t\t\tdrugName: drug.drugName,\r\n\t\t\t\t\t\t\tspecification: this.buildSpecification(drug),\r\n\t\t\t\t\t\t\tunit: drug.unit,\r\n\t\t\t\t\t\t\tmanufacturer: drug.manufacturer,\r\n\t\t\t\t\t\t\tbatch: drug.batch,\r\n\t\t\t\t\t\t\tbatchId: drug.batchId,\r\n\t\t\t\t\t\t\texpireDate: drug.expireDate,\r\n\t\t\t\t\t\t\tquantity: drug.quantity,\r\n\t\t\t\t\t\t\tprice: drug.price || 0,\r\n\t\t\t\t\t\t\tisHighValue: drug.isHighValue || false,\r\n\t\t\t\t\t\t\tisEmergency: drug.isEmergency || false\r\n\t\t\t\t\t\t})),\r\n\t\t\t\t\t\tstatus: 'pending_review'\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tif (result.success) {\r\n\t\t\t\t\tuni.showToast({ title: 'æäº¤æˆåŠŸ', icon: 'success' })\r\n\t\t\t\t\tsetTimeout(() => { uni.navigateBack() }, 1500)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(result.message || 'æäº¤å¤±è´¥')\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('æäº¤å¤±è´¥:', err)\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tuni.showToast({ title: err.message || 'æäº¤å¤±è´¥', icon: 'none' })\r\n\t\t\t}\r\n \t\t}\r\n\t}\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.page {\r\n\tmin-height: 100vh;\r\n\t/* ä¸å…¥åº“æ–°å»ºé¡µä¸€è‡´çš„è“è‰²æ¸å˜èƒŒæ™¯ */\r\n\tbackground: linear-gradient(180deg, #00c9ff 0%, #00a0ff 35%, #e5e7eb 100%);\r\n\tpadding: 24rpx 24rpx 180rpx; // ä¸ºåº•éƒ¨å›ºå®šæŒ‰é’®ç•™å‡ºç©ºé—´\r\n}\r\n\r\n// é¡µé¢å¤´éƒ¨ï¼š702rpx è±¡ç‰™ç™½å¡ç‰‡\r\n.page-header {\r\n\tmax-width: 702rpx;\r\n\tmargin: 10rpx auto 8rpx;\r\n\tpadding: 30rpx 26rpx 26rpx;\r\n\tbackground: #FFFFF0;\r\n\tborder-radius: 22rpx;\r\n\tbox-shadow:\r\n\t\t0 1rpx 0 rgba(255, 255, 255, 0.9) inset,\r\n\t\t0 -1rpx 0 rgba(15, 23, 42, 0.06) inset,\r\n\t\t0 18rpx 40rpx rgba(15, 23, 42, 0.14);\r\n\t\r\n\t.header-content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\t\r\n\t\t.header-title {\r\n\t\t\tfont-size: 40rpx;\r\n\t\t\tfont-weight: bold;\r\n\t\t\tcolor: #111827;\r\n\t\t}\r\n\t\t\r\n\t\t.header-subtitle {\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #4b5563;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// åŸºæœ¬ä¿¡æ¯å¡ç‰‡ï¼šè±¡ç‰™ç™½å¡ç‰‡ï¼Œ702rpx è½¨é“\r\n.info-card {\r\n\tmax-width: 702rpx;\r\n\tmargin: 0 auto 8rpx;\r\n\tpadding: 26rpx 26rpx 24rpx;\r\n\tbackground: #FFFFF0;\r\n\tborder-radius: 22rpx;\r\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\r\n}\r\n\r\n// è¯ææ˜ç»†ä¸ç­¾åç­‰è¡¨å•æ¿å—\r\n.form-section {\r\n\tmax-width: 702rpx;\r\n\tmargin: 0 auto 8rpx;\r\n\tpadding: 26rpx 26rpx 24rpx;\r\n\tbackground-color: #FFFFF0;\r\n\tborder-radius: 22rpx;\r\n\tbox-shadow: 0 8rpx 20rpx rgba(15, 23, 42, 0.12);\r\n}\r\n\r\n.section-title {\r\n\tfont-size: 32rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #111827;\r\n\tmargin-bottom: 25rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n}\r\n\r\n.section-count {\r\n\tfont-size: 26rpx;\r\n\tcolor: #999999;\r\n\tmargin-left: 10rpx;\r\n\tfont-weight: normal;\r\n}\r\n\r\n.form-item {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tpadding: 20rpx 0;\r\n\tborder-bottom: 1px solid #F8F8F8;\r\n}\r\n\r\n.form-item:last-child {\r\n\tborder-bottom: none;\r\n}\r\n\r\n.form-label {\r\n\tfont-size: 28rpx;\r\n\tcolor: #333333;\r\n\tflex: 1;\r\n}\r\n\r\n.form-value {\r\n\tfont-size: 28rpx;\r\n\tcolor: #333333;\r\n\tflex: 1;\r\n}\r\n\r\n.picker-input {\r\n\tfont-size: 28rpx;\r\n\tcolor: #333333;\r\n\tdisplay: inline-flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tbackground-color: #ffffff;\r\n\tborder-radius: 999rpx;\r\n\tpadding: 6rpx 20rpx;\r\n\tbox-shadow: 0 2rpx 6rpx rgba(0, 0, 0, 0.04);\r\n\tmax-width: 100%;\r\n}\r\n\r\n.picker-arrow {\r\n\tfont-size: 32rpx;\r\n\tcolor: #999999;\r\n}\r\n\r\n.action-buttons {\r\n\tdisplay: flex;\r\n\tgap: 15rpx;\r\n\tmargin-bottom: 25rpx;\r\n}\r\n\r\n.add-drug-btn {\r\n\tbackground: linear-gradient(135deg, #00c9ff 0%, #00a0ff 100%);\r\n\tcolor: #ffffff;\r\n\tpadding: 22rpx 40rpx;\r\n\tborder-radius: 999rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tgap: 12rpx;\r\n\tbox-shadow: 0 6rpx 16rpx rgba(0, 160, 255, 0.25);\r\n\t\r\n\t.btn-icon {\r\n\t\tfont-size: 32rpx;\r\n\t}\r\n\t\r\n\t.btn-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 500;\r\n\t}\r\n}\r\n\r\n.drug-list {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 8rpx;\r\n}\r\n\r\n.drug-item {\r\n\tbackground-color: #FFFFF0;\r\n\tpadding: 25rpx;\r\n\tborder-radius: 18rpx;\r\n\tposition: relative;\r\n}\r\n\r\n.high-value-badge {\r\n\tposition: absolute;\r\n\ttop: -8rpx;\r\n\tright: 20rpx;\r\n\tbackground-color: #FF9800;\r\n\tcolor: #FFFFFF;\r\n\tfont-size: 20rpx;\r\n\tpadding: 4rpx 15rpx;\r\n\tborder-radius: 15rpx;\r\n\tz-index: 10;\r\n}\r\n\r\n.drug-header {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: flex-start;\r\n\tmargin-bottom: 12rpx;\r\n}\r\n\r\n.drug-title-row {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 12rpx;\r\n\tflex: 1;\r\n}\r\n\r\n.drug-badges {\r\n\tdisplay: flex;\r\n\tgap: 8rpx;\r\n\tflex-shrink: 0;\r\n\t\r\n\t.badge {\r\n\t\tfont-size: 20rpx;\r\n\t\tpadding: 4rpx 12rpx;\r\n\t\tborder-radius: 8rpx;\r\n\t\tfont-weight: 500;\r\n\t\t\r\n\t\t&.high-value {\r\n\t\t\tbackground: #FFF3E0;\r\n\t\t\tcolor: #FF9800;\r\n\t\t}\r\n\t\t\r\n\t\t&.emergency {\r\n\t\t\tbackground: #FFEBEE;\r\n\t\t\tcolor: #F44336;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n.drug-name {\r\n\tfont-size: 30rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333333;\r\n\tflex: 1;\r\n}\r\n\r\n.drug-delete {\r\n\tfont-size: 26rpx;\r\n\tcolor: #FF6B6B;\r\n\tpadding: 8rpx 15rpx;\r\n}\r\n\r\n// è§„æ ¼å•ä½åˆå¹¶è¡Œ\r\n.drug-spec-row {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 8rpx;\r\n\tmargin-bottom: 10rpx;\r\n\tpadding: 10rpx 15rpx;\r\n\tbackground: #FFFFFF;\r\n\tborder-radius: 10rpx;\r\n\t\r\n\t.spec-icon {\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\t\r\n\t.spec-text {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #333333;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\t\r\n\t.spec-divider {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #CCCCCC;\r\n\t\tmargin: 0 4rpx;\r\n\t}\r\n\t\r\n\t.unit-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #666666;\r\n\t}\r\n}\r\n\r\n// è¯æä»£ç è¡Œ\r\n.drug-code-row {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 8rpx;\r\n\tmargin-bottom: 15rpx;\r\n\tpadding: 8rpx 15rpx;\r\n\tbackground: #F5F7FA;\r\n\tborder-radius: 8rpx;\r\n\t\r\n\t.code-icon {\r\n\t\tfont-size: 24rpx;\r\n\t}\r\n\t\r\n\t.code-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #666666;\r\n\t}\r\n}\r\n\r\n.drug-info {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 8rpx;\r\n\tmargin-bottom: 20rpx;\r\n\tpadding-bottom: 20rpx;\r\n\tborder-bottom: 1px solid #E0E0E0;\r\n}\r\n\r\n.info-row {\r\n\tdisplay: flex;\r\n\tgap: 20rpx;\r\n\tmargin-bottom: 20rpx;\r\n\t\r\n\t&:last-child {\r\n\t\tmargin-bottom: 0;\r\n\t}\r\n\t\r\n\t.info-item {\r\n\t\tflex: 1;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 12rpx;\r\n\t\t\r\n\t\t&.full {\r\n\t\t\tflex: 1 1 100%;\r\n\t\t}\r\n\t\t\r\n\t\t.label {\r\n\t\t\tfont-size: 22rpx;\r\n\t\t\tcolor: #9ca3af;\r\n\t\t\tfont-weight: 400;\r\n\t\t}\r\n\t\t\r\n\t\t.value {\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #111827;\r\n\t\t\tfont-weight: 500;\r\n\t\t}\r\n\t\t\r\n\t\t.input-value {\r\n\t\t\tflex: 1;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #323233;\r\n\t\t\tborder-radius: 999rpx;\r\n\t\t\tpadding: 10rpx 20rpx;\r\n\t\t\tbackground-color: #ffffff;\r\n\t\t\tbox-shadow: 0 2rpx 6rpx rgba(0, 0, 0, 0.04);\r\n\t\t\tborder: none;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n.drug-input-section {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 20rpx;\r\n}\r\n\r\n.input-row {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n}\r\n\r\n.input-label {\r\n\tfont-size: 26rpx;\r\n\tcolor: #666666;\r\n\tmin-width: 160rpx;\r\n}\r\n\r\n.input-field {\r\n\tflex: 1;\r\n\tbackground-color: #FFFFFF;\r\n\tpadding: 15rpx 20rpx;\r\n\tborder-radius: 10rpx;\r\n\tfont-size: 26rpx;\r\n}\r\n\r\n.input-unit {\r\n\tfont-size: 24rpx;\r\n\tcolor: #999999;\r\n\tmargin-left: 10rpx;\r\n\tmin-width: 50rpx;\r\n}\r\n\r\n// æ‰¹æ¬¡é€‰æ‹©è¡Œ\r\n.batch-select-row {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 8rpx;\r\n\tmargin-bottom: 15rpx;\r\n}\r\n\r\n.batch-quick-info {\r\n\tfont-size: 22rpx;\r\n\tcolor: #666;\r\n\tpadding-left: 10rpx;\r\n}\r\n\r\n// æ‰¹æ¬¡ä¿¡æ¯ç´§å‡‘æ˜¾ç¤ºï¼ˆæ—§æ ·å¼ï¼Œä¿ç•™ï¼‰\r\n.batch-info-compact {\r\n\tbackground: linear-gradient(135deg, #E8F5E9 0%, #F1F8F4 100%);\r\n\tpadding: 15rpx 20rpx;\r\n\tborder-radius: 12rpx;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 10rpx;\r\n\tmargin-bottom: 15rpx;\r\n\t\r\n\t.batch-icon {\r\n\t\tfont-size: 24rpx;\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\t\r\n\t.batch-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #333333;\r\n\t\tflex: 1;\r\n\t}\r\n}\r\n\r\n// å·²é€‰æ‰¹æ¬¡ä¿¡æ¯æ˜¾ç¤ºï¼ˆæ–°æ ·å¼ï¼‰\r\n.batch-info-selected {\r\n\tbackground: linear-gradient(135deg, #E3F2FD 0%, #F1F8FF 100%);\r\n\tpadding: 20rpx;\r\n\tborder-radius: 12rpx;\r\n\tmargin-bottom: 15rpx;\r\n\tborder-left: 4rpx solid #2196F3;\r\n}\r\n\r\n.batch-info-row {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tmargin-bottom: 8rpx;\r\n\t\r\n\t&:last-child {\r\n\t\tmargin-bottom: 0;\r\n\t}\r\n}\r\n\r\n.batch-label {\r\n\tfont-size: 24rpx;\r\n\tcolor: #666;\r\n\tmin-width: 140rpx;\r\n}\r\n\r\n.batch-value {\r\n\tfont-size: 26rpx;\r\n\tcolor: #333;\r\n\tfont-weight: 500;\r\n}\r\n\r\n.text-warning {\r\n\tcolor: #FF9800 !important;\r\n\tfont-weight: bold;\r\n}\r\n\r\n// ä¿ç•™æ—§æ ·å¼ä»¥å…¼å®¹\r\n.batch-info-display {\r\n\tbackground-color: #E8F5E9;\r\n\tpadding: 15rpx 20rpx;\r\n\tborder-radius: 10rpx;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 8rpx;\r\n}\r\n\r\n.batch-detail-row {\r\n\tdisplay: flex;\r\n\tfont-size: 24rpx;\r\n}\r\n\r\n.batch-label {\r\n\tcolor: #666666;\r\n\tmin-width: 100rpx;\r\n}\r\n\r\n.batch-value {\r\n\tcolor: #333333;\r\n\tflex: 1;\r\n}\r\n\r\n// å•ä½è½¬æ¢æç¤º\r\n.convert-hint {\r\n\tbackground: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);\r\n\tpadding: 16rpx 20rpx;\r\n\tborder-radius: 12rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tmargin-top: 12rpx;\r\n\tborder-left: 4rpx solid #2196F3;\r\n\t\r\n\t.hint-icon {\r\n\t\tfont-size: 24rpx;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\t\r\n\t.hint-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #1976D2;\r\n\t\tline-height: 1.6;\r\n\t\tflex: 1;\r\n\t}\r\n}\r\n\r\n.amount-hint {\r\n\tbackground-color: #FFF3E0;\r\n\tpadding: 15rpx 20rpx;\r\n\tborder-radius: 10rpx;\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tmargin-top: 12rpx;\r\n}\r\n\r\n.amount-label {\r\n\tfont-size: 26rpx;\r\n\tcolor: #666666;\r\n}\r\n\r\n.amount-value {\r\n\tfont-size: 30rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #FF9800;\r\n}\r\n\r\n.empty-hint {\r\n\ttext-align: center;\r\n\tpadding: 60rpx 0;\r\n\tfont-size: 26rpx;\r\n\tcolor: #999999;\r\n}\r\n\r\n.bottom-actions {\r\n\tposition: fixed;\r\n\tbottom: 0;\r\n\tleft: 0;\r\n\tright: 0;\r\n\tbackground-color: #FFFFFF;\r\n\tpadding: 20rpx 30rpx 26rpx;\r\n\tdisplay: flex;\r\n\tgap: 20rpx;\r\n\tbox-shadow: 0 -2rpx 14rpx rgba(15, 23, 42, 0.12);\r\n\tz-index: 100;\r\n}\r\n\r\n.bottom-btn {\r\n\tflex: 1;\r\n\tpadding: 24rpx;\r\n\tborder-radius: 999rpx;\r\n\ttext-align: center;\r\n\tfont-size: 28rpx;\r\n\tfont-weight: 500;\r\n\t\r\n\t&.btn-primary {\r\n\t\tbackground: linear-gradient(135deg, #00c9ff 0%, #00a0ff 100%);\r\n\t\tcolor: #ffffff;\r\n\t\tbox-shadow: 0 6rpx 16rpx rgba(0, 160, 255, 0.25);\r\n\t}\r\n\t\r\n\t&.btn-secondary {\r\n\t\tbackground: linear-gradient(135deg, #00c9ff 0%, #00a0ff 100%);\r\n\t\tcolor: #ffffff;\r\n\t\tborder: none;\r\n\t\tbox-shadow: 0 6rpx 16rpx rgba(0, 160, 255, 0.25);\r\n\t}\r\n}\r\n\r\n// FIFOæ‰¹æ¬¡åˆ†é…ç»“æœæ ·å¼ â­ æ–°å¢\r\n.batch-allocation {\r\n\tmargin-top: 20rpx;\r\n\tbackground: linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 100%);\r\n\tborder-radius: 12rpx;\r\n\tpadding: 20rpx;\r\n\tborder-left: 4rpx solid #0EA5E9;\r\n}\r\n\r\n.allocation-title {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tmargin-bottom: 15rpx;\r\n\tpadding-bottom: 12rpx;\r\n\tborder-bottom: 1rpx solid #BAE6FD;\r\n\t\r\n\t.title-icon {\r\n\t\tfont-size: 28rpx;\r\n\t\tmargin-right: 8rpx;\r\n\t}\r\n\t\r\n\t.title-text {\r\n\t\tfont-size: 26rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #0369A1;\r\n\t\tflex: 1;\r\n\t}\r\n\t\r\n\t.batch-count {\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #0284C7;\r\n\t\tbackground-color: #FFFFFF;\r\n\t\tpadding: 4rpx 12rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t}\r\n}\r\n\r\n.allocation-item {\r\n\tbackground-color: #FFFFFF;\r\n\tborder-radius: 10rpx;\r\n\tpadding: 15rpx;\r\n\tmargin-bottom: 12rpx;\r\n\tborder: 1rpx solid #E0F2FE;\r\n\t\r\n\t&:last-child {\r\n\t\tmargin-bottom: 0;\r\n\t}\r\n\t\r\n\t&.near-expiry {\r\n\t\tbackground: linear-gradient(135deg, #FFF7ED 0%, #FFEDD5 100%);\r\n\t\tborder-color: #FED7AA;\r\n\t}\r\n}\r\n\r\n.alloc-header {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tmargin-bottom: 10rpx;\r\n\tpadding-bottom: 8rpx;\r\n\tborder-bottom: 1rpx dashed #E5E7EB;\r\n}\r\n\r\n.alloc-batch-label {\r\n\tfont-size: 24rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #0369A1;\r\n}\r\n\r\n.expiry-badge {\r\n\tfont-size: 20rpx;\r\n\tcolor: #EA580C;\r\n\tbackground-color: #FFF7ED;\r\n\tpadding: 4rpx 10rpx;\r\n\tborder-radius: 12rpx;\r\n\tborder: 1rpx solid #FDBA74;\r\n}\r\n\r\n.alloc-row {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tmargin-bottom: 6rpx;\r\n\tfont-size: 24rpx;\r\n\t\r\n\t&:last-child {\r\n\t\tmargin-bottom: 0;\r\n\t}\r\n}\r\n\r\n.alloc-label {\r\n\tcolor: #6B7280;\r\n\tmin-width: 100rpx;\r\n}\r\n\r\n.alloc-value {\r\n\tcolor: #111827;\r\n\tfont-weight: 500;\r\n\tflex: 1;\r\n\t\r\n\t&.text-warning {\r\n\t\tcolor: #EA580C;\r\n\t\tfont-weight: bold;\r\n\t}\r\n}\r\n\r\n.alloc-stock {\r\n\tfont-size: 22rpx;\r\n\tcolor: #9CA3AF;\r\n\tmargin-left: 8rpx;\r\n}\r\n\r\n.days-badge {\r\n\tfont-size: 20rpx;\r\n\tcolor: #DC2626;\r\n\tbackground-color: #FEE2E2;\r\n\tpadding: 2rpx 8rpx;\r\n\tborder-radius: 10rpx;\r\n\tmargin-left: 8rpx;\r\n}\r\n\r\n.near-expiry-tip {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tbackground: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);\r\n\tpadding: 12rpx 16rpx;\r\n\tborder-radius: 8rpx;\r\n\tmargin-top: 12rpx;\r\n\tborder-left: 3rpx solid #F59E0B;\r\n\t\r\n\t.tip-icon {\r\n\t\tfont-size: 24rpx;\r\n\t\tmargin-right: 8rpx;\r\n\t}\r\n\t\r\n\t.tip-text {\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #92400E;\r\n\t\tflex: 1;\r\n\t}\r\n}\r\n</style>\r\n\r\n","import mod from \"-!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add.vue?vue&type=style&index=0&id=017bfd6a&lang=scss&scoped=true&\"; export default mod; export * from \"-!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\googleä¸‹è½½èµ„æ–™\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add.vue?vue&type=style&index=0&id=017bfd6a&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1766582361747\n      var cssReload = require(\"F:/googleä¸‹è½½èµ„æ–™/HBuilderX.4.84.2025110307/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}