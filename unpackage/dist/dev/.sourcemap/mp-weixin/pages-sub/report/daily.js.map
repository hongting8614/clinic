{"version":3,"sources":["uni-app:///main.js","webpack:///D:/AK-PMS/pages-sub/report/daily.vue?34c7","webpack:///D:/AK-PMS/pages-sub/report/daily.vue?bd46","webpack:///D:/AK-PMS/pages-sub/report/daily.vue?0f72","webpack:///D:/AK-PMS/pages-sub/report/daily.vue?8bd0","uni-app:///pages-sub/report/daily.vue","webpack:///D:/AK-PMS/pages-sub/report/daily.vue?eb4f","webpack:///D:/AK-PMS/pages-sub/report/daily.vue?3ceb"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","name","data","reportContent","reportDate","reportLocation","stats","tableData","isEditingText","isEditingVisitor","isEditingEmployee","diseaseList","visitorSummary","employeeSummary","onLoad","console","methods","generateFromClinicRecords","uni","title","action","location","startDate","endDate","pageSize","useClinicRecords","res","records","locationName","d","yy","mm","dd","icon","formatDailyReport","total","visitor","employee","outcall","ex","count","existed","l","list","disease","locations","report","calculateStats","visitorTotal","employeeTotal","outcallTotal","prepareTableData","doctorName","diseaseName","visitTime","isOutcall","generateSummaries","obj","counts","editReportText","duration","toggleEditTable","type","copyTable","text","success","fail","copySummary","values","exportCSV","csv","fs","filePath","encoding","fileType","showMenu","getTemplateHeader","getTemplateMapping","buildTemplateRow","keys","rows","m","max","top","matchedKey","other","otherMap","dateText","locÊì¶‰º§","locÈ™®Êäò","remark","copyTemplateRow","exportTemplateCSV","copyReport","fullContent","goBack"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACsC;;;AAG1F;AAC4M;AAC5M,gBAAgB,gNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAkyB,CAAgB,8xBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eC0EtzB;EACAC;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACA;MACAC,cACA,4DACA,+DACA,qDACA;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACA;MACA;IACA;IACA;MACA;IACA;IACA;MACA;IACA;IACA;MACA;QACA;MACA;QACAC;MACA;IACA;IACA;MACA;QACA;MACA;QACAA;MACA;IACA;;IAEA;IACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACA;QACA;MACA;MACA;MACA;IACA;IACA;IACA;EACA;EACAC;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAC;kBAAAC;gBAAA;gBAAA;gBAAA,OACAvB;kBACAK;kBACAC;oBACAkB;oBACAlB;sBACAmB;sBACAC;sBACAC;sBACAC;sBACAC;oBACA;kBACA;gBACA;cAAA;gBAZAC;gBAaAC;gBACAC,uDAEA;gBACA;gBACA;gBACA;gBACAC;gBACAC;gBACAC;gBACAC;gBACA;gBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAjB;gBACAG;kBAAAC;kBAAAc;gBAAA;cAAA;gBAAA;gBAEAf;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAgB;MACA;MACA;MACA;MACA;MACA;MAEA;QAAAC;QAAAC;QAAAC;QAAAC;MAAA;MACAX;QACA;QACA;QACA;QACA;QACA;UACA;YAAA;UAAA;UACAY;YAAAlB;YAAAmB;UAAA;QACA;QACA;QACA;QACA;UAAA;QAAA;QACA;UACAC;UACA;YAAA;YACA;cAAA;YAAA;YACAC;cAAAzC;cAAAuC;YAAA;UACA;QACA;UACAG;YACAC;YACAT;YACAU;cAAA5C;cAAAuC;YAAA;UACA;QACA;MACA;MAEA;MACA;QACA;UAAA;QAAA;QACA;UAAA;UACA;YACA;cAAA;YAAA;YACA;UACA;UACA;QACA;QACAM;MACA;MACA;QACA;UAAA;QAAA;QACAA;UAAA;QAAA;MACA;MACA;QACA;UAAA;QAAA;QACAA;UAAA;QAAA;MACA;MACA;IACA;IAEA;IACAC;MACA;QAAAZ;QAAAa;QAAAC;QAAAC;MAAA;MACAvB;QACA;QACA;QACA,uCACA;QACA;MACA;MACA;IACA;IAEA;IACAwB;MACA;MACA;QACA;QAAAC;MACA;MACA;MACA;MACAzB;QACA;QACA;UACA1B;UACAoD;UACAhC;UACAiC;UACAC;UACAH;QACA;QACA;MACA;MACA;QAAAhB;QAAAC;MAAA;IACA;IACA;IACAmB;MAAA;QAAA;QAAA;MACA;QACA;QACA;UAAAC;QAAA;QACA;MACA;MACA;QACA;QACA;UAAA;QAAA;QACA;MACA;MACA;QACA;QACA;UACA;UACAC;QACA;QACA;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;QACA;QACAzC;UACAC;UACAc;UACA2B;QACA;MACA;IACA;IAEA;IACAC;MACA;QACA;MACA;QACA;MACA;MAEA,oDACAC;QACA;QACA5C;UACAC;UACAc;UACA2B;QACA;MACA;IACA;IAEA;IACAG;MACA;QACA7C;UACAC;UACAc;QACA;QACA;MACA;MAEA;MACA;QACAf;UACAC;UACAc;QACA;QACA;MACA;;MAEA;MACA;MACA;MACA+B;;MAEA;MACA9D;QACA;QACA;QACA;QACA;QACA8D;MACA;MAEA9C;QACAhB;QACA+D;UACA/C;YACAC;YACAc;YACA2B;UACA;QACA;QACAM;UACAhD;YACAC;YACAc;UACA;QACA;MACA;IACA;IAEA;IACAkC;MAAA;MACA;MACA;QACAjD;UAAAC;UAAAc;QAAA;QACA;MACA;MACA;QAAA;QAAA;MAAA;MACA,0CACAmC;MAAA,EACAA;;MAEAlD;QACAhB;QACA+D;UACA/C;YACAC;YACAc;UACA;QACA;MACA;IACA;IAEA;IACAoC;MAAA;MACA;QACA;QACA;UAAA;UACAC;QACA;QACA;MACA;MACA;MACA;MACA;MAEA;QACA;QACA;QACAC;UACAC;UACAtE;UACAuE;UACAR;YACArE;cACA4E;cACAE;cACAC;YACA;UACA;UACAT;YACA;YACAhD;cACAhB;cACA+D;gBAAA;kBAAA9C;kBAAAc;gBAAA;cAAA;YACA;UACA;QACA;MACA;QACA;QACAf;UACAhB;UACA+D;YAAA;cAAA9C;cAAAc;YAAA;UAAA;QACA;MACA;IACA;IAEA;IACA2C;MACA;MACA;IACA;IACAC;MACA;MACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;IACA;IACA;IACAC;MAAA;MACA;MACA;MACA;MACA;MACAC;QAAA;MAAA;MACA;MACA;MACA;QACA;QACAC;UACA;UACA;UACA;YAAA;UAAA;UACA;YACAC;UACA;QACA;QACA;QACA;QACAA;UAAA;YAAAC;YAAAC;UAAA;QAAA;QACA;MACA;MACA;MACA;MACA;MACAH;QACA;QACA;QAAA,2CACAD;UAAA;QAAA;UAAA;YAAA;YACA;cAAA;YAAA;cAAAK;cAAA;YAAA;UACA;QAAA;UAAA;QAAA;UAAA;QAAA;QACA,0CACAC;MACA;MACA;MACA;MACA;QACA;QAAAjC;MACA;MACA;MACA;MACA;MACA;MACA4B;QACA;QACA;UAAA;YAAA;UAAA;QAAA;QACA;UACAM;QACA;MACA;MACA;MACAA;QAAA;MAAA;MACA;MACA;MACA;MACA;MACA,QACAC;MAAA;MACA7B,cACAA,cACA8B,aACA9B,cACAA,cACAA,cACAA,cACAA,cACAA,cACAA,cACAA,cACAA,cACA+B,aACA/B,cACAA,cACAA,eACA2B,OACAlD,OACAiB,YACAsC,OACA;IACA;IACAC;MACA;MACA;QAAA;MAAA;MACAzE;QACAhB;QACA+D;UAAA;YAAA9C;YAAAc;UAAA;QAAA;MACA;IACA;IACA2D;MACA;MACA;QAAA;MAAA;MACA;MACA;QACA;QACA;QACArB;UACAC;UAAAtE;UAAAuE;UACAR;YAAA;cAAAO;cAAAE;cAAAC;YAAA;UAAA;QACA;MACA;QACAzD;UACAhB;UACA+D;YAAA;cAAA9C;cAAAc;YAAA;UAAA;QACA;MACA;IACA;IACA;IACA4D;MACA;QACA3E;UACAC;UACAc;QACA;QACA;MACA;;MAEA;MACA;MAEA;QACA6D;QACA;QACAA;QACA;QACA;UACA;UACA;UACA;UACA;UACAA;QACA;QACAA;MACA;MAEA;QACAA;QACA;QACAA;QACA;QACA;UACA;UACA;UACA;UACA;UACAA;QACA;MACA;MAEA5E;QACAhB;QACA+D;UACA/C;YACAC;YACAc;YACA2B;UACA;QACA;QACAM;UACAhD;YACAC;YACAc;UACA;QACA;MACA;IACA;IAEA;IACA8D;MACA7E;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACroBA;AAAA;AAAA;AAAA;AAAigD,CAAgB,i7CAAG,EAAC,C;;;;;;;;;;;ACArhD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages-sub/report/daily.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages-sub/report/daily.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./daily.vue?vue&type=template&id=4d34a038&scoped=true&\"\nvar renderjs\nimport script from \"./daily.vue?vue&type=script&lang=js&\"\nexport * from \"./daily.vue?vue&type=script&lang=js&\"\nimport style0 from \"./daily.vue?vue&type=style&index=0&id=4d34a038&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4d34a038\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages-sub/report/daily.vue\"\nexport default component.exports","export * from \"-!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./daily.vue?vue&type=template&id=4d34a038&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./daily.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./daily.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"daily-report-page\">\n    <!-- Êó•Êä•ÂÜÖÂÆπÂå∫Âüü -->\n    <view class=\"report-container\">\n      <!-- Êó•Êä•ÊñáÊú¨ÔºàÂèØÁºñËæëÔºâ -->\n      <view class=\"report-card\">\n        <view class=\"report-header\">\n          <text class=\"report-date\">{{ reportDate }}</text>\n          <text class=\"report-location\">{{ reportLocation }}</text>\n          <view class=\"header-actions\">\n            <view class=\"action-btn\" @click=\"editReportText\">\n              <text class=\"action-icon\">{{ isEditingText ? '‚úì' : '‚úèÔ∏è' }}</text>\n            </view>\n            <view class=\"action-btn\" @click=\"copyReport\">\n              <text class=\"action-icon\">üìã</text>\n            </view>\n          </view>\n        </view>\n        \n        <view class=\"report-content\">\n          <textarea \n            v-if=\"isEditingText\"\n            v-model=\"reportContent\" \n            class=\"report-textarea\"\n            placeholder=\"ËØ∑ËæìÂÖ•Êó•Êä•ÂÜÖÂÆπ\"\n            auto-height\n          ></textarea>\n          <text v-else class=\"report-text\" selectable>{{ reportContent }}</text>\n        </view>\n      </view>\n\n\n      <!-- ÁªüËÆ°‰ø°ÊÅØ -->\n      <view class=\"stats-card\" v-if=\"stats\">\n        <view class=\"stats-title\">ÁªüËÆ°‰ø°ÊÅØ</view>\n        <view class=\"stats-grid\">\n          <view class=\"stat-item\">\n            <text class=\"stat-value\">{{ stats.total }}</text>\n            <text class=\"stat-label\">ÊÄªÊé•ËØä</text>\n          </view>\n          <view class=\"stat-item\">\n            <text class=\"stat-value\">{{ stats.visitorTotal }}</text>\n            <text class=\"stat-label\">Ê∏∏ÂÆ¢</text>\n          </view>\n          <view class=\"stat-item\">\n            <text class=\"stat-value\">{{ stats.employeeTotal }}</text>\n            <text class=\"stat-label\">ÂëòÂ∑•</text>\n          </view>\n          <view class=\"stat-item\">\n            <text class=\"stat-value\">{{ stats.outcallTotal }}</text>\n            <text class=\"stat-label\">Âá∫ËØäÊ¨°Êï∞</text>\n          </view>\n        </view>\n        <view class=\"template-actions\">\n          <button class=\"mini-btn\" @click=\"copyTemplateRow('visitor')\">Ê®°ÊùøÂ§çÂà∂-Ê∏∏ÂÆ¢</button>\n          <button class=\"mini-btn\" @click=\"copyTemplateRow('employee')\">Ê®°ÊùøÂ§çÂà∂-ÂëòÂ∑•</button>\n          <button class=\"mini-btn\" @click=\"exportTemplateCSV('visitor')\">Ê®°ÊùøCSV-Ê∏∏ÂÆ¢</button>\n          <button class=\"mini-btn\" @click=\"exportTemplateCSV('employee')\">Ê®°ÊùøCSV-ÂëòÂ∑•</button>\n        </view>\n      </view>\n\n      <!-- ‰∏ãÊñπ‰ªÖ‰øùÁïôÁªüËÆ°‰ø°ÊÅØÂç°ÁâáÂíåÂ∫ïÈÉ®Êìç‰ΩúÊ†èÔºåÂéªÊéâÊòéÁªÜ‰∏éÊ±áÊÄªË°®Ê†º -->\n    </view>\n\n    <!-- Â∫ïÈÉ®Êìç‰ΩúÊ†èÔºàÁªü‰∏Ä‰ΩøÁî®È°∂ÈÉ®ÂØºËà™ËøîÂõûÁÆ≠Â§¥Ôºâ -->\n    <view class=\"bottom-actions\">\n      <button class=\"action-button secondary\" @click=\"goClinic\">Èó®ËØäÁôªËÆ∞</button>\n      <button class=\"action-button primary\" @click=\"copyReport\">Â§çÂà∂ÂÖ®ÈÉ®</button>\n      <button class=\"action-button primary\" @click=\"exportCSV\">ÂØºÂá∫CSV</button>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  name: 'ReportDaily',\n  data() {\n    return {\n      reportContent: '',\n      reportDate: '',\n      reportLocation: '',\n      stats: null,\n      tableData: null,\n      isEditingText: false,\n      isEditingVisitor: false,\n      isEditingEmployee: false,\n      // Âõ∫ÂÆöÁñæÁóÖÊ∏ÖÂçïÔºàÁî®‰∫éÊ±áÊÄªÊä•Ë°®ÔºâÔºå‰∏∫Á©∫‰πüË¶ÅÊòæÁ§∫\n      diseaseList: [\n        'Êì¶‰º§','Êâ≠‰º§','Ââ≤‰º§','ÁÉ´‰º§','Ë∑å‰º§','Êíû‰º§','ËÑÜ‰º§','Êå´‰º§','Â§¥Áóõ','Â§¥Êôï',\n        'ÊÑüÂÜí','ÂèëÁÉß','Âí≥ÂóΩ','ËÖπÊ≥ª','ËÖπÁóõ','ÊÅ∂ÂøÉÂëïÂêê','ËøáÊïè','ÁöÆÁñπ','ÁâôÁóõ','ÂÖ≥ËäÇÁóõ',\n        'ËÖ∞Áóõ','ËÉ∏Èó∑','ÂøÉÊÖå','ÊôïÂé•','‰∏≠Êöë','ÁóõÁªè','ËÉÉÁóõ','È™®Êäò','ÂÖ∂‰ªñ'\n      ],\n      visitorSummary: null,\n      employeeSummary: null\n    }\n  },\n  onLoad(options) {\n    // ‰ªéÈ°µÈù¢ÂèÇÊï∞Ëé∑ÂèñÊó•Êä•ÂÜÖÂÆπ\n    if (options.content) {\n      this.reportContent = decodeURIComponent(options.content)\n    }\n    if (options.date) {\n      this.reportDate = decodeURIComponent(options.date)\n    }\n    if (options.location) {\n      this.reportLocation = decodeURIComponent(options.location)\n    }\n    if (options.stats) {\n      try {\n        this.stats = JSON.parse(decodeURIComponent(options.stats))\n      } catch (e) {\n        console.error('Ëß£ÊûêÁªüËÆ°‰ø°ÊÅØÂ§±Ë¥•:', e)\n      }\n    }\n    if (options.tableData) {\n      try {\n        this.tableData = JSON.parse(decodeURIComponent(options.tableData))\n      } catch (e) {\n        console.error('Ëß£ÊûêË°®Ê†ºÊï∞ÊçÆÂ§±Ë¥•:', e)\n      }\n    }\n\n    // Â¶ÇÊûúÊú™Êê∫Â∏¶ÂÜÖÂÆπÔºåÂàôÂú®Êú¨È°µÁõ¥Êé•Ê†πÊçÆÈó®ËØäÁôªËÆ∞ÁîüÊàêÔºàÈªòËÆ§ÂΩìÂ§© + ÊúÄËøëÂõ≠Âå∫Ôºâ\n    if (!this.reportContent) {\n      const now = new Date()\n      const y = now.getFullYear()\n      const m = String(now.getMonth() + 1).padStart(2, '0')\n      const d = String(now.getDate()).padStart(2, '0')\n      const dateStr = `${y}-${m}-${d}`\n      let loc = 'land_park'\n      try {\n        const saved = uni.getStorageSync('clinic_last_location')\n        if (saved === 'land_park' || saved === 'water_park') loc = saved\n      } catch (e) {}\n      this.generateFromClinicRecords(dateStr, loc)\n      return\n    }\n    // ÁîüÊàêÊ±áÊÄªÔºàÂ∏¶ÂèÇÊâìÂºÄÊó∂Ôºâ\n    this.generateSummaries()\n  },\n  methods: {\n    // Âú®Êú¨È°µÁõ¥Êé•Ë∞ÉÁî®Èó®ËØä‰ø°ÊÅØÁîüÊàêÊó•Êä•\n    async generateFromClinicRecords(dateStr, location) {\n      try {\n        uni.showLoading({ title: 'Âä†ËΩΩ‰∏≠...' })\n        const res = await wx.cloud.callFunction({\n          name: 'clinicRecords',\n          data: {\n            action: 'list',\n            data: {\n              location,\n              startDate: dateStr,\n              endDate: dateStr,\n              pageSize: 1000,\n              useClinicRecords: true\n            }\n          }\n        })\n        const records = res?.result?.data?.list || []\n        const locationName = location === 'land_park' ? 'ÈôÜÂõ≠' : 'Ê∞¥Âõ≠'\n        \n        // ÁîüÊàêÊñáÊú¨„ÄÅÁªüËÆ°‰∏éË°®Ê†º\n        this.reportContent = this.formatDailyReport(records, dateStr, locationName)\n        this.stats = this.calculateStats(records)\n        this.tableData = this.prepareTableData(records)\n        const d = new Date(dateStr)\n        const yy = d.getFullYear()\n        const mm = String(d.getMonth() + 1).padStart(2, '0')\n        const dd = String(d.getDate()).padStart(2, '0')\n        this.reportDate = `${yy}Âπ¥${mm}Êúà${dd}Êó•`\n        this.reportLocation = locationName\n        this.generateSummaries()\n      } catch (e) {\n        console.error('ÁîüÊàêÊó•Êä•Â§±Ë¥•:', e)\n        uni.showToast({ title: 'ÁîüÊàêÂ§±Ë¥•', icon: 'none' })\n      } finally {\n        uni.hideLoading()\n      }\n    },\n\n    // ÊñáÊú¨Êó•Êä•ÊûÑÂª∫Ôºà‰∏éÁôªËÆ∞È°µÂè£ÂæÑ‰∏ÄËá¥Ôºâ\n    formatDailyReport(records, dateStr, locationName) {\n      const dt = new Date(dateStr)\n      const y = dt.getFullYear()\n      const m = dt.getMonth() + 1\n      const d = dt.getDate()\n      const dateFormatted = `${y}Âπ¥${m}Êúà${d}Êó•`\n      \n      const agg = { total: records.length, visitor: [], employee: [], outcall: [] }\n      records.forEach(r => {\n        const identity = r.identity || 'Ê∏∏ÂÆ¢'\n        const disease = r.diseaseName || r.diagnosis || r.chiefComplaint || 'Êú™Áü•'\n        const site = r.injuryLocation || ''\n        const isOut = r.isOutcall || r.visitType === 'outcall'\n        if (isOut && site) {\n          const ex = agg.outcall.find(i => i.location === site)\n          ex ? ex.count++ : agg.outcall.push({ location: site, count: 1 })\n        }\n        const bucket = identity === 'ÂëòÂ∑•' ? 'employee' : 'visitor'\n        const list = agg[bucket]\n        const existed = list.find(i => i.disease === disease)\n        if (existed) {\n          existed.total++\n          if (bucket === 'visitor' && site) {\n            const l = existed.locations?.find(x => x.name === site)\n            l ? l.count++ : existed.locations.push({ name: site, count: 1 })\n          }\n        } else {\n          list.push({\n            disease,\n            total: 1,\n            locations: bucket === 'visitor' && site ? [{ name: site, count: 1 }] : []\n          })\n        }\n      })\n      \n      let report = `${dateFormatted}Ê¨¢‰πêË∞∑ÂåªÂä°ÂÆ§Ôºà${locationName}ÔºâÂΩìÊó•Êé•ËØäÂÖ±ËÆ°${agg.total}‰∫∫„ÄÇ`\n      if (agg.visitor.length) {\n        const vt = agg.visitor.reduce((s, i) => s + i.total, 0)\n        const parts = agg.visitor.map(i => {\n          if (i.locations?.length) {\n            const lp = i.locations.map(l => `${l.name}${l.count}‰∫∫`).join('Ôºå')\n            return `${i.disease}${i.total}‰∫∫Ôºà${lp}Ôºâ`\n          }\n          return `${i.disease}${i.total}‰∫∫`\n        })\n        report += `\\nÊ∏∏ÂÆ¢${vt}‰∫∫Ôºö${parts.join('Ôºå')}„ÄÇ`\n      }\n      if (agg.employee.length) {\n        const et = agg.employee.reduce((s, i) => s + i.total, 0)\n        report += `\\nÂëòÂ∑•${et}‰∫∫Ôºö${agg.employee.map(i => `${i.disease}${i.total}‰∫∫`).join('Ôºå')}„ÄÇ`\n      }\n      if (agg.outcall.length) {\n        const ot = agg.outcall.reduce((s, i) => s + i.count, 0)\n        report += `\\nÂá∫ËØä${ot}Ê¨°Ôºö${agg.outcall.map(i => `${i.location}${i.count}Ê¨°`).join('Ôºå')}„ÄÇ`\n      }\n      return report.trim()\n    },\n\n    // ÁÆÄË¶ÅÁªüËÆ°\n    calculateStats(records) {\n      const s = { total: records.length, visitorTotal: 0, employeeTotal: 0, outcallTotal: 0 }\n      records.forEach(r => {\n        const id = r.identity || 'Ê∏∏ÂÆ¢'\n        const isOut = r.isOutcall || r.visitType === 'outcall'\n        if (id === 'Ê∏∏ÂÆ¢') s.visitorTotal++\n        else if (id === 'ÂëòÂ∑•') s.employeeTotal++\n        if (isOut) s.outcallTotal++\n      })\n      return s\n    },\n\n    // Ë°®Ê†ºÊï∞ÊçÆ\n    prepareTableData(records) {\n      let doctorName = ''\n      try {\n        const u = uni.getStorageSync('userInfo'); doctorName = u?.name || ''\n      } catch (e) {}\n      const visitor = []\n      const employee = []\n      records.forEach(r => {\n        const id = r.identity || 'Ê∏∏ÂÆ¢'\n        const obj = {\n          name: r.name || '',\n          diseaseName: r.diseaseName || r.diagnosis || r.chiefComplaint || 'Êú™Áü•',\n          location: r.injuryLocation || '',\n          visitTime: r.visitDateTime || r.createTime || '',\n          isOutcall: r.isOutcall || r.visitType === 'outcall',\n          doctorName\n        }\n        if (id === 'Ê∏∏ÂÆ¢') visitor.push(obj); else if (id === 'ÂëòÂ∑•') employee.push(obj)\n      })\n      return { visitor, employee }\n    },\n    // ÁîüÊàêÂëòÂ∑•/Ê∏∏ÂÆ¢Ê±áÊÄª\n    generateSummaries() {\n      const initCounts = () => {\n        const obj = {}\n        this.diseaseList.forEach(name => { obj[name] = 0 })\n        return obj\n      }\n      const normalize = (name) => {\n        if (!name) return 'ÂÖ∂‰ªñ'\n        const found = this.diseaseList.find(d => name.indexOf(d) !== -1)\n        return found || 'ÂÖ∂‰ªñ'\n      }\n      const build = (rows) => {\n        const counts = initCounts()\n        ;(rows || []).forEach(item => {\n          const key = normalize(item.diseaseName)\n          counts[key] = (counts[key] || 0) + 1\n        })\n        return counts\n      }\n      this.visitorSummary = build(this.tableData?.visitor || [])\n      this.employeeSummary = build(this.tableData?.employee || [])\n    },\n    \n    // ÁºñËæëÊó•Êä•ÊñáÊú¨\n    editReportText() {\n      this.isEditingText = !this.isEditingText\n      if (!this.isEditingText) {\n        // ÈÄÄÂá∫ÁºñËæëÊ®°ÂºèÊó∂‰øùÂ≠ò\n        uni.showToast({\n          title: 'Â∑≤‰øùÂ≠ò',\n          icon: 'success',\n          duration: 1000\n        })\n      }\n    },\n\n    // ÂàáÊç¢Ë°®Ê†ºÁºñËæëÊ®°Âºè\n    toggleEditTable(type) {\n      if (type === 'visitor') {\n        this.isEditingVisitor = !this.isEditingVisitor\n      } else if (type === 'employee') {\n        this.isEditingEmployee = !this.isEditingEmployee\n      }\n      \n      if ((type === 'visitor' && !this.isEditingVisitor) || \n          (type === 'employee' && !this.isEditingEmployee)) {\n        // ÈÄÄÂá∫ÁºñËæëÊ®°ÂºèÊó∂‰øùÂ≠ò\n        uni.showToast({\n          title: 'Â∑≤‰øùÂ≠ò',\n          icon: 'success',\n          duration: 1000\n        })\n      }\n    },\n\n    // Â§çÂà∂Ë°®Ê†ºÔºàExcelÊ†ºÂºèÔºâ\n    copyTable(type) {\n      if (!this.tableData) {\n        uni.showToast({\n          title: 'ÊöÇÊó†Ë°®Ê†ºÊï∞ÊçÆ',\n          icon: 'none'\n        })\n        return\n      }\n\n      const data = type === 'visitor' ? this.tableData.visitor : this.tableData.employee\n      if (!data || data.length === 0) {\n        uni.showToast({\n          title: 'ÊöÇÊó†Êï∞ÊçÆ',\n          icon: 'none'\n        })\n        return\n      }\n\n      // ÁîüÊàêExcelÊ†ºÂºèÁöÑË°®Ê†ºÊñáÊú¨ÔºàÂà∂Ë°®Á¨¶ÂàÜÈöîÔºâ\n      let text = type === 'visitor' ? 'Ê∏∏ÂÆ¢Êé•ËØäÊòéÁªÜÔºö\\n' : 'ÂëòÂ∑•Êé•ËØäÊòéÁªÜÔºö\\n'\n      // Ë°®Â§¥Ôºà‰ΩøÁî®Âà∂Ë°®Á¨¶ÂàÜÈöîÔºâ\n      text += 'ÁñæÁóÖÂêçÁß∞\\tÂú∞ÁÇπ\\tÂá∫ËØä\\tÊé•ËØäÂåªÁîü\\n'\n      \n      // Êï∞ÊçÆË°åÔºà‰ΩøÁî®Âà∂Ë°®Á¨¶ÂàÜÈöîÔºâ\n      data.forEach(item => {\n        const disease = item.diseaseName || '-'\n        const location = item.location || '-'\n        const outcall = item.isOutcall ? 'ÊòØ' : 'Âê¶'\n        const doctor = item.doctorName || '-'\n        text += `${disease}\\t${location}\\t${outcall}\\t${doctor}\\n`\n      })\n\n      uni.setClipboardData({\n        data: text,\n        success: () => {\n          uni.showToast({\n            title: `Â∑≤Â§çÂà∂${type === 'visitor' ? 'Ê∏∏ÂÆ¢' : 'ÂëòÂ∑•'}Êï∞ÊçÆÔºàÂèØÁ≤òË¥¥Âà∞ExcelÔºâ`,\n            icon: 'success',\n            duration: 2000\n          })\n        },\n        fail: () => {\n          uni.showToast({\n            title: 'Â§çÂà∂Â§±Ë¥•',\n            icon: 'none'\n          })\n        }\n      })\n    },\n    \n    // Â§çÂà∂Ê±áÊÄªÊï∞ÊçÆÔºàÂè™Â§çÂà∂Êï∞ÊçÆÔºå‰∏çÂ§çÂà∂ÁñæÁóÖÂêçÂàóÔºâ\n    copySummary(type, orientation = 'horizontal') {\n      const summary = type === 'visitor' ? this.visitorSummary : this.employeeSummary\n      if (!summary) {\n        uni.showToast({ title: 'ÊöÇÊó†Ê±áÊÄªÊï∞ÊçÆ', icon: 'none' })\n        return\n      }\n      const values = this.diseaseList.map(name => String(summary[name] ?? 0))\n      const text = orientation === 'horizontal'\n        ? values.join('\\t')   // ‰∏ÄË°åÔºåÂà∂Ë°®Á¨¶ÂàÜÈöî\n        : values.join('\\n')   // Â§öË°åÔºå‰∏ÄÂàó\n      \n      uni.setClipboardData({\n        data: text,\n        success: () => {\n          uni.showToast({\n            title: `Â∑≤Â§çÂà∂${type === 'visitor' ? 'Ê∏∏ÂÆ¢' : 'ÂëòÂ∑•'}Ê±áÊÄªÊï∞ÊçÆ`,\n            icon: 'success'\n          })\n        }\n      })\n    },\n    \n    // ÂØºÂá∫CSVÔºàExcelÂèØÁõ¥Êé•ÊâìÂºÄÔºâ\n    exportCSV() {\n      const toCSV = (title, summary) => {\n        let csv = `${title}\\nÁñæÁóÖÂêçÁß∞,Ê¨°Êï∞\\n`\n        this.diseaseList.forEach(name => {\n          csv += `${name},${summary[name] ?? 0}\\n`\n        })\n        return csv + '\\n'\n      }\n      const vCSV = toCSV('Ê∏∏ÂÆ¢Ê±áÊÄª', this.visitorSummary || {})\n      const eCSV = toCSV('ÂëòÂ∑•Ê±áÊÄª', this.employeeSummary || {})\n      const content = vCSV + eCSV\n      \n      try {\n        const fs = wx.getFileSystemManager()\n        const filePath = `${wx.env.USER_DATA_PATH}/daily_report_${Date.now()}.csv`\n        fs.writeFile({\n          filePath,\n          data: content,\n          encoding: 'utf8',\n          success: () => {\n            wx.openDocument({\n              filePath,\n              fileType: 'csv',\n              showMenu: true\n            })\n          },\n          fail: () => {\n            // ÂõûÈÄÄ‰∏∫Â§çÂà∂\n            uni.setClipboardData({\n              data: content,\n              success: () => uni.showToast({ title: 'Â∑≤Â§çÂà∂CSVÊñáÊú¨', icon: 'success' })\n            })\n          }\n        })\n      } catch (e) {\n        // ‰∏çÊîØÊåÅÊñá‰ª∂Á≥ªÁªüÊó∂ÔºåÂ§çÂà∂\n        uni.setClipboardData({\n          data: content,\n          success: () => uni.showToast({ title: 'Â∑≤Â§çÂà∂CSVÊñáÊú¨', icon: 'success' })\n        })\n      }\n    },\n\n    // ================= Ê®°ÊùøÂØºÂá∫ÔºàÊåáÂÆöÂàóÈ°∫Â∫èÔºâ =================\n    getTemplateHeader() {\n      // Âõ∫ÂÆöÈ°∫Â∫èÔºàÂê´‰∏§‰∏™‚ÄúÂú∞ÁÇπ‚ÄùÔºâ\n      return ['Êó•Êúü/Âèó‰º§Á±ªÂûã','Êâ≠‰º§','Êì¶‰º§','Âú∞ÁÇπ','ÁÉ´‰º§','Á£ï‰º§','ÂÜª‰º§','ËÖπÊ≥ª','Â§¥Êôï','Â§¥Áóõ','ÊÑüÂÜí','ËÑ±Ëáº','È™®Êäò','Âú∞ÁÇπ','ËøáÊïè','ÁóõÁªè','ÊµãË°ÄÂéã','ÂÖ∂‰ªñ','ÂêàËÆ°','Êé•ËØäÂåªÁîü','Â§áÊ≥®']\n    },\n    getTemplateMapping() {\n      // ÂÖ≥ÈîÆËØçÊò†Â∞ÑÔºàËã•ÂåπÈÖçÂ§ö‰∏™Ôºå‰ª•È¶ñÊ¨°ÂåπÈÖç‰∏∫ÂáÜÔºâ\n      return {\n        'Êâ≠‰º§': ['Êâ≠‰º§'],\n        'Êì¶‰º§': ['Êì¶‰º§','Êì¶Á†¥'],\n        'ÁÉ´‰º§': ['ÁÉ´‰º§','ÁÉ´ÁÉ≠‰º§'],\n        'Á£ï‰º§': ['Á£ï‰º§','Êíû‰º§','Á£ïÁ¢∞','Êå´‰º§'],\n        'ÂÜª‰º§': ['ÂÜª‰º§'],\n        'ËÖπÊ≥ª': ['ËÖπÊ≥ª','ÊãâËÇö','ËÇ†ÁÇé','ËÇ†ËÉÉÁÇé'],\n        'Â§¥Êôï': ['Â§¥Êôï'],\n        'Â§¥Áóõ': ['Â§¥Áóõ','Â§¥Áñº'],\n        'ÊÑüÂÜí': ['ÊÑüÂÜí','‰∏äÂëºÂê∏ÈÅìÊÑüÊüì'],\n        'ËÑ±Ëáº': ['ËÑ±Ëáº','ÂÖ≥ËäÇËÑ±‰Ωç'],\n        'È™®Êäò': ['È™®Êäò'],\n        'ËøáÊïè': ['ËøáÊïè','Ëç®È∫ªÁñπ','ÁöÆÁñπ'],\n        'ÁóõÁªè': ['ÁóõÁªè'],\n        'ÊµãË°ÄÂéã': ['ÊµãË°ÄÂéã','Ë°ÄÂéã','ÈáèË°ÄÂéã']\n      }\n    },\n    // ÊûÑÂª∫‰∏ÄË°åÊï∞ÊçÆÔºà‰∏çÂê´Ë°®Â§¥Ôºâ\n    buildTemplateRow(type) {\n      const rows = type === 'visitor' ? (this.tableData?.visitor || []) : (this.tableData?.employee || [])\n      const mapping = this.getTemplateMapping()\n      const keys = Object.keys(mapping)\n      const counts = {}\n      keys.forEach(k => counts[k] = 0)\n      let other = 0\n      // Âú∞ÁÇπÔºàÊì¶‰º§„ÄÅÈ™®ÊäòÔºâÂêÑÂèñÂá∫Áé∞Ê¨°Êï∞ÊúÄÂ§öÁöÑ‰∏Ä‰∏™Âú∞ÁÇπ\n      const locCountFor = (diseaseKey) => {\n        const m = new Map()\n        rows.forEach(r => {\n          const disease = String(r.diseaseName || '')\n          const location = (r.location || '').trim()\n          const matched = mapping[diseaseKey].some(k => disease.indexOf(k) !== -1)\n          if (matched && location) {\n            m.set(location, (m.get(location) || 0) + 1)\n          }\n        })\n        let top = ''\n        let max = 0\n        m.forEach((v, k) => { if (v > max) { max = v; top = k } })\n        return top\n      }\n      const locÊì¶‰º§ = locCountFor('Êì¶‰º§')\n      const locÈ™®Êäò = locCountFor('È™®Êäò')\n      // ÁªüËÆ°\n      rows.forEach(r => {\n        const name = String(r.diseaseName || '')\n        let matchedKey = ''\n        for (const k of keys) {\n          if (mapping[k].some(w => name.indexOf(w) !== -1)) { matchedKey = k; break }\n        }\n        if (matchedKey) counts[matchedKey]++\n        else other++\n      })\n      // ÂåªÁîü\n      let doctorName = ''\n      try {\n        const u = uni.getStorageSync('userInfo'); doctorName = u?.name || ''\n      } catch (e) {}\n      // Êó•Êúü\n      const dateText = this.reportDate || ''\n      // Â§áÊ≥®ÔºöÊî∂ÈõÜÂΩíÂÖ•‚ÄúÂÖ∂‰ªñ‚ÄùÁöÑÂéüÁñæÁóÖÂêçÔºàÂéªÈáç+Ê¨°Êï∞Ôºâ\n      const otherMap = new Map()\n      rows.forEach(r => {\n        const name = String(r.diseaseName || '')\n        const isOther = !keys.some(k => mapping[k].some(w => name.indexOf(w) !== -1))\n        if (isOther && name) {\n          otherMap.set(name, (otherMap.get(name) || 0) + 1)\n        }\n      })\n      const remarkParts = []\n      otherMap.forEach((v,k) => remarkParts.push(`${k}${v}‰∫∫`))\n      const remark = remarkParts.join('„ÄÅ')\n      // ÂêàËÆ°\n      const total = rows.length\n      // ËæìÂá∫È°∫Â∫è\n      return [\n        dateText,               // Êó•Êúü/Âèó‰º§Á±ªÂûã\n        counts['Êâ≠‰º§'],\n        counts['Êì¶‰º§'],\n        locÊì¶‰º§ || '',\n        counts['ÁÉ´‰º§'],\n        counts['Á£ï‰º§'],\n        counts['ÂÜª‰º§'],\n        counts['ËÖπÊ≥ª'],\n        counts['Â§¥Êôï'],\n        counts['Â§¥Áóõ'],\n        counts['ÊÑüÂÜí'],\n        counts['ËÑ±Ëáº'],\n        counts['È™®Êäò'],\n        locÈ™®Êäò || '',\n        counts['ËøáÊïè'],\n        counts['ÁóõÁªè'],\n        counts['ÊµãË°ÄÂéã'],\n        other,\n        total,\n        doctorName,\n        remark\n      ]\n    },\n    copyTemplateRow(type) {\n      const row = this.buildTemplateRow(type)\n      const text = row.map(v => String(v ?? '')).join('\\t')\n      uni.setClipboardData({\n        data: text,\n        success: () => uni.showToast({ title: `Â∑≤Â§çÂà∂${type==='visitor'?'Ê∏∏ÂÆ¢':'ÂëòÂ∑•'}Ê®°ÊùøÊï∞ÊçÆ`, icon: 'success' })\n      })\n    },\n    exportTemplateCSV(type) {\n      const header = this.getTemplateHeader().join(',')\n      const row = this.buildTemplateRow(type).map(v => `\"${String(v ?? '').replace(/\"/g,'\"\"')}\"`).join(',')\n      const csv = `${header}\\n${row}\\n`\n      try {\n        const fs = wx.getFileSystemManager()\n        const filePath = `${wx.env.USER_DATA_PATH}/daily_${type}_${Date.now()}.csv`\n        fs.writeFile({\n          filePath, data: csv, encoding: 'utf8',\n          success: () => wx.openDocument({ filePath, fileType: 'csv', showMenu: true })\n        })\n      } catch (e) {\n        uni.setClipboardData({\n          data: csv,\n          success: () => uni.showToast({ title: 'Â∑≤Â§çÂà∂CSVÊñáÊú¨', icon: 'success' })\n        })\n      }\n    },\n    // Â§çÂà∂Êó•Êä•\n    copyReport() {\n      if (!this.reportContent) {\n        uni.showToast({\n          title: 'ÊöÇÊó†ÂÜÖÂÆπÂèØÂ§çÂà∂',\n          icon: 'none'\n        })\n        return\n      }\n\n      // ÁîüÊàêÂÆåÊï¥ÁöÑÊó•Êä•ÂÜÖÂÆπÔºàÂåÖÊã¨Ë°®Ê†ºÔºåExcelÊ†ºÂºèÔºâ\n      let fullContent = this.reportContent + '\\n\\n'\n      \n      if (this.tableData && this.tableData.visitor && this.tableData.visitor.length > 0) {\n        fullContent += 'Ê∏∏ÂÆ¢Êé•ËØäÊòéÁªÜÔºö\\n'\n        // Ë°®Â§¥ÔºàÂà∂Ë°®Á¨¶ÂàÜÈöîÔºâ\n        fullContent += 'ÁñæÁóÖÂêçÁß∞\\tÂú∞ÁÇπ\\tÂá∫ËØä\\tÊé•ËØäÂåªÁîü\\n'\n        // Êï∞ÊçÆË°åÔºàÂà∂Ë°®Á¨¶ÂàÜÈöîÔºâ\n        this.tableData.visitor.forEach(item => {\n          const disease = item.diseaseName || '-'\n          const location = item.location || '-'\n          const outcall = item.isOutcall ? 'ÊòØ' : 'Âê¶'\n          const doctor = item.doctorName || '-'\n          fullContent += `${disease}\\t${location}\\t${outcall}\\t${doctor}\\n`\n        })\n        fullContent += '\\n'\n      }\n\n      if (this.tableData && this.tableData.employee && this.tableData.employee.length > 0) {\n        fullContent += 'ÂëòÂ∑•Êé•ËØäÊòéÁªÜÔºö\\n'\n        // Ë°®Â§¥ÔºàÂà∂Ë°®Á¨¶ÂàÜÈöîÔºâ\n        fullContent += 'ÁñæÁóÖÂêçÁß∞\\tÂú∞ÁÇπ\\tÂá∫ËØä\\tÊé•ËØäÂåªÁîü\\n'\n        // Êï∞ÊçÆË°åÔºàÂà∂Ë°®Á¨¶ÂàÜÈöîÔºâ\n        this.tableData.employee.forEach(item => {\n          const disease = item.diseaseName || '-'\n          const location = item.location || '-'\n          const outcall = item.isOutcall ? 'ÊòØ' : 'Âê¶'\n          const doctor = item.doctorName || '-'\n          fullContent += `${disease}\\t${location}\\t${outcall}\\t${doctor}\\n`\n        })\n      }\n\n      uni.setClipboardData({\n        data: fullContent.trim(),\n        success: () => {\n          uni.showToast({\n            title: 'Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºàÂèØÁ≤òË¥¥Âà∞ExcelÔºâ',\n            icon: 'success',\n            duration: 2000\n          })\n        },\n        fail: () => {\n          uni.showToast({\n            title: 'Â§çÂà∂Â§±Ë¥•',\n            icon: 'none'\n          })\n        }\n      })\n    },\n\n    // ËøîÂõû\n    goBack() {\n      uni.navigateBack()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.daily-report-page {\n  min-height: 100vh;\n  // ‰ΩøÁî®Áªü‰∏ÄÁöÑËìùËâ≤Ê∏êÂèòËÉåÊôØ\n  background: linear-gradient(180deg, #00c9ff 0%, #00a0ff 35%, #e5e7eb 100%);\n  padding-top: 24rpx;\n  padding-bottom: 130rpx;\n}\n\n.report-container {\n  max-width: 702rpx;\n  margin: 0 auto;\n  padding: 24rpx 24rpx 40rpx;\n}\n\n.report-card {\n  background: #ffffff;\n  border-radius: 26rpx;\n  padding: 32rpx 30rpx;\n  box-shadow: 0 22rpx 60rpx rgba(15, 23, 42, 0.18);\n  margin-bottom: 8rpx;\n\n  .report-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 30rpx;\n    padding-bottom: 20rpx;\n    border-bottom: 2rpx solid #f0f0f0;\n\n    .report-date {\n      font-size: 32rpx;\n      font-weight: bold;\n      color: #0f172a;\n    }\n\n    .report-location {\n      font-size: 28rpx;\n      color: #0d9488;\n      font-weight: 500;\n      margin-left: 20rpx;\n    }\n\n    .header-actions {\n      display: flex;\n      gap: 10rpx;\n    }\n  }\n\n  .report-content {\n    .report-text {\n      display: block;\n      font-size: 30rpx;\n      line-height: 2;\n      color: #111827;\n      white-space: pre-wrap;\n      word-break: break-all;\n    }\n\n    .report-textarea {\n      width: 100%;\n      min-height: 200rpx;\n      font-size: 30rpx;\n      line-height: 2;\n      color: #111827;\n      padding: 20rpx;\n      border: 2rpx solid #e0e0e0;\n      border-radius: 12rpx;\n      background: #fafafa;\n    }\n  }\n}\n\n.table-card {\n  background: #ffffff;\n  border-radius: 24rpx;\n  padding: 28rpx 26rpx;\n  box-shadow: 0 20rpx 50rpx rgba(15, 23, 42, 0.16);\n  margin-bottom: 24rpx;\n\n  .table-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20rpx;\n    padding-bottom: 16rpx;\n    border-bottom: 2rpx solid #f0f0f0;\n\n    .table-title {\n      font-size: 32rpx;\n      font-weight: bold;\n      color: #0f172a;\n    }\n\n    .table-actions {\n      display: flex;\n      gap: 10rpx;\n    }\n  }\n\n  .table-wrapper {\n    overflow-x: auto;\n  }\n\n  .table {\n    width: 100%;\n    min-width: 600rpx;\n    border-collapse: collapse;\n\n    .table-row {\n      display: flex;\n      border-bottom: 1rpx solid #f0f0f0;\n\n      &.header-row {\n        background: linear-gradient(135deg, #14b8a6 0%, #22c1c3 100%);\n        border-radius: 8rpx 8rpx 0 0;\n      }\n\n      .table-cell {\n        flex: 1;\n        padding: 20rpx 12rpx;\n        font-size: 26rpx;\n        color: #111827;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        text-align: center;\n        word-break: break-all;\n\n        &.header-cell {\n          color: #ffffff;\n          font-weight: bold;\n          font-size: 28rpx;\n        }\n\n        .table-input {\n          width: 100%;\n          padding: 8rpx 12rpx;\n          font-size: 26rpx;\n          border: 1rpx solid #e0e0e0;\n          border-radius: 8rpx;\n          background: #fafafa;\n          text-align: center;\n        }\n      }\n    }\n  }\n}\n\n.action-btn {\n  padding: 8rpx 16rpx;\n  background: rgba(20, 184, 166, 0.1);\n  border-radius: 8rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  &.small {\n    padding: 6rpx 12rpx;\n  }\n\n  .action-icon {\n    font-size: 28rpx;\n  }\n}\n\n.stats-card {\n  background: #ffffff;\n  border-radius: 30rpx;\n  padding: 28rpx 26rpx;\n  box-shadow: 0 25rpx 60rpx rgba(15, 23, 42, 0.20);\n  margin-bottom: 8rpx;\n\n  .stats-title {\n    font-size: 32rpx;\n    font-weight: bold;\n    color: #333333;\n    margin-bottom: 24rpx;\n    padding-bottom: 16rpx;\n    border-bottom: 2rpx solid #f0f0f0;\n  }\n\n  .stats-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 20rpx;\n\n    .stat-item {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      padding: 24rpx;\n      background: linear-gradient(135deg, #f0f4f8 0%, #ffffff 100%);\n      border-radius: 16rpx;\n      border: 2rpx solid #e8e8e8;\n\n      .stat-value {\n        font-size: 48rpx;\n        font-weight: bold;\n        color: #667eea;\n        margin-bottom: 8rpx;\n      }\n\n      .stat-label {\n        font-size: 24rpx;\n        color: #666666;\n      }\n    }\n  }\n}\n\n.template-actions {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 12rpx;\n  margin-top: 16rpx;\n}\n.mini-btn {\n  padding: 16rpx 12rpx;\n  background: #f5f7ff;\n  border: 2rpx solid #c7d2fe;\n  color: #3730a3;\n  border-radius: 12rpx;\n  font-size: 26rpx;\n}\n\n.summary-grid {\n  display: grid;\n  grid-template-columns: 1fr auto;\n  gap: 12rpx 16rpx;\n}\n.summary-row {\n  display: contents;\n}\n.summary-disease {\n  font-size: 28rpx;\n  color: #475569;\n}\n.summary-count {\n  font-size: 28rpx;\n  color: #1e3a8a;\n  font-weight: 700;\n  text-align: right;\n}\n\n.bottom-actions {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  gap: 20rpx;\n  padding: 20rpx 30rpx;\n  background: #ffffff;\n  box-shadow: 0 -4rpx 12rpx rgba(0, 0, 0, 0.1);\n  z-index: 100;\n\n  .action-button {\n    flex: 1;\n    padding: 20rpx 24rpx;\n    border-radius: 999rpx;\n    font-size: 28rpx;\n    font-weight: bold;\n    border: none;\n\n    &.secondary {\n      background: linear-gradient(135deg, #00c9ff 0%, #00e0b8 100%);\n      color: #ffffff;\n    }\n\n    &.primary {\n      background: linear-gradient(135deg, #00c9ff 0%, #00e0b8 100%);\n      color: #ffffff;\n    }\n  }\n}\n</style>\n","import mod from \"-!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./daily.vue?vue&type=style&index=0&id=4d34a038&lang=scss&scoped=true&\"; export default mod; export * from \"-!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\google‰∏ãËΩΩËµÑÊñô\\\\HBuilderX.4.84.2025110307\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./daily.vue?vue&type=style&index=0&id=4d34a038&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1766576738030\n      var cssReload = require(\"F:/google‰∏ãËΩΩËµÑÊñô/HBuilderX.4.84.2025110307/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}