{"version":3,"sources":["uni-app:///main.js","webpack:///D:/AK-PMS/pages-sub/requisition/add.vue?4eb9","webpack:///D:/AK-PMS/pages-sub/requisition/add.vue?162e","webpack:///D:/AK-PMS/pages-sub/requisition/add.vue?c51b","webpack:///D:/AK-PMS/pages-sub/requisition/add.vue?c72b","uni-app:///pages-sub/requisition/add.vue","webpack:///D:/AK-PMS/pages-sub/requisition/add.vue?5dd8","webpack:///D:/AK-PMS/pages-sub/requisition/add.vue?880e"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","Signature","data","recordNo","currentTime","requisitioner","purpose","departmentIndex","departments","label","value","currentDepartment","drugList","requisitionerSign","onLoad","uni","onUnload","methods","initPage","onDepartmentChange","goSelectDrug","url","onDrugSelect","addDrug","title","icon","drugId","drugName","spec","unit","manufacturer","isHighValue","isEmergency","quantity","deleteDrug","content","success","validateForm","saveDraft","action","location","department","status","createTime","result","console","submitReview","setTimeout"],"mappings":"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","file":"pages-sub/requisition/add.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages-sub/requisition/add.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./add.vue?vue&type=template&id=7dac4290&scoped=true&\"\nvar renderjs\nimport script from \"./add.vue?vue&type=script&lang=js&\"\nexport * from \"./add.vue?vue&type=script&lang=js&\"\nimport style0 from \"./add.vue?vue&type=style&index=0&id=7dac4290&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7dac4290\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages-sub/requisition/add.vue\"\nexport default component.exports","export * from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=template&id=7dac4290&scoped=true&\"","var components\ntry {\n  components = {\n    signature: function () {\n      return import(\n        /* webpackChunkName: \"components/signature/index\" */ \"@/components/signature/index.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. ÊéíÊü•ÁªÑ‰ª∂ÂêçÁß∞ÊãºÂÜôÊòØÂê¶Ê≠£Á°Æ\")\n    console.error(\n      \"2. ÊéíÊü•ÁªÑ‰ª∂ÊòØÂê¶Á¨¶Âêà easycom ËßÑËåÉÔºåÊñáÊ°£Ôºöhttps://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. Ëã•ÁªÑ‰ª∂‰∏çÁ¨¶Âêà easycom ËßÑËåÉÔºåÈúÄÊâãÂä®ÂºïÂÖ•ÔºåÂπ∂Âú® components ‰∏≠Ê≥®ÂÜåËØ•ÁªÑ‰ª∂\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.purpose.length\n  var g1 = _vm.drugList.length\n  var g2 = _vm.drugList.length\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"container\">\n\t\t<!-- Ë°®Â§¥ -->\n\t\t<view class=\"page-header\">\n\t\t\t<view class=\"page-title\">Áà±Â∫∑ÂåªÂä°ÂÆ§ÁÆ°ÁêÜÁ≥ªÁªü</view>\n\t\t\t<view class=\"page-subtitle\">Âåó‰∫¨Ê¨¢‰πêË∞∑ÂåªÂä°ÂÆ§ ¬∑ ËçØÊùêËØ∑È¢ÜÂçï</view>\n\t\t</view>\n\t\t\n\t\t<!-- Âü∫Êú¨‰ø°ÊÅØ -->\n\t\t<view class=\"form-section\">\n\t\t\t<view class=\"section-title\">Âü∫Êú¨‰ø°ÊÅØ</view>\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">ËØ∑È¢ÜÂçïÂè∑</text>\n\t\t\t\t<text class=\"form-value\">{{ recordNo || 'Ëá™Âä®ÁîüÊàê' }}</text>\n\t\t\t</view>\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">ËØ∑È¢ÜÊó∂Èó¥</text>\n\t\t\t\t<text class=\"form-value\">{{ currentTime }}</text>\n\t\t\t</view>\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">ËØ∑È¢Ü‰∫∫</text>\n\t\t\t\t<text class=\"form-value\">{{ requisitioner }}</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- ËØ∑È¢ÜÈÉ®Èó®/Âõ≠Âå∫ -->\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">ËØ∑È¢ÜÈÉ®Èó® *</text>\n\t\t\t\t<picker \n\t\t\t\t\t:range=\"departments\" \n\t\t\t\t\trange-key=\"label\"\n\t\t\t\t\t:value=\"departmentIndex\"\n\t\t\t\t\t@change=\"onDepartmentChange\"\n\t\t\t\t>\n\t\t\t\t\t<view class=\"picker-input\">\n\t\t\t\t\t\t{{ currentDepartment.label }}\n\t\t\t\t\t\t<text class=\"picker-arrow\">‚Ä∫</text>\n\t\t\t\t\t</view>\n\t\t\t\t</picker>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- Áî®ÈÄîËØ¥Êòé -->\n\t\t\t<view class=\"form-item column\">\n\t\t\t\t<text class=\"form-label\">Áî®ÈÄîËØ¥Êòé *</text>\n\t\t\t\t<textarea \n\t\t\t\t\tclass=\"form-textarea\" \n\t\t\t\t\tv-model=\"purpose\" \n\t\t\t\t\tplaceholder=\"ËØ∑ËæìÂÖ•ËçØÊùêÁî®ÈÄîËØ¥ÊòéÔºàÂøÖÂ°´Ôºâ\"\n\t\t\t\t\tmaxlength=\"200\"\n\t\t\t\t></textarea>\n\t\t\t\t<text class=\"char-count\">{{ purpose.length }}/200</text>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- ËçØÊùêÊòéÁªÜ -->\n\t\t<view class=\"form-section\">\n\t\t\t<view class=\"section-title\">\n\t\t\t\tËçØÊùêÊòéÁªÜ\n\t\t\t\t<text class=\"section-count\">({{ drugList.length }}Áßç)</text>\n\t\t\t</view>\n\t\t\t\n\t\t<!-- Ê∑ªÂä†ËçØÊùêÊåâÈíÆ -->\n\t\t\t<view class=\"action-buttons\">\n\t\t\t<u-button\n\t\t\t\ttext=\"üìã ÈÄâÊã©ËçØÊùê\"\n\t\t\t\tsize=\"medium\"\n\t\t\t\ttype=\"primary\"\n\t\t\t\t@click=\"goSelectDrug\"\n\t\t\t></u-button>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- ËçØÊùêÂàóË°® -->\n\t\t\t<view class=\"drug-list\">\n\t\t\t\t<view \n\t\t\t\t\tv-for=\"(item, index) in drugList\" \n\t\t\t\t\t:key=\"index\" \n\t\t\t\t\tclass=\"drug-item\"\n\t\t\t\t>\n\t\t\t\t\t<!-- È´òÂÄº/ÊÄ•ÊïëËçØÊùêÊ†áËÆ∞ -->\n\t\t\t\t\t<view class=\"drug-badges\">\n\t\t\t\t\t\t<view v-if=\"item.isHighValue\" class=\"badge high-value\">È´òÂÄº</view>\n\t\t\t\t\t\t<view v-if=\"item.isEmergency\" class=\"badge emergency\">ÊÄ•Êïë</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<view class=\"drug-header\">\n\t\t\t\t\t\t<view class=\"drug-name\">{{ item.drugName }}</view>\n\t\t\t\t\t\t<view class=\"drug-delete\" @click=\"deleteDrug(index)\">Âà†Èô§</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<view class=\"drug-info\">\n\t\t\t\t\t\t<view class=\"info-row\">\n\t\t\t\t\t\t\t<text class=\"info-label\">ËßÑÊ†ºÔºö</text>\n\t\t\t\t\t\t\t<text>{{ item.spec }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"info-row\">\n\t\t\t\t\t\t\t<text class=\"info-label\">Âçï‰ΩçÔºö</text>\n\t\t\t\t\t\t\t<text>{{ item.unit }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"info-row\">\n\t\t\t\t\t\t\t<text class=\"info-label\">ÂéÇÂÆ∂Ôºö</text>\n\t\t\t\t\t\t\t<text>{{ item.manufacturer || 'Êú™Áü•' }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<view class=\"drug-input-section\">\n\t\t\t\t\t\t<!-- ËØ∑È¢ÜÊï∞Èáè -->\n\t\t\t\t\t\t<view class=\"input-row\">\n\t\t\t\t\t\t\t<text class=\"input-label\">ËØ∑È¢ÜÊï∞Èáè *</text>\n\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\tclass=\"input-field\" \n\t\t\t\t\t\t\t\tv-model.number=\"item.quantity\" \n\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\tplaceholder=\"ËØ∑ËæìÂÖ•Êï∞Èáè\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<text class=\"input-unit\">{{ item.unit }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- Á©∫Áä∂ÊÄÅ -->\n\t\t\t\t<view v-if=\"drugList.length === 0\" class=\"empty-hint\">\n\t\t\t\t<text>üíä ÊöÇÊó†ËçØÊùêÔºåËØ∑ÁÇπÂáª‰∏äÊñπÊåâÈíÆÊ∑ªÂä†</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- Á≠æÂêçÂå∫Âüü -->\n\t\t<view class=\"form-section\">\n\t\t\t<view class=\"section-title\">ËØ∑È¢Ü‰∫∫Á≠æÂêç *</view>\n\t\t\t<signature \n\t\t\t\tv-model=\"requisitionerSign\"\n\t\t\t\ttitle=\"ËØ∑È¢Ü‰∫∫Á≠æÂêç\"\n\t\t\t></signature>\n\t\t</view>\n\t\t\n\t\t<!-- Â∫ïÈÉ®ÊåâÈíÆ -->\n\t\t<view class=\"bottom-actions\">\n\t\t\t<u-button \n\t\t\t\ttype=\"info\" \n\t\t\t\ttext=\"‰øùÂ≠òËçâÁ®ø\"\n\t\t\t\tplain\n\t\t\t\t@click=\"saveDraft\"\n\t\t\t></u-button>\n\t\t\t<u-button \n\t\t\t\ttype=\"primary\" \n\t\t\t\ttext=\"Êèê‰∫§ÂÆ°Êâπ\"\n\t\t\t\t@click=\"submitReview\"\n\t\t\t></u-button>\n\t\t</view>\n\t\t\n\t</view>\n</template>\n\n<script>\nimport Signature from '@/components/signature/index.vue'\nimport Common from '@/utils/common.js'\n\nexport default {\n\tcomponents: {\n\t\tSignature\n\t},\n\t\n\tdata() {\n\t\treturn {\n\t\t\trecordNo: '',\n\t\t\tcurrentTime: '',\n\t\t\trequisitioner: '',\n\t\t\tpurpose: '',\n\t\t\tdepartmentIndex: 0,\n\t\t\tdepartments: [\n\t\t\t\t{ label: 'ÈôÜÂõ≠', value: 'land_park' },\n\t\t\t\t{ label: 'Ê∞¥Âõ≠', value: 'water_park' },\n\t\t\t\t{ label: 'ÂäûÂÖ¨Âå∫', value: 'office' },\n\t\t\t\t{ label: 'ÂÖ∂‰ªñ', value: 'other' }\n\t\t\t],\n\t\t\tcurrentDepartment: { label: 'ÈôÜÂõ≠', value: 'land_park' },\n\t\t\tdrugList: [],\n\t\trequisitionerSign: ''\n\t\t}\n\t},\n\t\n\tonLoad() {\n\t\tthis.initPage()\n\t\t// ÁõëÂê¨ËçØÊùêÈÄâÊã©‰∫ã‰ª∂\n\t\tuni.$on('drugSelected', this.onDrugSelect)\n\t},\n\t\n\tonUnload() {\n\t\t// ÁßªÈô§‰∫ã‰ª∂ÁõëÂê¨\n\t\tuni.$off('drugSelected', this.onDrugSelect)\n\t},\n\t\n\tmethods: {\n\t\tinitPage() {\n\t\t\t// ÁîüÊàêËØ∑È¢ÜÂçïÂè∑\n\t\t\tthis.recordNo = Common.generateRecordNo('QL')\n\t\t\t\n\t\t\t// ÂΩìÂâçÊó∂Èó¥\n\t\t\tthis.currentTime = Common.formatDate(new Date(), 'YYYY-MM-DD HH:mm')\n\t\t\t\n\t\t\t// Ëé∑ÂèñÂΩìÂâçÁî®Êà∑\n\t\t\tconst userInfo = uni.getStorageSync('userInfo')\n\t\t\tthis.requisitioner = userInfo?.name || 'Êú™ÁôªÂΩï'\n\t\t},\n\t\t\n\t\tonDepartmentChange(e) {\n\t\t\tthis.departmentIndex = e.detail.value\n\t\t\tthis.currentDepartment = this.departments[this.departmentIndex]\n\t\t},\n\t\t\n\t\tgoSelectDrug() {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: '/pages-sub/drug/list?mode=select'\n\t\t\t})\n\t\t},\n\t\t\n\t\tonDrugSelect(drug) {\n\t\t\tthis.addDrug(drug)\n\t\t},\n\t\t\n\t\t// Ê∑ªÂä†ËçØÊùêÂà∞ÂàóË°®\n\t\taddDrug(drugInfo) {\n\t\t\t// Ê£ÄÊü•ÊòØÂê¶Â∑≤Ê∑ªÂä†\n\t\t\tconst exists = this.drugList.some(item => item.drugId === drugInfo._id)\n\t\t\tif (exists) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: 'ËØ•ËçØÊùêÂ∑≤Ê∑ªÂä†',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t\treturn\n\t\t\t}\n\t\t\t\n\t\t\t// Ê∑ªÂä†Âà∞ÂàóË°®\n\t\t\tthis.drugList.push({\n\t\t\t\tdrugId: drugInfo._id,\n\t\t\t\tdrugName: drugInfo.name || drugInfo.drugName,\n\t\t\t\tspec: drugInfo.spec || drugInfo.specification,\n\t\t\t\tunit: drugInfo.unit || drugInfo.packUnit,\n\t\t\t\tmanufacturer: drugInfo.manufacturer,\n\t\t\t\tisHighValue: drugInfo.isHighValue || false,\n\t\t\t\tisEmergency: drugInfo.isEmergency || false,\n\t\t\t\tquantity: ''\n\t\t\t})\n\t\t\t\n\t\t\tuni.showToast({\n\t\t\t\ttitle: 'Ê∑ªÂä†ÊàêÂäü',\n\t\t\t\ticon: 'success'\n\t\t\t})\n\t\t},\n\t\t\n\t\tdeleteDrug(index) {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: 'Á°ÆËÆ§Âà†Èô§',\n\t\t\t\tcontent: `Á°ÆÂÆöË¶ÅÂà†Èô§ ${this.drugList[index].drugName} ÂêóÔºü`,\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\tthis.drugList.splice(index, 1)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t\n\t\tvalidateForm() {\n\t\t\t// È™åËØÅÁî®ÈÄîËØ¥Êòé\n\t\t\tif (!this.purpose || this.purpose.trim() === '') {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: 'ËØ∑Â°´ÂÜôÁî®ÈÄîËØ¥Êòé',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t\treturn false\n\t\t\t}\n\t\t\t\n\t\t\t// È™åËØÅËçØÊùêÂàóË°®\n\t\t\tif (this.drugList.length === 0) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: 'ËØ∑Ê∑ªÂä†ËçØÊùê',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t\treturn false\n\t\t\t}\n\t\t\t\n\t\t\t// È™åËØÅÊØè‰∏™ËçØÊùêÁöÑÊï∞Èáè\n\t\t\tfor (let i = 0; i < this.drugList.length; i++) {\n\t\t\t\tconst item = this.drugList[i]\n\t\t\t\tif (!item.quantity || item.quantity <= 0) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: `${item.drugName} Êï∞ÈáèÊú™Â°´ÂÜôÊàñÊó†Êïà`,\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// È™åËØÅÁ≠æÂêç\n\t\t\tif (!this.requisitionerSign) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: 'ËØ∑ÂÖàÁ≠æÂêç',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t\treturn false\n\t\t\t}\n\t\t\t\n\t\t\treturn true\n\t\t},\n\t\t\n\t\tasync saveDraft() {\n\t\t\tif (this.drugList.length === 0) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: 'ËØ∑ÂÖàÊ∑ªÂä†ËçØÊùê',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t\treturn\n\t\t\t}\n\t\t\t\n\t\t\tuni.showLoading({\n\t\t\t\ttitle: '‰øùÂ≠ò‰∏≠...'\n\t\t\t})\n\t\t\t\n\t\t\ttry {\n\t\t\t\tconst result = await this.$api.callFunction('requisitionRecords', {\n\t\t\t\t\taction: 'add',\n\t\t\t\t\trecordNo: this.recordNo,\n\t\t\t\t\tlocation: this.currentDepartment.value,\n\t\t\t\t\trequisitioner: this.requisitioner,\n\t\t\t\t\tdepartment: this.currentDepartment.label,\n\t\t\t\t\tpurpose: this.purpose,\n\t\t\t\t\tdrugList: this.drugList,\n\t\t\t\t\tstatus: 'draft',\n\t\t\t\t\tcreateTime: new Date()\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tuni.hideLoading()\n\t\t\t\t\n\t\t\t\tif (result.success) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'ËçâÁ®øÂ∑≤‰øùÂ≠ò',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(result.message || '‰øùÂ≠òÂ§±Ë¥•')\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('‰øùÂ≠òÂ§±Ë¥•:', err)\n\t\t\t\tuni.hideLoading()\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: err.message || '‰øùÂ≠òÂ§±Ë¥•',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\t\n\t\tasync submitReview() {\n\t\t\t// È™åËØÅË°®Âçï\n\t\t\tif (!this.validateForm()) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\t\n\t\t\tuni.showLoading({\n\t\t\t\ttitle: 'Êèê‰∫§‰∏≠...'\n\t\t\t})\n\t\t\t\n\t\t\ttry {\n\t\t\t\tconst result = await this.$api.callFunction('requisitionRecords', {\n\t\t\t\t\taction: 'add',\n\t\t\t\t\trecordNo: this.recordNo,\n\t\t\t\t\tlocation: this.currentDepartment.value,\n\t\t\t\t\trequisitioner: this.requisitioner,\n\t\t\t\t\tdepartment: this.currentDepartment.label,\n\t\t\t\t\tpurpose: this.purpose,\n\t\t\t\t\tdrugList: this.drugList,\n\t\t\t\t\trequisitionerSign: this.requisitionerSign,\n\t\t\t\t\tstatus: 'pending_review',  // ÂæÖÂÆ°ÊâπÁä∂ÊÄÅ\n\t\t\t\t\tcreateTime: new Date()\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tuni.hideLoading()\n\t\t\t\t\n\t\t\t\tif (result.success) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'Êèê‰∫§ÊàêÂäü',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t})\n\t\t\t\t\t\n\t\t\t\t\t// ËøîÂõûÂàóË°®È°µ\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tuni.navigateBack()\n\t\t\t\t\t}, 1500)\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(result.message || 'Êèê‰∫§Â§±Ë¥•')\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('Êèê‰∫§Â§±Ë¥•:', err)\n\t\t\t\tuni.hideLoading()\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: err.message || 'Êèê‰∫§Â§±Ë¥•',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n\tpadding: 20rpx;\n\tpadding-bottom: 150rpx;\n\tbackground-color: #F8F8F8;\n\tmin-height: 100vh;\n}\n\n.page-header {\n\tbackground: linear-gradient(135deg, #9C27B0 0%, #BA68C8 100%);\n\tpadding: 40rpx;\n\tborder-radius: 20rpx;\n\ttext-align: center;\n\tmargin-bottom: 20rpx;\n\tbox-shadow: 0 4rpx 20rpx rgba(156, 39, 176, 0.3);\n}\n\n.page-title {\n\tfont-size: 36rpx;\n\tfont-weight: bold;\n\tcolor: #FFFFFF;\n\tmargin-bottom: 10rpx;\n}\n\n.page-subtitle {\n\tfont-size: 28rpx;\n\tcolor: rgba(255, 255, 255, 0.9);\n}\n\n.form-section {\n\tbackground-color: #FFFFFF;\n\tpadding: 30rpx;\n\tborder-radius: 20rpx;\n\tmargin-bottom: 20rpx;\n\tbox-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n}\n\n.section-title {\n\tfont-size: 32rpx;\n\tfont-weight: bold;\n\tcolor: #333333;\n\tmargin-bottom: 25rpx;\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.section-count {\n\tfont-size: 26rpx;\n\tcolor: #999999;\n\tmargin-left: 10rpx;\n\tfont-weight: normal;\n}\n\n.form-item {\n\tdisplay: flex;\n\talign-items: center;\n\tpadding: 20rpx 0;\n\tborder-bottom: 1px solid #F8F8F8;\n}\n\n.form-item.column {\n\tflex-direction: column;\n\talign-items: flex-start;\n}\n\n.form-item:last-child {\n\tborder-bottom: none;\n}\n\n.form-label {\n\tfont-size: 28rpx;\n\tcolor: #666666;\n\tmin-width: 180rpx;\n\tmargin-bottom: 10rpx;\n}\n\n.form-value {\n\tfont-size: 28rpx;\n\tcolor: #333333;\n\tflex: 1;\n}\n\n.form-input {\n\tflex: 1;\n\theight: 60rpx;\n\tpadding: 0 20rpx;\n\tbackground-color: #F5F5F5;\n\tborder-radius: 10rpx;\n\tfont-size: 28rpx;\n}\n\n.form-textarea {\n\twidth: 100%;\n\tmin-height: 150rpx;\n\tpadding: 20rpx;\n\tbackground-color: #F5F5F5;\n\tborder-radius: 10rpx;\n\tfont-size: 28rpx;\n\tline-height: 40rpx;\n}\n\n.char-count {\n\talign-self: flex-end;\n\tmargin-top: 10rpx;\n\tfont-size: 24rpx;\n\tcolor: #999999;\n}\n\n.picker-input {\n\tflex: 1;\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tfont-size: 28rpx;\n\tcolor: #333333;\n}\n\n.picker-arrow {\n\tfont-size: 36rpx;\n\tcolor: #999999;\n}\n\n.action-buttons {\n\tdisplay: flex;\n\tgap: 20rpx;\n\tmargin-bottom: 25rpx;\n}\n\n.drug-list {\n\tmargin-top: 20rpx;\n}\n\n.drug-item {\n\tposition: relative;\n\tbackground-color: #F8F9FA;\n\tborder: 2rpx solid #E8E8E8;\n\tborder-radius: 15rpx;\n\tpadding: 25rpx;\n\tmargin-bottom: 20rpx;\n}\n\n.drug-badges {\n\tposition: absolute;\n\ttop: -10rpx;\n\tright: 20rpx;\n\tdisplay: flex;\n\tgap: 10rpx;\n\tz-index: 1;\n}\n\n.badge {\n\tpadding: 4rpx 12rpx;\n\tborder-radius: 8rpx;\n\tfont-size: 22rpx;\n\tcolor: #FFFFFF;\n}\n\n.badge.high-value {\n\tbackground-color: #FF9800;\n}\n\n.badge.emergency {\n\tbackground-color: #F44336;\n}\n\n.drug-header {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tmargin-bottom: 15rpx;\n}\n\n.drug-name {\n\tfont-size: 30rpx;\n\tfont-weight: bold;\n\tcolor: #333333;\n\tflex: 1;\n}\n\n.drug-delete {\n\tfont-size: 26rpx;\n\tcolor: #FF5722;\n\tpadding: 5rpx 15rpx;\n}\n\n.drug-info {\n\tmargin-bottom: 20rpx;\n\tpadding-bottom: 20rpx;\n\tborder-bottom: 1px dashed #E0E0E0;\n}\n\n.info-row {\n\tdisplay: flex;\n\tfont-size: 26rpx;\n\tline-height: 40rpx;\n\tcolor: #666666;\n}\n\n.info-label {\n\tcolor: #999999;\n\tmin-width: 100rpx;\n}\n\n.drug-input-section {\n\tmargin-top: 15rpx;\n}\n\n.input-row {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin-bottom: 15rpx;\n}\n\n.input-label {\n\tfont-size: 26rpx;\n\tcolor: #666666;\n\tmin-width: 160rpx;\n}\n\n.input-field {\n\tflex: 1;\n\theight: 60rpx;\n\tpadding: 0 20rpx;\n\tbackground-color: #FFFFFF;\n\tborder: 1px solid #E0E0E0;\n\tborder-radius: 10rpx;\n\tfont-size: 28rpx;\n}\n\n.input-unit {\n\tfont-size: 26rpx;\n\tcolor: #999999;\n\tmargin-left: 15rpx;\n\tmin-width: 60rpx;\n}\n\n.empty-hint {\n\ttext-align: center;\n\tpadding: 60rpx 0;\n\tcolor: #999999;\n\tfont-size: 28rpx;\n}\n\n.bottom-actions {\n\tposition: fixed;\n\tbottom: 0;\n\tleft: 0;\n\tright: 0;\n\tdisplay: flex;\n\tgap: 20rpx;\n\tpadding: 20rpx 30rpx;\n\tbackground-color: #FFFFFF;\n\tbox-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.05);\n\tz-index: 100;\n}\n\n.bottom-actions button {\n\tflex: 1;\n}\n</style>\n","import mod from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=style&index=0&id=7dac4290&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add.vue?vue&type=style&index=0&id=7dac4290&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1766563616553\n      var cssReload = require(\"D:/HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}