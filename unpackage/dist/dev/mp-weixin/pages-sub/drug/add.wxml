<view class="page-container data-v-cfbffdd0"><view class="page-header data-v-cfbffdd0"><view class="clinic-name data-v-cfbffdd0">🏥 爱康医务室管理系统</view><view class="doc-type data-v-cfbffdd0">{{"北京欢乐谷医务室 · 药材档案"+(isEdit?'编辑':'添加')}}</view></view><view class="scan-section data-v-cfbffdd0"><view class="scan-title data-v-cfbffdd0">📷 扫码录入</view><view class="scan-desc data-v-cfbffdd0">扫描药材条形码快速录入药材信息</view><scanner vue-id="6be0a2ee-1" button-text="📷 扫码添加药材" button-type="primary" data-event-opts="{{[['^success',[['onScanSuccess']]],['^notFound',[['onBarcodeNotFound']]]]}}" bind:success="__e" bind:notFound="__e" class="data-v-cfbffdd0" bind:__l="__l"></scanner></view><view class="form-section data-v-cfbffdd0"><view class="section-title data-v-cfbffdd0">📋 基本信息</view><view class="form-item data-v-cfbffdd0"><view class="label required data-v-cfbffdd0">药材名称</view><input class="input data-v-cfbffdd0" placeholder="请输入药材名称" placeholder-class="placeholder" data-event-opts="{{[['input',[['__set_model',['$0','drugName','$event',[]],['form']]]]]}}" value="{{form.drugName}}" bindinput="__e"/></view><view class="form-item data-v-cfbffdd0"><view class="label data-v-cfbffdd0">药材代码</view><input class="input data-v-cfbffdd0" placeholder="如：AMOX500-TAB（可选，系统可自动生成）" placeholder-class="placeholder" data-event-opts="{{[['input',[['__set_model',['$0','drugCode','$event',[]],['form']]]]]}}" value="{{form.drugCode}}" bindinput="__e"/></view><view class="form-item data-v-cfbffdd0"><view class="label data-v-cfbffdd0">条形码</view><input class="input data-v-cfbffdd0" placeholder="请输入或扫描条形码" placeholder-class="placeholder" data-event-opts="{{[['input',[['__set_model',['$0','barcode','$event',[]],['form']]]]]}}" value="{{form.barcode}}" bindinput="__e"/></view><view class="form-item data-v-cfbffdd0"><view class="label required data-v-cfbffdd0">规格</view><input class="input data-v-cfbffdd0" placeholder="如：0.25g*24粒" placeholder-class="placeholder" data-event-opts="{{[['input',[['__set_model',['$0','specification','$event',[]],['form']]]]]}}" value="{{form.specification}}" bindinput="__e"/></view><view class="form-item data-v-cfbffdd0"><view class="label required data-v-cfbffdd0">生产厂家</view><input class="input data-v-cfbffdd0" placeholder="请输入生产厂家" placeholder-class="placeholder" data-event-opts="{{[['input',[['__set_model',['$0','manufacturer','$event',[]],['form']]]]]}}" value="{{form.manufacturer}}" bindinput="__e"/></view><view class="form-item data-v-cfbffdd0"><view class="label data-v-cfbffdd0">药材分类</view><picker mode="selector" range="{{categoryOptions}}" value="{{categoryIndex}}" data-event-opts="{{[['change',[['onCategoryChange',['$event']]]]]}}" bindchange="__e" class="data-v-cfbffdd0"><view class="picker-display data-v-cfbffdd0">{{''+(form.category||'请选择药材分类')+''}}</view></picker></view></view><view class="form-section data-v-cfbffdd0"><view class="section-title data-v-cfbffdd0">📦 单位转换</view><view class="section-desc data-v-cfbffdd0">设置包装单位和最小单位的转换关系</view><view class="form-item data-v-cfbffdd0"><view class="label required data-v-cfbffdd0">包装单位</view><view class="input-row data-v-cfbffdd0"><input class="input flex-input data-v-cfbffdd0" placeholder="如：盒、瓶" placeholder-class="placeholder" data-event-opts="{{[['input',[['__set_model',['$0','packUnit','$event',[]],['form']]]]]}}" value="{{form.packUnit}}" bindinput="__e"/><text class="hint data-v-cfbffdd0">（主库存单位）</text></view></view><view class="form-item data-v-cfbffdd0"><view class="label required data-v-cfbffdd0">最小单位</view><view class="input-row data-v-cfbffdd0"><input class="input flex-input data-v-cfbffdd0" placeholder="如：片、粒、ml" placeholder-class="placeholder" data-event-opts="{{[['input',[['__set_model',['$0','minUnit','$event',[]],['form']]]]]}}" value="{{form.minUnit}}" bindinput="__e"/><text class="hint data-v-cfbffdd0">（园区使用单位）</text></view></view><view class="form-item data-v-cfbffdd0"><view class="label required data-v-cfbffdd0">转换率</view><view class="conversion-row data-v-cfbffdd0"><text class="conversion-text data-v-cfbffdd0">{{"1 "+(form.packUnit||'盒')+' ='}}</text><input class="input conversion-input data-v-cfbffdd0" type="number" placeholder="24" placeholder-class="placeholder" data-event-opts="{{[['input',[['__set_model',['$0','conversionRate','$event',['number']],['form']]]],['blur',[['$forceUpdate']]]]}}" value="{{form.conversionRate}}" bindinput="__e" bindblur="__e"/><text class="conversion-text data-v-cfbffdd0">{{form.minUnit||'片'}}</text></view></view><block wx:if="{{form.conversionRate}}"><view class="conversion-example data-v-cfbffdd0"><text class="example-icon data-v-cfbffdd0">💡</text><text class="example-text data-v-cfbffdd0">{{'示例：入库 1'+(form.packUnit||'盒')+"，出库到园区后可用 "+form.conversionRate+(form.minUnit||'片')+''}}</text></view></block></view><view class="form-section data-v-cfbffdd0"><view class="section-title data-v-cfbffdd0">📊 库存管理</view><view class="form-item data-v-cfbffdd0"><view class="label data-v-cfbffdd0">安全库存</view><view class="input-row data-v-cfbffdd0"><input class="input flex-input data-v-cfbffdd0" type="number" placeholder="请输入安全库存数量" placeholder-class="placeholder" data-event-opts="{{[['input',[['__set_model',['$0','safeStock','$event',['number']],['form']]]],['blur',[['$forceUpdate']]]]}}" value="{{form.safeStock}}" bindinput="__e" bindblur="__e"/><text class="hint data-v-cfbffdd0">{{form.packUnit||'单位'}}</text></view></view><view class="form-item data-v-cfbffdd0"><view class="label data-v-cfbffdd0">最低库存</view><view class="input-row data-v-cfbffdd0"><input class="input flex-input data-v-cfbffdd0" type="number" placeholder="请输入最低库存数量" placeholder-class="placeholder" data-event-opts="{{[['input',[['__set_model',['$0','minStock','$event',['number']],['form']]]],['blur',[['$forceUpdate']]]]}}" value="{{form.minStock}}" bindinput="__e" bindblur="__e"/><text class="hint data-v-cfbffdd0">{{form.packUnit||'单位'}}</text></view></view></view><view class="form-section data-v-cfbffdd0"><view class="section-title data-v-cfbffdd0">🏷️ 特殊标记</view><view class="switch-item data-v-cfbffdd0"><view class="switch-label data-v-cfbffdd0"><text class="label-text data-v-cfbffdd0">高值药材</text><text class="label-desc data-v-cfbffdd0">标记为高值药材，需特殊管理</text></view><switch checked="{{form.isHighValue}}" color="#FF9800" data-event-opts="{{[['change',[['e0',['$event']]]]]}}" bindchange="__e" class="data-v-cfbffdd0"></switch></view><view class="switch-item data-v-cfbffdd0"><view class="switch-label data-v-cfbffdd0"><text class="label-text data-v-cfbffdd0">急救药材</text><text class="label-desc data-v-cfbffdd0">标记为急救药材，优先管理</text></view><switch checked="{{form.isEmergency}}" color="#F44336" data-event-opts="{{[['change',[['e1',['$event']]]]]}}" bindchange="__e" class="data-v-cfbffdd0"></switch></view></view><view class="form-section data-v-cfbffdd0"><view class="section-title data-v-cfbffdd0">📝 备注信息</view><view class="form-item data-v-cfbffdd0"><textarea class="textarea data-v-cfbffdd0" placeholder="请输入备注信息（选填）" placeholder-class="placeholder" maxlength="200" data-event-opts="{{[['input',[['__set_model',['$0','remark','$event',[]],['form']]]]]}}" value="{{form.remark}}" bindinput="__e"></textarea><view class="char-count data-v-cfbffdd0">{{$root.g0+"/200"}}</view></view></view><view class="bottom-actions data-v-cfbffdd0"><button data-event-opts="{{[['tap',[['handleCancel',['$event']]]]]}}" class="btn-cancel data-v-cfbffdd0" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['handleSubmit',['$event']]]]]}}" class="btn-submit data-v-cfbffdd0" bindtap="__e">{{isEdit?'保存修改':'💾 保存药材'}}</button></view></view>