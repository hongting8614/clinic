<view class="page-container data-v-56ab9baa"><view class="page-header data-v-56ab9baa"><view class="header-title data-v-56ab9baa">è¯å“æ¡£æ¡ˆè¯¦æƒ…</view><view class="header-actions data-v-56ab9baa"><block wx:if="{{!isEditMode}}"><view data-event-opts="{{[['tap',[['toggleEditMode',['$event']]]]]}}" class="action-btn edit-btn data-v-56ab9baa" bindtap="__e"><text class="btn-icon data-v-56ab9baa">âœï¸</text><text class="btn-text data-v-56ab9baa">ç¼–è¾‘</text></view></block><block wx:if="{{isEditMode}}"><view data-event-opts="{{[['tap',[['saveDrug',['$event']]]]]}}" class="action-btn save-btn data-v-56ab9baa" bindtap="__e"><text class="btn-icon data-v-56ab9baa">ğŸ’¾</text><text class="btn-text data-v-56ab9baa">ä¿å­˜</text></view></block><block wx:if="{{isEditMode}}"><view data-event-opts="{{[['tap',[['cancelEdit',['$event']]]]]}}" class="action-btn cancel-btn data-v-56ab9baa" bindtap="__e"><text class="btn-text data-v-56ab9baa">å–æ¶ˆ</text></view></block></view></view><view class="completeness-card data-v-56ab9baa"><view class="completeness-header data-v-56ab9baa"><text class="card-title data-v-56ab9baa">æ¡£æ¡ˆå®Œæ•´åº¦</text><view class="{{['completeness-badge','data-v-56ab9baa',(completeness.percentage===100)?'complete':'',(completeness.percentage>=75&&completeness.percentage<100)?'good':'',(completeness.percentage>=50&&completeness.percentage<75)?'medium':'',(completeness.percentage<50)?'low':'']}}"><text class="data-v-56ab9baa">{{completeness.percentage+"%"}}</text></view></view><view class="completeness-progress data-v-56ab9baa"><view class="progress-bar data-v-56ab9baa"><view class="{{['progress-fill','data-v-56ab9baa',(completeness.percentage===100)?'complete':'',(completeness.percentage>=75&&completeness.percentage<100)?'good':'',(completeness.percentage>=50&&completeness.percentage<75)?'medium':'',(completeness.percentage<50)?'low':'']}}" style="{{'width:'+(completeness.percentage+'%')+';'}}"></view></view><text class="progress-text data-v-56ab9baa">{{completeness.filledCount+"/"+completeness.totalCount+" é¡¹å·²å¡«å†™"}}</text></view><block wx:if="{{$root.g0>0}}"><view class="missing-fields data-v-56ab9baa"><text class="missing-label data-v-56ab9baa">ç¼ºå°‘ï¼š</text><text class="missing-text data-v-56ab9baa">{{$root.g1}}</text></view></block></view><view class="info-section data-v-56ab9baa"><view class="section-title data-v-56ab9baa">ğŸ“‹ åŸºæœ¬ä¿¡æ¯</view><view class="info-item data-v-56ab9baa"><text class="item-label data-v-56ab9baa">è¯å“åç§° <text class="required data-v-56ab9baa">*</text></text><block wx:if="{{isEditMode}}"><input class="item-input data-v-56ab9baa" placeholder="è¯·è¾“å…¥è¯å“åç§°" data-event-opts="{{[['input',[['__set_model',['$0','name','$event',[]],['drugData']]]]]}}" value="{{drugData.name}}" bindinput="__e"/></block><block wx:else><text class="item-value data-v-56ab9baa">{{drugData.name||'-'}}</text></block></view><view class="info-item data-v-56ab9baa"><text class="item-label data-v-56ab9baa">è§„æ ¼ <text class="required data-v-56ab9baa">*</text></text><block wx:if="{{isEditMode}}"><input class="item-input data-v-56ab9baa" placeholder="å¦‚ï¼š0.25gÃ—24ç²’/ç›’" data-event-opts="{{[['input',[['__set_model',['$0','specification','$event',[]],['drugData']]]]]}}" value="{{drugData.specification}}" bindinput="__e"/></block><block wx:else><text class="item-value data-v-56ab9baa">{{drugData.specification||'-'}}</text></block></view><view class="info-item data-v-56ab9baa"><text class="item-label data-v-56ab9baa">å•ä½ <text class="required data-v-56ab9baa">*</text></text><block wx:if="{{isEditMode}}"><picker mode="selector" range="{{unitOptions}}" value="{{unitIndex}}" data-event-opts="{{[['change',[['onUnitChange',['$event']]]]]}}" bindchange="__e" class="data-v-56ab9baa"><view class="picker-input data-v-56ab9baa"><text class="data-v-56ab9baa">{{drugData.unit||'è¯·é€‰æ‹©å•ä½'}}</text><text class="picker-arrow data-v-56ab9baa">â–¼</text></view></picker></block><block wx:else><text class="item-value data-v-56ab9baa">{{drugData.unit||'-'}}</text></block></view><view class="info-item data-v-56ab9baa"><text class="item-label data-v-56ab9baa">ç”Ÿäº§å‚å®¶ <text class="required data-v-56ab9baa">*</text></text><block wx:if="{{isEditMode}}"><input class="item-input data-v-56ab9baa" placeholder="è¯·è¾“å…¥ç”Ÿäº§å‚å®¶" data-event-opts="{{[['input',[['__set_model',['$0','manufacturer','$event',[]],['drugData']]]]]}}" value="{{drugData.manufacturer}}" bindinput="__e"/></block><block wx:else><text class="item-value data-v-56ab9baa">{{drugData.manufacturer||'-'}}</text></block></view><view class="info-item data-v-56ab9baa"><text class="item-label data-v-56ab9baa">æ¡å½¢ç </text><block wx:if="{{isEditMode}}"><input class="item-input data-v-56ab9baa" placeholder="è¯·è¾“å…¥æ¡å½¢ç " data-event-opts="{{[['input',[['__set_model',['$0','barcode','$event',[]],['drugData']]]]]}}" value="{{drugData.barcode}}" bindinput="__e"/></block><block wx:else><text class="item-value data-v-56ab9baa">{{drugData.barcode||'-'}}</text></block></view><view class="info-item data-v-56ab9baa"><text class="item-label data-v-56ab9baa">æ‰¹å‡†æ–‡å·</text><block wx:if="{{isEditMode}}"><input class="item-input data-v-56ab9baa" placeholder="è¯·è¾“å…¥æ‰¹å‡†æ–‡å·" data-event-opts="{{[['input',[['__set_model',['$0','approvalNumber','$event',[]],['drugData']]]]]}}" value="{{drugData.approvalNumber}}" bindinput="__e"/></block><block wx:else><text class="item-value data-v-56ab9baa">{{drugData.approvalNumber||'-'}}</text></block></view><view class="info-item data-v-56ab9baa"><text class="item-label data-v-56ab9baa">åˆ†ç±»</text><block wx:if="{{isEditMode}}"><picker mode="selector" range="{{categoryOptions}}" value="{{categoryIndex}}" data-event-opts="{{[['change',[['onCategoryChange',['$event']]]]]}}" bindchange="__e" class="data-v-56ab9baa"><view class="picker-input data-v-56ab9baa"><text class="data-v-56ab9baa">{{drugData.category||'è¯·é€‰æ‹©åˆ†ç±»'}}</text><text class="picker-arrow data-v-56ab9baa">â–¼</text></view></picker></block><block wx:else><text class="item-value data-v-56ab9baa">{{drugData.category||'-'}}</text></block></view></view><view class="info-section data-v-56ab9baa"><view class="section-title data-v-56ab9baa">ğŸ“Š åº“å­˜ç®¡ç†</view><view class="info-item data-v-56ab9baa"><text class="item-label data-v-56ab9baa">å®‰å…¨åº“å­˜</text><block wx:if="{{isEditMode}}"><input class="item-input data-v-56ab9baa" type="number" placeholder="è¯·è¾“å…¥å®‰å…¨åº“å­˜" data-event-opts="{{[['input',[['__set_model',['$0','safeStock','$event',[]],['drugData']]]]]}}" value="{{drugData.safeStock}}" bindinput="__e"/></block><block wx:else><text class="item-value data-v-56ab9baa">{{drugData.safeStock||'-'}}</text></block></view><view class="info-item data-v-56ab9baa"><text class="item-label data-v-56ab9baa">æœ€ä½åº“å­˜</text><block wx:if="{{isEditMode}}"><input class="item-input data-v-56ab9baa" type="number" placeholder="è¯·è¾“å…¥æœ€ä½åº“å­˜" data-event-opts="{{[['input',[['__set_model',['$0','minStock','$event',[]],['drugData']]]]]}}" value="{{drugData.minStock}}" bindinput="__e"/></block><block wx:else><text class="item-value data-v-56ab9baa">{{drugData.minStock||'-'}}</text></block></view></view><view class="info-section data-v-56ab9baa"><view class="section-title data-v-56ab9baa">ğŸ·ï¸ ç‰¹æ®Šæ ‡è®°</view><view class="switch-item data-v-56ab9baa"><view class="switch-label data-v-56ab9baa"><text class="label-text data-v-56ab9baa">é«˜å€¼è¯å“</text><text class="label-desc data-v-56ab9baa">æ ‡è®°ä¸ºé«˜å€¼è¯å“ï¼Œéœ€ç‰¹æ®Šç®¡ç†</text></view><switch checked="{{drugData.isHighValue}}" disabled="{{!isEditMode}}" color="#FF9800" data-event-opts="{{[['change',[['e0',['$event']]]]]}}" bindchange="__e" class="data-v-56ab9baa"></switch></view><view class="switch-item data-v-56ab9baa"><view class="switch-label data-v-56ab9baa"><text class="label-text data-v-56ab9baa">æ€¥æ•‘è¯å“</text><text class="label-desc data-v-56ab9baa">æ ‡è®°ä¸ºæ€¥æ•‘è¯å“ï¼Œä¼˜å…ˆç®¡ç†</text></view><switch checked="{{drugData.isEmergency}}" disabled="{{!isEditMode}}" color="#F44336" data-event-opts="{{[['change',[['e1',['$event']]]]]}}" bindchange="__e" class="data-v-56ab9baa"></switch></view></view><view class="info-section data-v-56ab9baa"><view class="section-title data-v-56ab9baa">â„¹ï¸ å…¶ä»–ä¿¡æ¯</view><view class="info-item data-v-56ab9baa"><text class="item-label data-v-56ab9baa">åˆ›å»ºæ—¶é—´</text><text class="item-value data-v-56ab9baa">{{$root.m0}}</text></view><block wx:if="{{drugData.updateTime}}"><view class="info-item data-v-56ab9baa"><text class="item-label data-v-56ab9baa">æ›´æ–°æ—¶é—´</text><text class="item-value data-v-56ab9baa">{{$root.m1}}</text></view></block></view><block wx:if="{{!isEditMode}}"><view class="bottom-actions data-v-56ab9baa"><view data-event-opts="{{[['tap',[['deleteDrug',['$event']]]]]}}" class="action-btn-large delete-btn data-v-56ab9baa" bindtap="__e"><text class="data-v-56ab9baa">åˆ é™¤æ¡£æ¡ˆ</text></view><view data-event-opts="{{[['tap',[['toggleEditMode',['$event']]]]]}}" class="action-btn-large primary-btn data-v-56ab9baa" bindtap="__e"><text class="data-v-56ab9baa">ç¼–è¾‘æ¡£æ¡ˆ</text></view></view></block></view>