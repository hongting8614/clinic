<view class="page"><view class="medical-header"><view class="header-bg"></view><view class="header-content"><text class="clinic-name">çˆ±åº·åŒ»åŠ¡å®¤ç®¡ç†ç³»ç»Ÿ</text><text class="doc-type">åŒ—äº¬æ¬¢ä¹è°·åŒ»åŠ¡å®¤ Â· è¯æå…¥åº“å•</text><text class="doc-type-en">DRUG RECEIPT FORM</text></view></view><view class="status-flow"><view class="{{['flow-item',record.status!=='draft'?'completed':'current']}}"><view class="flow-dot"></view><text class="flow-text">åˆ›å»º</text></view><view class="{{['flow-line',record.status!=='draft'?'completed':'']}}"></view><view class="{{['flow-item',record.status==='completed'?'completed':record.status==='pending_review'?'current':'']}}"><view class="flow-dot"></view><text class="flow-text">å¤æ ¸</text></view><view class="{{['flow-line',record.status==='completed'?'completed':'']}}"></view><view class="{{['flow-item',record.status==='completed'?'completed':'']}}"><view class="flow-dot"></view><text class="flow-text">å®Œæˆ</text></view></view><view class="{{['status-badge-large','badge-'+record.status]}}"><text class="badge-icon">{{$root.m0}}</text><text class="badge-text">{{$root.m1}}</text></view><view class="info-card"><view class="card-title"><text class="title-icon">ğŸ“‹</text><text class="title-text">åŸºæœ¬ä¿¡æ¯</text></view><view class="info-grid"><view class="grid-item"><text class="item-label">å•å·</text><text class="item-value mono">{{record.recordNo}}</text></view><view class="grid-item"><text class="item-label">åˆ›å»ºæ—¶é—´</text><text class="item-value">{{record.createTime}}</text></view><view class="grid-item"><text class="item-label">æ“ä½œäºº</text><text class="item-value">{{record.operator}}</text></view></view></view><view class="info-card"><view class="card-title"><text class="title-icon">ğŸ’Š</text><text class="title-text">è¯ææ˜ç»†</text><text class="title-count">{{(record.items?$root.g0:0)+"ç§"}}</text></view><view class="drug-list"><block wx:for="{{record.items}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="drug-item-card"><view class="drug-header"><view class="drug-name-wrapper"><text class="drug-name">{{item.drugName}}</text><text class="drug-spec">{{item.spec}}</text></view><view class="drug-quantity-badge"><text class="quantity-num">{{item.quantity}}</text><text class="quantity-unit">{{item.unit}}</text></view></view><view class="drug-details-grid"><view class="detail-item"><text class="detail-label">æ‰¹å·</text><text class="detail-value mono">{{item.batch}}</text></view><view class="detail-item"><text class="detail-label">æœ‰æ•ˆæœŸ</text><text class="detail-value">{{item.expireDate}}</text></view><view class="detail-item"><text class="detail-label">ç”Ÿäº§æ—¥æœŸ</text><text class="detail-value">{{item.productionDate}}</text></view><view class="detail-item"><text class="detail-label">ç”Ÿäº§å‚å®¶</text><text class="detail-value">{{item.manufacturer}}</text></view><block wx:if="{{item.price}}"><view class="detail-item"><text class="detail-label">å•ä»·</text><text class="detail-value price">{{"Â¥"+item.price}}</text></view></block></view></view></block></view></view><view class="signature-section"><view class="signature-card"><view class="signature-header"><text class="sig-icon">âœï¸</text><text class="sig-title">æ“ä½œå‘˜ç­¾å</text><text class="sig-name">{{record.operator}}</text></view><view class="signature-content"><block wx:if="{{record.operatorSign}}"><image class="signature-image" src="{{record.operatorSign}}" mode="aspectFit"></image></block><text class="signature-time">{{record.operatorSignTime}}</text></view></view><block wx:if="{{record.status==='completed'}}"><view class="signature-card"><view class="signature-header"><text class="sig-icon">âœ…</text><text class="sig-title">å¤æ ¸å‘˜ç­¾å</text><text class="sig-name">{{record.reviewer}}</text></view><view class="signature-content"><block wx:if="{{record.reviewerSign}}"><image class="signature-image" src="{{record.reviewerSign}}" mode="aspectFit"></image></block><text class="signature-time">{{record.reviewerSignTime}}</text></view></view></block></view><block wx:if="{{record.status==='rejected'}}"><view class="reject-card"><view class="reject-header"><text class="reject-icon">âš ï¸</text><text class="reject-title">é©³å›åŸå› </text></view><view class="reject-body"><text class="reject-reason">{{record.rejectReason}}</text><view class="reject-footer"><text class="reject-reviewer">{{"å¤æ ¸äººï¼š"+record.reviewer}}</text><text class="reject-time">{{record.reviewerSignTime}}</text></view></view></view></block><block wx:if="{{isReviewAction&&record.status==='pending_review'}}"><view class="review-section"><view class="review-card"><view class="card-title"><text class="title-icon">âœï¸</text><text class="title-text">å¤æ ¸æ“ä½œ</text></view><view class="signature-input"><signature bind:input="__e" vue-id="b51f17be-1" title="è¯·ç­¾åç¡®è®¤" value="{{reviewerSign}}" data-event-opts="{{[['^input',[['__set_model',['','reviewerSign','$event',[]]]]]]}}" bind:__l="__l"></signature></view><view class="reject-input"><text class="input-label">é©³å›åŸå› ï¼ˆé€‰å¡«ï¼‰</text><textarea class="reject-textarea" placeholder="å¦‚éœ€é©³å›ï¼Œè¯·å¡«å†™åŸå› " maxlength="200" data-event-opts="{{[['input',[['__set_model',['','rejectReason','$event',[]]]]]]}}" value="{{rejectReason}}" bindinput="__e"></textarea></view></view></view></block><block wx:if="{{showActions}}"><view class="action-bar"><block wx:if="{{isReviewAction&&record.status==='pending_review'}}"><view data-event-opts="{{[['tap',[['handleReject',['$event']]]]]}}" class="action-btn btn-reject" bindtap="__e"><text class="btn-icon">âœ•</text><text class="btn-text">é©³å›</text></view><view data-event-opts="{{[['tap',[['handleApprove',['$event']]]]]}}" class="action-btn btn-approve" bindtap="__e"><text class="btn-icon">âœ“</text><text class="btn-text">é€šè¿‡å¤æ ¸</text></view></block><block wx:else><block wx:if="{{record.status==='completed'}}"><view data-event-opts="{{[['tap',[['handleExportPDF',['$event']]]]]}}" class="action-btn btn-export" bindtap="__e"><text class="btn-icon">ğŸ“¤</text><text class="btn-text">å¯¼å‡ºPDF</text></view></block></block></view></block></view>