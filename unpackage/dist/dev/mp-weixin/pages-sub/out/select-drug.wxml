<view class="page data-v-2abd059a"><view class="search-bar data-v-2abd059a"><view class="search-input-wrapper data-v-2abd059a"><text class="search-icon data-v-2abd059a">ğŸ”</text><input class="search-input data-v-2abd059a" placeholder="æœç´¢è¯æåç§°/ä»£ç " confirm-type="search" data-event-opts="{{[['input',[['__set_model',['','searchKeyword','$event',[]]],['onSearchInput',['$event']]]]]}}" value="{{searchKeyword}}" bindinput="__e"/><block wx:if="{{searchKeyword}}"><text data-event-opts="{{[['tap',[['clearSearch',['$event']]]]]}}" class="clear-icon data-v-2abd059a" bindtap="__e">âœ•</text></block></view></view><view class="filter-bar data-v-2abd059a"><view data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="filter-item data-v-2abd059a" bindtap="__e"><text class="data-v-2abd059a">{{selectedCategory||'å…¨éƒ¨åˆ†ç±»'}}</text><text class="arrow data-v-2abd059a">â€º</text></view></view><view class="drug-list data-v-2abd059a"><block wx:for="{{filteredDrugList}}" wx:for-item="drug" wx:for-index="__i0__" wx:key="_id"><view data-event-opts="{{[['tap',[['selectDrug',['$0'],[[['filteredDrugList','_id',drug._id]]]]]]]}}" class="drug-card data-v-2abd059a" bindtap="__e"><view class="drug-main data-v-2abd059a"><view class="drug-header data-v-2abd059a"><text class="drug-name data-v-2abd059a">{{drug.name}}</text><view class="drug-badges data-v-2abd059a"><block wx:if="{{drug.isHighValue}}"><text class="badge high-value data-v-2abd059a">é«˜å€¼</text></block><block wx:if="{{drug.isEmergency}}"><text class="badge emergency data-v-2abd059a">æ€¥æ•‘</text></block></view></view><view class="drug-details data-v-2abd059a"><view class="detail-row data-v-2abd059a"><text class="detail-label data-v-2abd059a">è§„æ ¼ï¼š</text><text class="detail-value data-v-2abd059a">{{drug.specification}}</text></view><view class="detail-row data-v-2abd059a"><text class="detail-label data-v-2abd059a">å•ä½ï¼š</text><text class="detail-value data-v-2abd059a">{{drug.unit}}</text></view><block wx:if="{{drug.drugCode}}"><view class="detail-row data-v-2abd059a"><text class="detail-label data-v-2abd059a">ä»£ç ï¼š</text><text class="detail-value data-v-2abd059a">{{drug.drugCode}}</text></view></block><block wx:if="{{drug.manufacturer}}"><view class="detail-row data-v-2abd059a"><text class="detail-label data-v-2abd059a">å‚å®¶ï¼š</text><text class="detail-value data-v-2abd059a">{{drug.manufacturer}}</text></view></block></view></view><view class="drug-action data-v-2abd059a"><view class="action-icon data-v-2abd059a">ğŸ“¦</view><text class="action-text data-v-2abd059a">é€‰æ‹©æ‰¹æ¬¡</text><text class="action-arrow data-v-2abd059a">â€º</text></view></view></block><block wx:if="{{$root.g0===0}}"><view class="empty-state data-v-2abd059a"><text class="empty-icon data-v-2abd059a">ğŸ“¦</text><text class="empty-text data-v-2abd059a">{{searchKeyword?'æœªæ‰¾åˆ°ç›¸å…³è¯æ':'æš‚æ— è¯ææ•°æ®'}}</text></view></block><block wx:if="{{loading}}"><view class="loading-state data-v-2abd059a"><text class="data-v-2abd059a">åŠ è½½ä¸­...</text></view></block></view><block wx:if="{{showBatchSelector}}"><view data-event-opts="{{[['tap',[['closeBatchSelector',['$event']]]]]}}" class="batch-popup-mask data-v-2abd059a" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="batch-popup data-v-2abd059a" catchtap="__e"><view class="popup-header data-v-2abd059a"><text class="popup-title data-v-2abd059a">é€‰æ‹©æ‰¹æ¬¡</text><view data-event-opts="{{[['tap',[['closeBatchSelector',['$event']]]]]}}" class="close-btn data-v-2abd059a" bindtap="__e">âœ•</view></view><block wx:if="{{selectedDrug}}"><view class="drug-info-bar data-v-2abd059a"><text class="data-v-2abd059a">{{"è¯æï¼š"+selectedDrug.name}}</text><text class="data-v-2abd059a">{{"è§„æ ¼ï¼š"+selectedDrug.specification}}</text></view></block><view class="batch-list-container data-v-2abd059a"><block wx:if="{{loading}}"><view class="loading-hint data-v-2abd059a">åŠ è½½ä¸­...</view></block><block wx:else><block wx:if="{{$root.g1===0}}"><view class="empty-hint data-v-2abd059a"><text class="data-v-2abd059a">ğŸ“¦</text><text class="data-v-2abd059a">è¯¥è¯ææš‚æ— åº“å­˜</text></view></block><block wx:else><view class="data-v-2abd059a"><block wx:for="{{batchList}}" wx:for-item="batch" wx:for-index="__i1__" wx:key="_id"><view data-event-opts="{{[['tap',[['selectBatch',['$0'],[[['batchList','_id',batch._id]]]]]]]}}" class="batch-item data-v-2abd059a" bindtap="__e"><view class="batch-header data-v-2abd059a"><text class="batch-number data-v-2abd059a">{{"æ‰¹å·ï¼š"+batch.batch}}</text><text class="stock-quantity data-v-2abd059a">{{"åº“å­˜ï¼š"+batch.quantity+" "+selectedDrug.unit}}</text></view><view class="batch-details data-v-2abd059a"><text class="data-v-2abd059a">{{"ç”Ÿäº§æ—¥æœŸï¼š"+batch.productionDate}}</text><text class="data-v-2abd059a">{{"æœ‰æ•ˆæœŸè‡³ï¼š"+batch.expireDate}}</text></view></view></block></view></block></block></view></view></view></block><block wx:if="{{showCategoryPicker}}"><picker value="{{categoryIndex}}" range="{{categories}}" data-event-opts="{{[['change',[['onCategoryChange',['$event']]]],['cancel',[['e1',['$event']]]]]}}" bindchange="__e" bindcancel="__e" class="data-v-2abd059a"></picker></block></view>