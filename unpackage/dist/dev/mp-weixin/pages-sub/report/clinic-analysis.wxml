<view class="container data-v-202b1fa8"><view class="page-header data-v-202b1fa8"><view class="page-header-inner data-v-202b1fa8"><text class="page-title data-v-202b1fa8">门诊统计分析</text></view></view><view class="filter-card data-v-202b1fa8"><view class="filter-row data-v-202b1fa8"><view class="filter-item data-v-202b1fa8"><text class="label data-v-202b1fa8">开始日期</text><picker mode="date" value="{{filters.startDate}}" data-event-opts="{{[['change',[['onStartDateChange',['$event']]]]]}}" bindchange="__e" class="data-v-202b1fa8"><view class="picker-text data-v-202b1fa8">{{filters.startDate||'请选择'}}</view></picker></view><view class="filter-item data-v-202b1fa8"><text class="label data-v-202b1fa8">结束日期</text><picker mode="date" value="{{filters.endDate}}" data-event-opts="{{[['change',[['onEndDateChange',['$event']]]]]}}" bindchange="__e" class="data-v-202b1fa8"><view class="picker-text data-v-202b1fa8">{{filters.endDate||'请选择'}}</view></picker></view></view><view class="filter-row data-v-202b1fa8"><view class="filter-item data-v-202b1fa8"><text class="label data-v-202b1fa8">园区</text><picker mode="selector" range="{{locationOptions}}" value="{{locationIndex}}" data-event-opts="{{[['change',[['onLocationChange',['$event']]]]]}}" bindchange="__e" class="data-v-202b1fa8"><view class="picker-text data-v-202b1fa8">{{currentLocationLabel}}</view></picker></view><view class="filter-item actions data-v-202b1fa8"><button data-event-opts="{{[['tap',[['resetFilters',['$event']]]]]}}" class="btn ghost data-v-202b1fa8" bindtap="__e">重置</button><button data-event-opts="{{[['tap',[['fetchAll',['$event']]]]]}}" class="btn primary data-v-202b1fa8" bindtap="__e">分析</button></view></view><view class="filter-row dev-row data-v-202b1fa8"><view class="filter-item dev-tip data-v-202b1fa8"><text class="dev-text data-v-202b1fa8">（开发用）可一键生成近几天的模拟门诊数据，用于测试统计结果。</text></view><view class="filter-item actions data-v-202b1fa8"><button data-event-opts="{{[['tap',[['seedMock',['$event']]]]]}}" class="btn ghost dev-btn data-v-202b1fa8" bindtap="__e">生成测试数据</button></view></view></view><view class="summary-section data-v-202b1fa8"><view class="summary-grid data-v-202b1fa8"><view class="summary-card data-v-202b1fa8"><text class="summary-label data-v-202b1fa8">总就诊人数</text><text class="summary-value data-v-202b1fa8">{{summary.total}}<text class="unit data-v-202b1fa8">人</text></text></view><view class="summary-card data-v-202b1fa8"><text class="summary-label data-v-202b1fa8">游客</text><text class="summary-value data-v-202b1fa8">{{summary.visitorCount}}<text class="unit data-v-202b1fa8">人</text></text></view><view class="summary-card data-v-202b1fa8"><text class="summary-label data-v-202b1fa8">员工</text><text class="summary-value data-v-202b1fa8">{{summary.employeeCount}}<text class="unit data-v-202b1fa8">人</text></text></view><view class="summary-card data-v-202b1fa8"><text class="summary-label data-v-202b1fa8">出诊次数</text><text class="summary-value data-v-202b1fa8">{{summary.outcallCount}}<text class="unit data-v-202b1fa8">次</text></text></view></view></view><view class="list-section data-v-202b1fa8"><view class="list-header data-v-202b1fa8"><text class="list-title data-v-202b1fa8">高发疾病 Top</text></view><block wx:if="{{$root.g0}}"><view class="list-card data-v-202b1fa8"><view class="list-row header data-v-202b1fa8"><text class="col name data-v-202b1fa8">疾病</text><text class="col count data-v-202b1fa8">人数</text><text class="col ratio data-v-202b1fa8">占比</text></view><block wx:for="{{topDiseases}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="list-row data-v-202b1fa8"><text class="col name data-v-202b1fa8">{{item.name}}</text><text class="col count data-v-202b1fa8">{{item.count+"人"}}</text><text class="col ratio data-v-202b1fa8">{{item.ratio+"%"}}</text></view></block></view></block><block wx:else><view class="empty-hint data-v-202b1fa8">暂无疾病统计数据</view></block></view><view class="list-section data-v-202b1fa8"><view class="list-header data-v-202b1fa8"><text class="list-title data-v-202b1fa8">用药 Top</text></view><block wx:if="{{$root.g1}}"><view class="list-card data-v-202b1fa8"><view class="list-row header data-v-202b1fa8"><text class="col name data-v-202b1fa8">药品</text><text class="col count data-v-202b1fa8">用量</text><text class="col ratio data-v-202b1fa8">用药人数</text></view><block wx:for="{{topDrugs}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="list-row data-v-202b1fa8"><text class="col name data-v-202b1fa8">{{item.drugName+" "+item.specification}}</text><text class="col count data-v-202b1fa8">{{item.totalQuantityMin+(item.minUnit||'')}}</text><text class="col ratio data-v-202b1fa8">{{item.patientCount+"人"}}</text></view></block></view></block><block wx:else><view class="empty-hint data-v-202b1fa8">暂无用药统计数据</view></block></view></view>