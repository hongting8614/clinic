<view class="container data-v-0c675e16"><view class="page-header data-v-0c675e16"><view class="header-left data-v-0c675e16"><text class="page-title data-v-0c675e16">å‡ºåº“ç®¡ç†æŠ¥è¡¨</text></view><view class="page-actions data-v-0c675e16"><view data-event-opts="{{[['tap',[['resetFilters',['$event']]]]]}}" class="header-btn ghost data-v-0c675e16" bindtap="__e"><text class="btn-icon data-v-0c675e16">â†º</text><text class="btn-text data-v-0c675e16">é‡ç½®</text></view><view data-event-opts="{{[['tap',[['fetchCurrentTab',['$event']]]]]}}" class="header-btn primary data-v-0c675e16" bindtap="__e"><text class="btn-icon data-v-0c675e16" style="color:blue;">â†»</text><text class="btn-text data-v-0c675e16">åˆ·æ–°</text></view></view></view><view class="tab-bar data-v-0c675e16"><block wx:for="{{tabs}}" wx:for-item="tab" wx:for-index="__i0__" wx:key="value"><view data-event-opts="{{[['tap',[['switchTab',['$0'],[[['tabs','value',tab.value,'value']]]]]]]}}" class="{{['data-v-0c675e16','tab-item',[(tab.value===activeTab)?'active':'']]}}" bindtap="__e"><text class="tab-label data-v-0c675e16">{{tab.label}}</text><text class="tab-desc data-v-0c675e16">{{tab.desc}}</text></view></block></view><block wx:if="{{activeTab!=='period'}}"><filter-panel class="filter-panel-wrapper data-v-0c675e16" vue-id="3fbe4eb1-1" show-date="{{true}}" start-date="{{filters.startDate}}" end-date="{{filters.endDate}}" quick-filters="{{quickFilters}}" active-quick-filter="{{filters.quick}}" hideKeyword="{{true}}" show-search-button="{{false}}" keyword-placeholder="è¾“å…¥å•å·/è¯æ" keyword="{{filters.recordNo}}" data-event-opts="{{[['^updateStartDate',[['e0']]],['^updateEndDate',[['e1']]],['^quickFilter',[['selectQuickFilter']]],['^dateChange',[['onDateChange']]],['^updateKeyword',[['e2']]],['^search',[['fetchCurrentTab']]]]}}" bind:updateStartDate="__e" bind:updateEndDate="__e" bind:quickFilter="__e" bind:dateChange="__e" bind:updateKeyword="__e" bind:search="__e" bind:__l="__l" vue-slots="{{['default']}}"><view class="filter-extra data-v-0c675e16"><view class="filter-row data-v-0c675e16"><view class="extra-item extra-item--drug data-v-0c675e16"><text class="extra-label data-v-0c675e16">è¯æåç§°</text><view class="extra-input-wrapper data-v-0c675e16"><text class="extra-input-icon data-v-0c675e16">ğŸ”</text><input class="extra-input data-v-0c675e16" placeholder="æ¨¡ç³ŠæŸ¥è¯¢è¯æå" data-event-opts="{{[['confirm',[['fetchCurrentTab',['$event']]]],['input',[['__set_model',['$0','drugName','$event',['trim']],['filters']]]],['blur',[['$forceUpdate']]]]}}" value="{{filters.drugName}}" bindconfirm="__e" bindinput="__e" bindblur="__e"/></view></view></view><view class="filter-row filter-row--two data-v-0c675e16"><view class="extra-item extra-item--operator data-v-0c675e16"><text class="extra-label data-v-0c675e16">å‘æ”¾äºº</text><view class="extra-input-wrapper data-v-0c675e16"><text class="extra-input-icon data-v-0c675e16">ğŸ”</text><input class="extra-input data-v-0c675e16" placeholder="è¾“å…¥å‘æ”¾äºº" data-event-opts="{{[['confirm',[['fetchCurrentTab',['$event']]]],['input',[['__set_model',['$0','operator','$event',['trim']],['filters']]]],['blur',[['$forceUpdate']]]]}}" value="{{filters.operator}}" bindconfirm="__e" bindinput="__e" bindblur="__e"/></view></view><view class="extra-item extra-item--location data-v-0c675e16"><text class="extra-label data-v-0c675e16">å›­åŒº</text><picker mode="selector" range="{{locationOptions}}" range-key="label" value="{{locationFilterIndex}}" data-event-opts="{{[['change',[['onLocationFilterChange',['$event']]]]]}}" bindchange="__e" class="data-v-0c675e16"><view class="extra-input data-v-0c675e16">{{''+locationOptions[locationFilterIndex].label+''}}</view></picker></view></view><view class="filter-row filter-row--two data-v-0c675e16"><view class="extra-item extra-item--batch data-v-0c675e16"><text class="extra-label data-v-0c675e16">æ‰¹å·</text><view class="extra-input-wrapper data-v-0c675e16"><text class="extra-input-icon data-v-0c675e16">ğŸ”</text><input class="extra-input data-v-0c675e16" placeholder="è¾“å…¥æ‰¹å·" data-event-opts="{{[['confirm',[['fetchCurrentTab',['$event']]]],['input',[['__set_model',['$0','batchNo','$event',['trim']],['filters']]]],['blur',[['$forceUpdate']]]]}}" value="{{filters.batchNo}}" bindconfirm="__e" bindinput="__e" bindblur="__e"/></view></view><view data-event-opts="{{[['tap',[['toggleIncludeDraft',['$event']]]]]}}" class="extra-item toggle-item data-v-0c675e16" bindtap="__e"><text class="extra-label data-v-0c675e16">è‰ç¨¿æ•°æ®</text><view class="{{['toggle','data-v-0c675e16',(filters.includeDraft)?'active':'']}}"><view class="toggle-dot data-v-0c675e16"></view></view></view></view></view></filter-panel></block><block wx:else><view class="period-filter-card data-v-0c675e16"><view class="period-title data-v-0c675e16">æ—¶é—´æ®µå¿«é€ŸæŸ¥è¯¢ï¼ˆè‡ªåŠ¨åˆ—å‡ºæ‰€æœ‰è¯ææ˜ç»†ï¼‰</view><view class="period-chips data-v-0c675e16"><block wx:for="{{periodQuickFilters}}" wx:for-item="item" wx:for-index="__i1__" wx:key="value"><view data-event-opts="{{[['tap',[['selectPeriodFilter',['$0'],[[['periodQuickFilters','value',item.value,'value']]]]]]]}}" class="{{['data-v-0c675e16','period-chip',[(periodFilter===item.value)?'active':'']]}}" bindtap="__e">{{''+item.label+''}}</view></block></view><view class="period-range data-v-0c675e16"><text class="data-v-0c675e16">{{"å½“å‰åŒºé—´ï¼š"+periodRange.startDate+" ~ "+periodRange.endDate}}</text><text class="range-hint data-v-0c675e16">ç³»ç»Ÿè‡ªåŠ¨å¥—ç”¨æ—¶é—´æ®µï¼Œç›´æ¥ç”ŸæˆæŠ¥è¡¨</text></view></view></block><block wx:if="{{statistics}}"><view class="stats-card data-v-0c675e16"><view class="stat-item data-v-0c675e16"><text class="stat-value data-v-0c675e16">{{statistics.totalRecords}}</text><text class="stat-label data-v-0c675e16">è®°å½•æ•°</text></view><view class="stat-item data-v-0c675e16"><text class="stat-value data-v-0c675e16">{{statistics.totalDrugs}}</text><text class="stat-label data-v-0c675e16">è¯æç§ç±»</text></view><view class="stat-item data-v-0c675e16"><text class="stat-value data-v-0c675e16">{{statistics.totalQuantity}}</text><text class="stat-label data-v-0c675e16">æ€»æ•°é‡</text></view><view class="stat-item data-v-0c675e16"><text class="stat-value data-v-0c675e16">{{"Â¥"+statistics.totalAmount}}</text><text class="stat-label data-v-0c675e16">æ€»é‡‘é¢</text></view></view></block><block wx:if="{{activeTab==='summary'}}"><view class="table-section data-v-0c675e16"><block wx:if="{{$root.g0}}"><view class="detail-list data-v-0c675e16"><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="__i2__" wx:key="_id"><view data-event-opts="{{[['tap',[['viewDetail',['$0'],[[['summaryRows','_id',item.$orig._id,'_id']]]]]]]}}" class="detail-card data-v-0c675e16" bindtap="__e"><view class="detail-row detail-row-top data-v-0c675e16"><text class="detail-no data-v-0c675e16">{{item.$orig.recordNo}}</text><text class="detail-date data-v-0c675e16">{{item.m0}}</text></view><view class="detail-row detail-row-meta data-v-0c675e16"><text class="meta-label data-v-0c675e16">å‘æ”¾äºº</text><text class="meta-value data-v-0c675e16">{{item.$orig.operator||'-'}}</text><text class="meta-label data-v-0c675e16">çŠ¶æ€</text><text class="meta-value data-v-0c675e16">{{item.m1}}</text></view><view class="detail-row detail-row-main data-v-0c675e16"><view class="detail-main-left data-v-0c675e16"><text class="detail-spec data-v-0c675e16">{{"å“ç§ï¼š"+item.$orig.drugCount+" ç§"}}</text></view><view class="detail-main-right data-v-0c675e16"><text class="detail-qty data-v-0c675e16">{{item.$orig.totalQuantity}}</text><text class="detail-amount data-v-0c675e16">{{"Â¥"+item.$orig.totalAmount}}</text></view></view></view></block></view></block><block wx:else><view class="empty-state data-v-0c675e16"><text class="empty-icon data-v-0c675e16">ğŸ“Š</text><text class="empty-text data-v-0c675e16">æš‚æ— æ•°æ®</text><text class="empty-hint data-v-0c675e16">è°ƒæ•´ç­›é€‰æ¡ä»¶åé‡æ–°ç”ŸæˆæŠ¥è¡¨</text></view></block></view></block><block wx:if="{{activeTab==='detail'}}"><view class="table-section data-v-0c675e16"><block wx:if="{{$root.g1}}"><view class="detail-list data-v-0c675e16"><block wx:for="{{$root.l1}}" wx:for-item="item" wx:for-index="idx" wx:key="idx"><view class="detail-card data-v-0c675e16"><view class="detail-row detail-row-top data-v-0c675e16"><text class="detail-no data-v-0c675e16">{{item.$orig.recordNo}}</text><text class="detail-date data-v-0c675e16">{{item.m2}}</text></view><view class="detail-row detail-row-main data-v-0c675e16"><view class="detail-main-left data-v-0c675e16"><text class="detail-drug data-v-0c675e16">{{item.$orig.drugName}}</text><text class="detail-spec data-v-0c675e16">{{item.$orig.specification}}</text></view><view class="detail-main-right data-v-0c675e16"><text class="detail-qty data-v-0c675e16">{{item.$orig.quantity+item.$orig.unit}}</text><block wx:if="{{item.$orig.amount!=null}}"><text class="detail-amount data-v-0c675e16">{{"Â¥"+item.$orig.amount}}</text></block></view></view><view class="detail-row detail-row-meta data-v-0c675e16"><text class="meta-label data-v-0c675e16">æ‰¹å·</text><text class="meta-value mono data-v-0c675e16">{{item.$orig.batchNo||'-'}}</text><text class="meta-label data-v-0c675e16">å‘æ”¾äºº</text><text class="meta-value data-v-0c675e16">{{item.$orig.operator||'-'}}</text></view><view class="detail-row detail-row-meta data-v-0c675e16"><text class="meta-label data-v-0c675e16">ç”Ÿäº§</text><text class="meta-value data-v-0c675e16">{{item.$orig.productionDate||'-'}}</text><text class="meta-label data-v-0c675e16">æœ‰æ•ˆ</text><text class="meta-value data-v-0c675e16">{{item.$orig.expireDate||'-'}}</text></view><block wx:if="{{item.$orig.manufacturer}}"><view class="detail-row detail-row-manufacturer data-v-0c675e16"><text class="meta-label data-v-0c675e16">å‚å®¶</text><text class="meta-value data-v-0c675e16">{{item.$orig.manufacturer}}</text></view></block></view></block></view></block><block wx:else><view class="empty-state data-v-0c675e16"><text class="empty-icon data-v-0c675e16">ğŸ“„</text><text class="empty-text data-v-0c675e16">æœªæ‰¾åˆ°æ˜ç»†</text><text class="empty-hint data-v-0c675e16">å¯ä»¥æ”¾å®½æœç´¢æ¡ä»¶åå†è¯•</text></view></block></view></block><block wx:if="{{activeTab==='period'}}"><view class="table-section data-v-0c675e16"><block wx:if="{{$root.g2}}"><view class="detail-list data-v-0c675e16"><block wx:for="{{$root.l2}}" wx:for-item="item" wx:for-index="idx" wx:key="idx"><view class="detail-card data-v-0c675e16"><view class="detail-row detail-row-top data-v-0c675e16"><text class="detail-no data-v-0c675e16">{{item.$orig.recordNo}}</text><text class="detail-date data-v-0c675e16">{{item.m3}}</text></view><view class="detail-row detail-row-main data-v-0c675e16"><view class="detail-main-left data-v-0c675e16"><text class="detail-drug data-v-0c675e16">{{item.$orig.drugName}}</text><text class="detail-spec data-v-0c675e16">{{item.$orig.specification}}</text></view><view class="detail-main-right data-v-0c675e16"><text class="detail-qty data-v-0c675e16">{{item.$orig.quantity+item.$orig.unit}}</text><block wx:if="{{item.$orig.amount!=null}}"><text class="detail-amount data-v-0c675e16">{{"Â¥"+item.$orig.amount}}</text></block></view></view><view class="detail-row detail-row-meta data-v-0c675e16"><text class="meta-label data-v-0c675e16">æ‰¹å·</text><text class="meta-value mono data-v-0c675e16">{{item.$orig.batchNo||'-'}}</text><text class="meta-label data-v-0c675e16">æ“ä½œäºº</text><text class="meta-value data-v-0c675e16">{{item.$orig.operator||'-'}}</text></view><view class="detail-row detail-row-meta data-v-0c675e16"><text class="meta-label data-v-0c675e16">ç”Ÿäº§</text><text class="meta-value data-v-0c675e16">{{item.$orig.productionDate||'-'}}</text><text class="meta-label data-v-0c675e16">æœ‰æ•ˆ</text><text class="meta-value data-v-0c675e16">{{item.$orig.expireDate||'-'}}</text></view><block wx:if="{{item.$orig.manufacturer}}"><view class="detail-row detail-row-manufacturer data-v-0c675e16"><text class="meta-label data-v-0c675e16">å‚å®¶</text><text class="meta-value data-v-0c675e16">{{item.$orig.manufacturer}}</text></view></block></view></block></view></block><block wx:else><view class="empty-state data-v-0c675e16"><text class="empty-icon data-v-0c675e16">ğŸ—“ï¸</text><text class="empty-text data-v-0c675e16">è¯¥æ—¶é—´æ®µæš‚æ— å‡ºåº“</text><text class="empty-hint data-v-0c675e16">è¯•è¯•å…¶å®ƒæ—¶é—´æ®µ</text></view></block></view></block><block wx:if="{{hasData}}"><view class="export-section data-v-0c675e16"><view data-event-opts="{{[['tap',[['exportExcel',['$event']]]]]}}" class="export-btn data-v-0c675e16" bindtap="__e"><text class="export-icon data-v-0c675e16">ğŸ“„</text><text class="export-text data-v-0c675e16">å¯¼å‡ºExcel</text></view><view data-event-opts="{{[['tap',[['exportPDF',['$event']]]]]}}" class="export-btn data-v-0c675e16" bindtap="__e"><text class="export-icon data-v-0c675e16">ğŸ“‘</text><text class="export-text data-v-0c675e16">å¯¼å‡ºPDF</text></view><view class="export-btn disabled data-v-0c675e16"><text class="export-icon data-v-0c675e16">ğŸ–¨ï¸</text><text class="export-text data-v-0c675e16">æ‰“å°(å¼€å‘ä¸­)</text></view></view></block></view>