<view class="user-management data-v-72193c6b"><block wx:if="{{isChecking}}"><view class="checking-container data-v-72193c6b"><view class="checking-content data-v-72193c6b"><text class="checking-text data-v-72193c6b">æ£€æŸ¥ç™»å½•çŠ¶æ€...</text></view></view></block><block wx:else><block wx:if="{{isAuthorized}}"><view class="page-content data-v-72193c6b"><view class="page-toolbar toolbar-light data-v-72193c6b"><text class="toolbar-role data-v-72193c6b">{{"å½“å‰è§’è‰²ï¼š"+currentRoleText}}</text><button data-event-opts="{{[['tap',[['showAddDialog',['$event']]]]]}}" class="btn-add btn-primary data-v-72193c6b" bindtap="__e"><text class="btn-add-text data-v-72193c6b">æ·»åŠ ç”¨æˆ·</text></button></view><block wx:if="{{totalUsers>0}}"><view class="stats-card data-v-72193c6b" style="background-color:#f9f9f9;padding:16px;border-bottom:1px solid #ddd;"><view class="stat-item data-v-72193c6b"><text class="stat-value data-v-72193c6b">{{totalUsers}}</text><text class="stat-label data-v-72193c6b">æ€»ç”¨æˆ·æ•°</text></view><view class="stat-item data-v-72193c6b"><text class="stat-value data-v-72193c6b">{{activeUsers}}</text><text class="stat-label data-v-72193c6b">æ´»è·ƒç”¨æˆ·</text></view><view class="stat-item data-v-72193c6b"><text class="stat-value data-v-72193c6b">{{adminCount}}</text><text class="stat-label data-v-72193c6b">ç®¡ç†å‘˜</text></view></view></block><block wx:if="{{totalUsers>0}}"><view class="filter-bar data-v-72193c6b" style="display:flex;justify-content:space-between;align-items:center;padding:16px;background-color:#f9f9f9;border-bottom:1px solid #ddd;"><picker range="{{roleFilter}}" range-key="text" data-event-opts="{{[['change',[['onRoleFilterChange',['$event']]]]]}}" bindchange="__e" class="data-v-72193c6b"><view class="filter-item data-v-72193c6b"><text class="data-v-72193c6b">{{"è§’è‰²ï¼š"+selectedRoleText}}</text><text class="arrow data-v-72193c6b">â–¼</text></view></picker><picker range="{{statusFilter}}" range-key="text" data-event-opts="{{[['change',[['onStatusFilterChange',['$event']]]]]}}" bindchange="__e" class="data-v-72193c6b"><view class="filter-item data-v-72193c6b"><text class="data-v-72193c6b">{{"çŠ¶æ€ï¼š"+selectedStatusText}}</text><text class="arrow data-v-72193c6b">â–¼</text></view></picker></view></block><view class="user-list data-v-72193c6b"><block wx:for="{{$root.l0}}" wx:for-item="user" wx:for-index="__i0__" wx:key="_id"><view class="{{['user-item','data-v-72193c6b',(user.$orig.status!=='active')?'inactive':'',(editingUserId===user.$orig._id)?'editing':'']}}"><view class="user-info data-v-72193c6b"><view class="user-avatar data-v-72193c6b">{{''+user.g0+''}}</view><view class="user-details data-v-72193c6b"><view class="user-name data-v-72193c6b"><text class="data-v-72193c6b">{{user.$orig.name}}</text><text class="{{['role-tag','data-v-72193c6b','role-'+user.$orig.role]}}">{{''+user.$orig.roleText+''}}</text></view><view class="user-meta data-v-72193c6b"><text class="meta-item data-v-72193c6b">{{"å®åï¼š"+(user.$orig.realName||'æœªè®¾ç½®')}}</text></view><view class="user-meta data-v-72193c6b"><text class="meta-item data-v-72193c6b">{{user.$orig.phone}}</text></view><block wx:if="{{user.$orig.lastLogin}}"><view class="user-meta data-v-72193c6b"><text class="meta-item data-v-72193c6b">{{'æœ€è¿‘ç™»å½•: '+user.m0+''}}</text></view></block></view></view><view class="user-actions data-v-72193c6b"><button class="btn-action btn-edit data-v-72193c6b" disabled="{{user.$orig.openid===currentUserOpenid}}" data-event-opts="{{[['tap',[['editUser',['$0'],[[['filteredUserList','_id',user.$orig._id]]]]]]]}}" bindtap="__e">{{''+(editingUserId===user.$orig._id?'æ”¶èµ·':'ç¼–è¾‘')+''}}</button><button class="btn-action btn-toggle data-v-72193c6b" disabled="{{user.$orig.openid===currentUserOpenid}}" data-event-opts="{{[['tap',[['toggleUserStatus',['$0'],[[['filteredUserList','_id',user.$orig._id]]]]]]]}}" bindtap="__e">{{''+(user.$orig.status==='active'?'ç¦ç”¨':'å¯ç”¨')+''}}</button><button class="btn-action btn-delete data-v-72193c6b" disabled="{{user.$orig.openid===currentUserOpenid}}" data-event-opts="{{[['tap',[['deleteUser',['$0'],[[['filteredUserList','_id',user.$orig._id]]]]]]]}}" bindtap="__e"> åˆ é™¤ </button></view><block wx:if="{{editingUserId===user.$orig._id}}"><view class="inline-edit-form data-v-72193c6b"><view class="edit-form-header data-v-72193c6b"><text class="edit-form-title data-v-72193c6b">ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯</text></view><view class="edit-form-body data-v-72193c6b"><view class="inline-form-item data-v-72193c6b"><text class="inline-label data-v-72193c6b">å¾®ä¿¡å·</text><input class="inline-input data-v-72193c6b" placeholder="è¯·è¾“å…¥å¾®ä¿¡å·ï¼ˆæˆ–å”¯ä¸€å¤‡æ³¨åï¼‰" data-event-opts="{{[['input',[['__set_model',['$0','wechatId','$event',[]],['form']]]]]}}" value="{{form.wechatId}}" bindinput="__e"/></view><view class="inline-form-item data-v-72193c6b"><text class="inline-label data-v-72193c6b">å§“å *</text><input class="inline-input data-v-72193c6b" placeholder="è¯·è¾“å…¥å§“å" data-event-opts="{{[['input',[['__set_model',['$0','name','$event',[]],['form']]]]]}}" value="{{form.name}}" bindinput="__e"/></view><view class="inline-form-item data-v-72193c6b"><text class="inline-label data-v-72193c6b">å®å *</text><input class="inline-input data-v-72193c6b" placeholder="è¯·è¾“å…¥çœŸå®å§“åï¼ˆ2-10ä¸ªä¸­æ–‡å­—ç¬¦ï¼‰" maxlength="10" data-event-opts="{{[['input',[['__set_model',['$0','realName','$event',[]],['form']]]]]}}" value="{{form.realName}}" bindinput="__e"/></view><view class="inline-form-item data-v-72193c6b"><text class="inline-label data-v-72193c6b">æ˜µç§°</text><input class="inline-input data-v-72193c6b" placeholder="è¯·è¾“å…¥æ˜µç§°ï¼ˆå¯é€‰ï¼‰" data-event-opts="{{[['input',[['__set_model',['$0','nickname','$event',[]],['form']]]]]}}" value="{{form.nickname}}" bindinput="__e"/></view><view class="inline-form-item data-v-72193c6b"><text class="inline-label data-v-72193c6b">æ‰‹æœºå· *</text><input class="inline-input data-v-72193c6b" type="number" placeholder="è¯·è¾“å…¥æ‰‹æœºå·" data-event-opts="{{[['input',[['__set_model',['$0','phone','$event',[]],['form']]]]]}}" value="{{form.phone}}" bindinput="__e"/></view><view class="inline-form-item data-v-72193c6b"><text class="inline-label data-v-72193c6b">è§’è‰² *</text><picker range="{{roleOptions}}" range-key="text" value="{{roleIndex}}" data-event-opts="{{[['change',[['onRoleChange',['$event']]]]]}}" bindchange="__e" class="data-v-72193c6b"><view class="inline-picker data-v-72193c6b"><text class="data-v-72193c6b">{{form.roleText}}</text><text class="picker-arrow data-v-72193c6b">â–¼</text></view></picker></view><view class="role-desc-inline data-v-72193c6b"><text class="desc-icon data-v-72193c6b">ğŸ’¡</text><text class="desc-text data-v-72193c6b">{{user.m1}}</text></view></view><view class="edit-form-footer data-v-72193c6b"><button data-event-opts="{{[['tap',[['cancelEdit',['$event']]]]]}}" class="inline-btn btn-cancel data-v-72193c6b" bindtap="__e">å–æ¶ˆ</button><button data-event-opts="{{[['tap',[['submitForm',['$event']]]]]}}" class="inline-btn btn-save data-v-72193c6b" bindtap="__e">ä¿å­˜ä¿®æ”¹</button></view></view></block></view></block></view><block wx:if="{{totalUsers===0}}"><view class="empty-state data-v-72193c6b"><text class="empty-icon data-v-72193c6b">ğŸ‘¤</text><text class="empty-text data-v-72193c6b">å½“å‰è¿˜æ²¡æœ‰ç”¨æˆ·ï¼Œè¯·ç‚¹å‡»å³ä¸Šè§’â€œæ·»åŠ ç”¨æˆ·â€</text></view></block><block wx:else><block wx:if="{{$root.g1===0}}"><view class="empty-state tip data-v-72193c6b"><text class="empty-text data-v-72193c6b">å½“å‰ç­›é€‰æ¡ä»¶ä¸‹æš‚æ— ç”¨æˆ·ï¼Œè¯·è°ƒæ•´ç­›é€‰æ¡ä»¶</text></view></block></block><block wx:if="{{showDialog}}"><view data-event-opts="{{[['tap',[['closeDialog',['$event']]]]]}}" class="dialog-mask data-v-72193c6b" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="dialog-new data-v-72193c6b" catchtap="__e"><view class="dialog-header-new data-v-72193c6b"><view class="header-icon data-v-72193c6b"><text class="icon-text data-v-72193c6b">{{isEdit?'âœï¸':'ğŸ‘¤'}}</text></view><text class="dialog-title-new data-v-72193c6b">{{isEdit?'ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯':'ç”¨æˆ·ä¿¡æ¯'}}</text><text class="dialog-subtitle data-v-72193c6b">{{isEdit?'ä¿®æ”¹ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯':'å¡«å†™ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯'}}</text></view><view class="dialog-body-new data-v-72193c6b"><view class="form-group data-v-72193c6b"><view class="form-label-new data-v-72193c6b"><text class="label-text data-v-72193c6b">å¾®ä¿¡å·</text><text class="required data-v-72193c6b">*</text></view><input class="form-input-new data-v-72193c6b" placeholder="è¯·è¾“å…¥å¾®ä¿¡å·ï¼ˆæˆ–ç®¡ç†å‘˜å½•å…¥çš„å¤‡æ³¨åï¼‰" data-event-opts="{{[['input',[['__set_model',['$0','wechatId','$event',[]],['form']]]]]}}" value="{{form.wechatId}}" bindinput="__e"/><block wx:if="{{!isEdit}}"><text class="form-hint data-v-72193c6b">è¯·å¡«å†™ç®¡ç†å‘˜åœ¨åå°é¢„ç•™çš„å¾®ä¿¡å·ï¼Œç”¨äºç»‘å®šæƒé™</text></block></view><view class="form-row data-v-72193c6b"><view class="form-group half data-v-72193c6b"><view class="form-label-new data-v-72193c6b"><text class="label-text data-v-72193c6b">å§“å</text><text class="required data-v-72193c6b">*</text></view><input class="form-input-new data-v-72193c6b" placeholder="è¾“å…¥å§“å" data-event-opts="{{[['input',[['__set_model',['$0','name','$event',[]],['form']]]]]}}" value="{{form.name}}" bindinput="__e"/></view><view class="form-group half data-v-72193c6b"><view class="form-label-new data-v-72193c6b"><text class="label-text data-v-72193c6b">å®å</text><text class="required data-v-72193c6b">*</text></view><input class="form-input-new data-v-72193c6b" placeholder="2-10ä¸ªå­—" maxlength="10" data-event-opts="{{[['input',[['__set_model',['$0','realName','$event',[]],['form']]]]]}}" value="{{form.realName}}" bindinput="__e"/></view></view><view class="form-group data-v-72193c6b"><view class="form-label-new data-v-72193c6b"><text class="label-text data-v-72193c6b">æ‰‹æœºå·</text><text class="required data-v-72193c6b">*</text></view><input class="form-input-new data-v-72193c6b" type="number" placeholder="è¾“å…¥11ä½æ‰‹æœºå·" maxlength="11" data-event-opts="{{[['input',[['__set_model',['$0','phone','$event',[]],['form']]]]]}}" value="{{form.phone}}" bindinput="__e"/></view><view class="form-group data-v-72193c6b"><view class="form-label-new data-v-72193c6b"><text class="label-text data-v-72193c6b">è§’è‰²æƒé™</text><text class="required data-v-72193c6b">*</text></view><picker range="{{roleOptions}}" range-key="text" value="{{roleIndex}}" data-event-opts="{{[['change',[['onRoleChange',['$event']]]]]}}" bindchange="__e" class="data-v-72193c6b"><view class="role-selector data-v-72193c6b"><view class="role-left data-v-72193c6b"><text class="role-icon data-v-72193c6b">{{$root.m2}}</text><view class="role-info data-v-72193c6b"><text class="role-name data-v-72193c6b">{{form.roleText}}</text><text class="role-desc-short data-v-72193c6b">{{$root.m3}}</text></view></view><text class="select-arrow data-v-72193c6b">â–¼</text></view></picker></view></view><view class="dialog-footer-new data-v-72193c6b"><button data-event-opts="{{[['tap',[['closeDialog',['$event']]]]]}}" class="btn-new btn-cancel-new data-v-72193c6b" bindtap="__e"><text class="btn-text-new data-v-72193c6b">å–æ¶ˆ</text></button><button data-event-opts="{{[['tap',[['submitForm',['$event']]]]]}}" class="btn-new btn-confirm-new data-v-72193c6b" bindtap="__e"><text class="btn-icon-new data-v-72193c6b">{{isEdit?'âœ“':'+'}}</text><text class="btn-text-new data-v-72193c6b">{{isEdit?'ä¿å­˜ä¿®æ”¹':'ç«‹å³æ·»åŠ '}}</text></button></view></view></view></block></view></block></block></view>